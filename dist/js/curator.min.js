!function(t,e){t.Curator=function(t){var e=function(){function t(t){return null==t?String(t):Z[G.call(t)]||"object"}function e(e){return"function"==t(e)}function i(t){return null!=t&&t==t.window}function o(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function s(e){return"object"==t(e)}function n(t){return s(t)&&!i(t)&&Object.getPrototypeOf(t)==Object.prototype}function r(t){var e=!!t&&"length"in t&&t.length,o=$.type(t);return"function"!=o&&!i(t)&&("array"==o||0===e||"number"==typeof e&&e>0&&e-1 in t)}function a(t){return S.call(t,function(t){return null!=t})}function c(t){return t.length>0?$.fn.concat.apply([],t):t}function l(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function h(t){return t in D?D[t]:D[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function p(t,e){return"number"!=typeof e||O[l(t)]?e:e+"px"}function u(t){var e,i;return N[t]||(e=I.createElement(t),I.body.appendChild(e),i=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==i&&(i="block"),N[t]=i),N[t]}function d(t){return"children"in t?T.call(t.children):$.map(t.childNodes,function(t){if(1==t.nodeType)return t})}function f(t,e){var i,o=t?t.length:0;for(i=0;i<o;i++)this[i]=t[i];this.length=o,this.selector=e||""}function g(t,e,i){for(_ in e)i&&(n(e[_])||K(e[_]))?(n(e[_])&&!n(t[_])&&(t[_]={}),K(e[_])&&!K(t[_])&&(t[_]=[]),g(t[_],e[_],i)):e[_]!==C&&(t[_]=e[_])}function v(t,e){return null==e?$(t):$(t).filter(e)}function m(t,i,o,s){return e(i)?i.call(t,o,s):i}function y(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function w(t,e){var i=t.className||"",o=i&&i.baseVal!==C;if(e===C)return o?i.baseVal:i;o?i.baseVal=e:t.className=e}function P(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?$.parseJSON(t):t):t}catch(e){return t}}function b(t,e){e(t);for(var i=0,o=t.childNodes.length;i<o;i++)b(t.childNodes[i],e)}var C,_,$,E,A,k,x=[],L=x.concat,S=x.filter,T=x.slice,I=window.document,N={},D={},O={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},M=/^\s*<(\w+|!)[^>]*>/,U=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,H=/^(?:body|html)$/i,F=["val","css","html","text","data","width","height","offset"],j=["after","prepend","before","append"],R=I.createElement("table"),W=I.createElement("tr"),z={tr:I.createElement("tbody"),tbody:R,thead:R,tfoot:R,td:W,th:W,"*":I.createElement("div")},V=/complete|loaded|interactive/,B=/^[\w-]*$/,Z={},G=Z.toString,q={},X=I.createElement("div"),Y={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},K=Array.isArray||function(t){return t instanceof Array};return q.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var i=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(i)return i.call(t,e);var o,s=t.parentNode,n=!s;return n&&(s=X).appendChild(t),o=~q.qsa(s,e).indexOf(t),n&&X.removeChild(t),o},A=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},k=function(t){return S.call(t,function(e,i){return t.indexOf(e)==i})},q.fragment=function(t,e,i){var o,s,r;return U.test(t)&&(o=$(I.createElement(RegExp.$1))),o||(t.replace&&(t=t.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,"<$1></$2>")),e===C&&(e=M.test(t)&&RegExp.$1),e in z||(e="*"),r=z[e],r.innerHTML=""+t,o=$.each(T.call(r.childNodes),function(){r.removeChild(this)})),n(i)&&(s=$(o),$.each(i,function(t,e){F.indexOf(t)>-1?s[t](e):s.attr(t,e)})),o},q.Z=function(t,e){return new f(t,e)},q.isZ=function(t){return t instanceof q.Z},q.init=function(t,i){var o;if(!t)return q.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&M.test(t))o=q.fragment(t,RegExp.$1,i),t=null;else{if(i!==C)return $(i).find(t);o=q.qsa(I,t)}else{if(e(t))return $(I).ready(t);if(q.isZ(t))return t;if(K(t))o=a(t);else if(s(t))o=[t],t=null;else if(M.test(t))o=q.fragment(t.trim(),RegExp.$1,i),t=null;else{if(i!==C)return $(i).find(t);o=q.qsa(I,t)}}return q.Z(o,t)},$=function(t,e){return q.init(t,e)},$.extend=function(t){var e,i=T.call(arguments,1);return"boolean"==typeof t&&(e=t,t=i.shift()),i.forEach(function(i){g(t,i,e)}),t},q.qsa=function(t,e){var i,o="#"==e[0],s=!o&&"."==e[0],n=o||s?e.slice(1):e,r=B.test(n);return t.getElementById&&r&&o?(i=t.getElementById(n))?[i]:[]:1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType?[]:T.call(r&&!o&&t.getElementsByClassName?s?t.getElementsByClassName(n):t.getElementsByTagName(e):t.querySelectorAll(e))},$.contains=I.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},$.type=t,$.isFunction=e,$.isWindow=i,$.isArray=K,$.isPlainObject=n,$.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},$.isNumeric=function(t){var e=Number(t),i=typeof t;return null!=t&&"boolean"!=i&&("string"!=i||t.length)&&!isNaN(e)&&isFinite(e)||!1},$.inArray=function(t,e,i){return x.indexOf.call(e,t,i)},$.camelCase=A,$.trim=function(t){return null==t?"":String.prototype.trim.call(t)},$.uuid=0,$.support={},$.expr={},$.noop=function(){},$.map=function(t,e){var i,o,s,n=[];if(r(t))for(o=0;o<t.length;o++)null!=(i=e(t[o],o))&&n.push(i);else for(s in t)null!=(i=e(t[s],s))&&n.push(i);return c(n)},$.each=function(t,e){var i,o;if(r(t)){for(i=0;i<t.length;i++)if(e.call(t[i],i,t[i])===!1)return t}else for(o in t)if(e.call(t[o],o,t[o])===!1)return t;return t},$.grep=function(t,e){return S.call(t,e)},window.JSON&&($.parseJSON=JSON.parse),$.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Z["[object "+e+"]"]=e.toLowerCase()}),$.fn={constructor:q.Z,length:0,forEach:x.forEach,reduce:x.reduce,push:x.push,sort:x.sort,splice:x.splice,indexOf:x.indexOf,concat:function(){var t,e,i=[];for(t=0;t<arguments.length;t++)e=arguments[t],i[t]=q.isZ(e)?e.toArray():e;return L.apply(q.isZ(this)?this.toArray():this,i)},map:function(t){return $($.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return $(T.apply(this,arguments))},ready:function(t){return V.test(I.readyState)&&I.body?t($):I.addEventListener("DOMContentLoaded",function(){t($)},!1),this},get:function(t){return t===C?T.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return x.every.call(this,function(e,i){return t.call(e,i,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):$(S.call(this,function(e){return q.matches(e,t)}))},add:function(t,e){return $(k(this.concat($(t,e))))},is:function(t){return this.length>0&&q.matches(this[0],t)},not:function(t){var i=[];if(e(t)&&t.call!==C)this.each(function(e){t.call(this,e)||i.push(this)});else{var o="string"==typeof t?this.filter(t):r(t)&&e(t.item)?T.call(t):$(t);this.forEach(function(t){o.indexOf(t)<0&&i.push(t)})}return $(i)},has:function(t){return this.filter(function(){return s(t)?$.contains(this,t):$(this).find(t).size()})},eq:function(t){return t===-1?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!s(t)?t:$(t)},last:function(){var t=this[this.length-1];return t&&!s(t)?t:$(t)},find:function(t){var e=this;return t?"object"==typeof t?$(t).filter(function(){var t=this;return x.some.call(e,function(e){return $.contains(e,t)})}):1==this.length?$(q.qsa(this[0],t)):this.map(function(){return q.qsa(this,t)}):$()},closest:function(t,e){var i=[],s="object"==typeof t&&$(t);return this.each(function(n,r){for(;r&&!(s?s.indexOf(r)>=0:q.matches(r,t));)r=r!==e&&!o(r)&&r.parentNode;r&&i.indexOf(r)<0&&i.push(r)}),$(i)},parents:function(t){for(var e=[],i=this;i.length>0;)i=$.map(i,function(t){if((t=t.parentNode)&&!o(t)&&e.indexOf(t)<0)return e.push(t),t});return v(e,t)},parent:function(t){return v(k(this.pluck("parentNode")),t)},children:function(t){return v(this.map(function(){return d(this)}),t)},contents:function(){return this.map(function(){return this.contentDocument||T.call(this.childNodes)})},siblings:function(t){return v(this.map(function(t,e){return S.call(d(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return $.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=u(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var i=e(t);if(this[0]&&!i)var o=$(t).get(0),s=o.parentNode||this.length>1;return this.each(function(e){$(this).wrapAll(i?t.call(this,e):s?o.cloneNode(!0):o)})},wrapAll:function(t){if(this[0]){$(this[0]).before(t=$(t));for(var e;(e=t.children()).length;)t=e.first();$(t).append(this)}return this},wrapInner:function(t){var i=e(t);return this.each(function(e){var o=$(this),s=o.contents(),n=i?t.call(this,e):t;s.length?s.wrapAll(n):o.append(n)})},unwrap:function(){return this.parent().each(function(){$(this).replaceWith($(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=$(this);(t===C?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return $(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return $(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var i=this.innerHTML;$(this).empty().append(m(this,t,e,i))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var i=m(this,t,e,this.textContent);this.textContent=null==i?"":""+i}):0 in this?this.pluck("textContent").join(""):null},attr:function(t,e){var i;return"string"!=typeof t||1 in arguments?this.each(function(i){if(1===this.nodeType)if(s(t))for(_ in t)y(this,_,t[_]);else y(this,t,m(this,e,i,this.getAttribute(t)))}):0 in this&&1==this[0].nodeType&&null!=(i=this[0].getAttribute(t))?i:C},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){y(this,t)},this)})},prop:function(t,e){return t=Y[t]||t,1 in arguments?this.each(function(i){this[t]=m(this,e,i,this[t])}):this[0]&&this[0][t]},removeProp:function(t){return t=Y[t]||t,this.each(function(){delete this[t]})},data:function(t,e){var i="data-"+t.replace(/([A-Z])/g,"-$1").toLowerCase(),o=1 in arguments?this.attr(i,e):this.attr(i);return null!==o?P(o):C},val:function(t){return 0 in arguments?(null==t&&(t=""),this.each(function(e){this.value=m(this,t,e,this.value)})):this[0]&&(this[0].multiple?$(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var i=$(this),o=m(this,t,e,i.offset()),s=i.offsetParent().offset(),n={top:o.top-s.top,left:o.left-s.left};"static"==i.css("position")&&(n.position="relative"),i.css(n)});if(!this.length)return null;if(I.documentElement!==this[0]&&!$.contains(I.documentElement,this[0]))return{top:0,left:0};var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,i){if(arguments.length<2){var o=this[0];if("string"==typeof e){if(!o)return;return o.style[A(e)]||getComputedStyle(o,"").getPropertyValue(e)}if(K(e)){if(!o)return;var s={},n=getComputedStyle(o,"");return $.each(e,function(t,e){s[e]=o.style[A(e)]||n.getPropertyValue(e)}),s}}var r="";if("string"==t(e))i||0===i?r=l(e)+":"+p(e,i):this.each(function(){this.style.removeProperty(l(e))});else for(_ in e)e[_]||0===e[_]?r+=l(_)+":"+p(_,e[_])+";":this.each(function(){this.style.removeProperty(l(_))});return this.each(function(){this.style.cssText+=";"+r})},index:function(t){return t?this.indexOf($(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return!!t&&x.some.call(this,function(t){return this.test(w(t))},h(t))},addClass:function(t){return t?this.each(function(e){if("className"in this){E=[];var i=w(this);m(this,t,e,i).split(/\s+/g).forEach(function(t){$(this).hasClass(t)||E.push(t)},this),E.length&&w(this,i+(i?" ":"")+E.join(" "))}}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===C)return w(this,"");E=w(this),m(this,t,e,E).split(/\s+/g).forEach(function(t){E=E.replace(h(t)," ")}),w(this,E.trim())}})},toggleClass:function(t,e){return t?this.each(function(i){var o=$(this);m(this,t,i,w(this)).split(/\s+/g).forEach(function(t){(e===C?!o.hasClass(t):e)?o.addClass(t):o.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===C?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===C?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),i=this.offset(),o=H.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat($(t).css("margin-top"))||0,i.left-=parseFloat($(t).css("margin-left"))||0,o.top+=parseFloat($(e[0]).css("border-top-width"))||0,o.left+=parseFloat($(e[0]).css("border-left-width"))||0,{top:i.top-o.top,left:i.left-o.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||I.body;t&&!H.test(t.nodeName)&&"static"==$(t).css("position");)t=t.offsetParent;return t})}},$.fn.detach=$.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});$.fn[t]=function(s){var n,r=this[0];return s===C?i(r)?r["inner"+e]:o(r)?r.documentElement["scroll"+e]:(n=this.offset())&&n[t]:this.each(function(e){r=$(this),r.css(t,m(this,s,e,r[t]()))})}}),j.forEach(function(e,i){var o=i%2;$.fn[e]=function(){var e,s,n=$.map(arguments,function(i){var o=[];return e=t(i),"array"==e?(i.forEach(function(t){return t.nodeType!==C?o.push(t):$.zepto.isZ(t)?o=o.concat(t.get()):void(o=o.concat(q.fragment(t)))}),o):"object"==e||null==i?i:q.fragment(i)}),r=this.length>1;return n.length<1?this:this.each(function(t,e){s=o?e:e.parentNode,e=0==i?e.nextSibling:1==i?e.firstChild:2==i?e:null;var a=$.contains(I.documentElement,s);n.forEach(function(t){if(r)t=t.cloneNode(!0);else if(!s)return $(t).remove();s.insertBefore(t,e),a&&b(t,function(t){if(!(null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src)){var e=t.ownerDocument?t.ownerDocument.defaultView:window;e.eval.call(e,t.innerHTML)}})})})},$.fn[o?e+"To":"insert"+(i?"Before":"After")]=function(t){return $(t)[e](this),this}}),q.Z.prototype=f.prototype=$.fn,q.uniq=k,q.deserializeValue=P,$.zepto=q,$}();!function(t){function e(t){return t._zid||(t._zid=u++)}function i(t,i,n,r){if(i=o(i),i.ns)var a=s(i.ns);return(v[e(t)]||[]).filter(function(t){return t&&(!i.e||t.e==i.e)&&(!i.ns||a.test(t.ns))&&(!n||e(t.fn)===e(n))&&(!r||t.sel==r)})}function o(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function s(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function n(t,e){return t.del&&!y&&t.e in w||!!e}function r(t){return P[t]||y&&w[t]||t}function a(i,s,a,c,h,u,d){var f=e(i),g=v[f]||(v[f]=[]);s.split(/\s/).forEach(function(e){if("ready"==e)return t(document).ready(a);var s=o(e);s.fn=a,s.sel=h,s.e in P&&(a=function(e){var i=e.relatedTarget;if(!i||i!==this&&!t.contains(this,i))return s.fn.apply(this,arguments)}),s.del=u;var f=u||a;s.proxy=function(t){if(t=l(t),!t.isImmediatePropagationStopped()){t.data=c;var e=f.apply(i,t._args==p?[t]:[t].concat(t._args));return e===!1&&(t.preventDefault(),t.stopPropagation()),e}},s.i=g.length,g.push(s),"addEventListener"in i&&i.addEventListener(r(s.e),s.proxy,n(s,d))})}function c(t,o,s,a,c){var l=e(t);(o||"").split(/\s/).forEach(function(e){i(t,e,s,a).forEach(function(e){delete v[l][e.i],"removeEventListener"in t&&t.removeEventListener(r(e.e),e.proxy,n(e,c))})})}function l(e,i){return!i&&e.isDefaultPrevented||(i||(i=e),t.each($,function(t,o){var s=i[t];e[t]=function(){return this[o]=b,s&&s.apply(i,arguments)},e[o]=C}),e.timeStamp||(e.timeStamp=Date.now()),(i.defaultPrevented!==p?i.defaultPrevented:"returnValue"in i?i.returnValue===!1:i.getPreventDefault&&i.getPreventDefault())&&(e.isDefaultPrevented=b)),e}function h(t){var e,i={originalEvent:t};for(e in t)_.test(e)||t[e]===p||(i[e]=t[e]);return l(i,t)}var p,u=1,d=Array.prototype.slice,f=t.isFunction,g=function(t){return"string"==typeof t},v={},m={},y="onfocusin"in window,w={focus:"focusin",blur:"focusout"},P={mouseenter:"mouseover",mouseleave:"mouseout"};m.click=m.mousedown=m.mouseup=m.mousemove="MouseEvents",t.event={add:a,remove:c},t.proxy=function(i,o){var s=2 in arguments&&d.call(arguments,2);if(f(i)){var n=function(){return i.apply(o,s?s.concat(d.call(arguments)):arguments)};return n._zid=e(i),n}if(g(o))return s?(s.unshift(i[o],i),t.proxy.apply(null,s)):t.proxy(i[o],i);throw new TypeError("expected function")},t.fn.bind=function(t,e,i){return this.on(t,e,i)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,i,o){return this.on(t,e,i,o,1)};var b=function(){return!0},C=function(){return!1},_=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,$={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,i){return this.on(e,t,i)},t.fn.undelegate=function(t,e,i){return this.off(e,t,i)},t.fn.live=function(e,i){return t(document.body).delegate(this.selector,e,i),this},t.fn.die=function(e,i){return t(document.body).undelegate(this.selector,e,i),this},t.fn.on=function(e,i,o,s,n){var r,l,u=this;return e&&!g(e)?(t.each(e,function(t,e){u.on(t,i,o,e,n)}),u):(g(i)||f(s)||s===!1||(s=o,o=i,i=p),s!==p&&o!==!1||(s=o,o=p),s===!1&&(s=C),u.each(function(p,u){n&&(r=function(t){return c(u,t.type,s),s.apply(this,arguments)}),i&&(l=function(e){var o,n=t(e.target).closest(i,u).get(0);if(n&&n!==u)return o=t.extend(h(e),{currentTarget:n,liveFired:u}),(r||s).apply(n,[o].concat(d.call(arguments,1)))}),a(u,e,s,o,i,l||r)}))},t.fn.off=function(e,i,o){var s=this;return e&&!g(e)?(t.each(e,function(t,e){s.off(t,i,e)}),s):(g(i)||f(o)||o===!1||(o=i,i=p),o===!1&&(o=C),s.each(function(){c(this,e,o,i)}))},t.fn.trigger=function(e,i){return e=g(e)||t.isPlainObject(e)?t.Event(e):l(e),e._args=i,this.each(function(){e.type in w&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,i)})},t.fn.triggerHandler=function(e,o){var s,n;return this.each(function(r,a){s=h(g(e)?t.Event(e):e),s._args=o,s.target=a,t.each(i(a,e.type||e),function(t,e){if(n=e.proxy(s),s.isImmediatePropagationStopped())return!1})}),n},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),t.Event=function(t,e){g(t)||(e=t,t=e.type);var i=document.createEvent(m[t]||"Events"),o=!0;if(e)for(var s in e)"bubbles"==s?o=!!e[s]:i[s]=e[s];return i.initEvent(t,o,!0),l(i)}}(e),function(t){t.fn.serializeArray=function(){var e,i,o=[],s=function(t){if(t.forEach)return t.forEach(s);o.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(o,n){i=n.type,e=n.name,e&&"fieldset"!=n.nodeName.toLowerCase()&&!n.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||n.checked)&&s(t(n).val())}),o},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var i=t.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(e),function(){try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(e,i){try{return t(e,i)}catch(t){return null}}}}(),window.Zepto=e;var i=window.Zepto;!function(t,e){function i(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function o(t){return s?s+t:t.toLowerCase()}var s,n,r,a,c,l,h,p,u,d,f="",g={Webkit:"webkit",Moz:"",O:"o"},v=document.createElement("div"),m=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,y={};void 0===v.style.transform&&t.each(g,function(t,e){if(void 0!==v.style[t+"TransitionProperty"])return f="-"+t.toLowerCase()+"-",s=e,!1}),n=f+"transform",y[r=f+"transition-property"]=y[a=f+"transition-duration"]=y[l=f+"transition-delay"]=y[c=f+"transition-timing-function"]=y[h=f+"animation-name"]=y[p=f+"animation-duration"]=y[d=f+"animation-delay"]=y[u=f+"animation-timing-function"]="",t.fx={off:void 0===s&&void 0===v.style.transitionProperty,speeds:{_default:400,fast:200,slow:600},cssPrefix:f,transitionEnd:o("TransitionEnd"),animationEnd:o("AnimationEnd")},t.fn.animate=function(e,i,o,s,n){return t.isFunction(i)&&(s=i,o=void 0,i=void 0),t.isFunction(o)&&(s=o,o=void 0),t.isPlainObject(i)&&(o=i.easing,s=i.complete,n=i.delay,i=i.duration),i&&(i=("number"==typeof i?i:t.fx.speeds[i]||t.fx.speeds._default)/1e3),n&&(n=parseFloat(n)/1e3),this.anim(e,i,o,s,n)},t.fn.anim=function(e,o,s,f,g){var v,w,P,b={},C="",_=this,$=t.fx.transitionEnd,E=!1;if(void 0===o&&(o=t.fx.speeds._default/1e3),void 0===g&&(g=0),t.fx.off&&(o=0),"string"==typeof e)b[h]=e,b[p]=o+"s",b[d]=g+"s",b[u]=s||"linear",$=t.fx.animationEnd;else{w=[];for(v in e)m.test(v)?C+=v+"("+e[v]+") ":(b[v]=e[v],w.push(i(v)));C&&(b[n]=C,w.push(n)),o>0&&"object"==typeof e&&(b[r]=w.join(", "),b[a]=o+"s",b[l]=g+"s",b[c]=s||"linear")}return P=function(e){if(void 0!==e){if(e.target!==e.currentTarget)return;t(e.target).unbind($,P)}else t(this).unbind($,P);E=!0,t(this).css(y),f&&f.call(this)},o>0&&(this.bind($,P),setTimeout(function(){E||P.call(_)},1e3*(o+g)+25)),this.size()&&this.get(0).clientLeft,this.css(b),o<=0&&setTimeout(function(){_.each(function(){P.call(this)})},0),this},v=null}(e),function(t,e){t.makeArray=function(t,e){return t=Array.prototype.slice.call(t),e?(e.push.apply(e,t),e):t},t.cache={},t.noData={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},t.acceptData=function(e){if(e.nodeName){var i=t.noData[e.nodeName.toLowerCase()];if(i)return!(i===!0||e.getAttribute("classid")!==i)}return!0},t.data=function(e,i,o,s){if(t.acceptData(e)){var n,r,a,c=t.expando,l="string"==typeof i,h=e.nodeType,p=h?t.cache:e,u=h?e[c]:e[c]&&c,d="events"===i;if(u&&p[u]&&(d||s||p[u].data)||!l||void 0!==o)return u||(h?e[c]=u=++t.uuid:u=c),p[u]||(p[u]={},h||(p[u].toJSON=t.noop)),"object"!=typeof i&&"function"!=typeof i||(s?p[u]=t.extend(p[u],i):p[u].data=t.extend(p[u].data,i)),n=r=p[u],s||(r.data||(r.data={}),r=r.data),void 0!==o&&(r[t.camelCase(i)]=o),d&&!r[i]?n.events:(l?null==(a=r[i])&&(a=r[t.camelCase(i)]):a=r,a)}}}(e),function(t,e){function i(i,o,s,n,r){"function"!=typeof o||r||(r=o,o=e);var a={opacity:s};return n&&(a.scale=n,i.css(t.fx.cssPrefix+"transform-origin","0 0")),i.animate(a,o,null,r)}function o(e,o,s,n){return i(e,o,0,s,function(){r.call(t(this)),n&&n.call(this)})}var s=window.document,n=(s.documentElement,t.fn.show),r=t.fn.hide,a=t.fn.toggle;t.fn.show=function(t,o){return n.call(this),t===e?t=0:this.css("opacity",0),i(this,t,1,"1,1",o)},t.fn.hide=function(t,i){return t===e?r.call(this):o(this,t,"0,0",i)},t.fn.toggle=function(i,o){return i===e||"boolean"==typeof i?a.call(this,i):this.each(function(){var e=t(this);e["none"==e.css("display")?"show":"hide"](i,o)})},t.fn.fadeTo=function(t,e,o){return i(this,t,e,null,o)},t.fn.fadeIn=function(t,e){var i=this.css("opacity");return i>0?this.css("opacity",0):i=1,n.call(this).fadeTo(t,i,e)},t.fn.fadeOut=function(t,e){return o(this,t,null,e)},t.fn.fadeToggle=function(e,i){return this.each(function(){var o=t(this);o[0==o.css("opacity")||"none"==o.css("display")?"fadeIn":"fadeOut"](e,i)})}}(e);var o=function(t,e,i,o){if(!Array.isArray(t))throw new TypeError("array is not a Array");var s=t.length;i=parseInt(i,10)||0,o=void 0===o?s:parseInt(o,10)||0;var n,r;for(n=i<0?Math.max(s+i,0):Math.min(i,s),r=o<0?Math.max(s+o,0):Math.min(o,s);n<r;n++)t[n]=e;return t};Array.prototype.fill||(Array.prototype.fill=function(t,e,i){return o(this,t,e,i)}),function(t){function e(e,n){function r(t,e){return function(){h||(n(void 0===p.status?t:p.status,0===p.status?"Error":p.response||p.responseText||e,p),h=!0)}}var a=e.headers||{},c=e.body,l=e.method||(c?"POST":"GET"),h=!1,p=i(e.cors);p.open(l,e.url,!0);var u=p.onload=r(200);p.onreadystatechange=function(){4===p.readyState&&u()},p.onerror=r(null,"Error"),p.ontimeout=r(null,"Timeout"),p.onabort=r(null,"Abort"),c&&(o(a,"X-Requested-With","XMLHttpRequest"),t.FormData&&c instanceof t.FormData||o(a,"Content-Type","application/x-www-form-urlencoded"));for(var d,f=0,g=s.length;f<g;f++)d=s[f],void 0!==e[d]&&(p[d]=e[d]);for(var v in a)p.setRequestHeader(v,a[v]);return p.send(c),p}function i(e){return e&&t.XDomainRequest&&!/MSIE 1/.test(navigator.userAgent)?new XDomainRequest:t.XMLHttpRequest?new XMLHttpRequest:void 0}function o(t,e,i){t[e]=t[e]||i}var s=["responseType","withCredentials","timeout","onprogress"];t.nanoajax=e}(this),function(t,e){var i=function(t,e,i){var o;return function(){function s(){i||t.apply(n,r),o=null}var n=this,r=arguments;o?clearTimeout(o):i&&t.apply(n,r),o=setTimeout(s,e||150)}};t.fn[e]=function(t){return t?this.bind("resize",i(t)):this.trigger(e)}}(i,"smartresize");var s={debug:!1,SOURCE_TYPES:["twitter","instagram"],log:function(t){window.console&&s.debug&&window.console.log(t)},alert:function(t){window.alert&&window.alert(t)},checkContainer:function(t){return s.log("Curator->checkContainer: "+t),0!==i(t).length||(window.console&&window.console.log("Curator could not find the element "+t+". Please ensure this element existings in your HTML code. Exiting."),!1)},checkPowered:function(t){return s.log("Curator->checkPowered"),t.html().indexOf("Curator")>0||(s.alert("Container is missing Powered by Curator"),!1)},addCSSRule:function(t,e,i,o){"insertRule"in t?t.insertRule(e+"{"+i+"}",0):"addRule"in t&&t.addRule(e,i)},createSheet:function(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet},loadWidget:function(t){var e=window.Curator[t.type],i=new e(t);return window.curatorWidget=i,i},loadCSS:function(){},Templates:{},Config:{Defaults:{apiEndpoint:"https://api.curator.io/v1.1",feedId:"",postsPerPage:12,maxPosts:0,templatePost:"v2-post",templatePopup:"v1-popup",templatePopupWrapper:"v1-popup-wrapper",templateFilter:"v1-filter",showPopupOnClick:!0,onPostsLoaded:function(){},filter:{showNetworks:!1,networksLabel:"Networks:",showSources:!1,sourcesLabel:"Sources:"}}}};void 0===i&&s.alert("Curator requires jQuery. \n\nPlease include jQuery in your HTML before the Curator widget script tag.\n\nVisit http://jquery.com/download/ to get the latest version"),s.serialize=function(t){return"?"+Object.keys(t).reduce(function(e,i){return e.push(i+"="+encodeURIComponent(t[i])),e},[]).join("&")},s.ajax=function(e,i,o,n){var r=t.location.protocol,a=e.indexOf("://");a&&(e=e.substr(a+3)),r="https:"!=r&&"http:"!=r?"https:":r,e=r+"//"+e,i&&(e+=s.serialize(i)),nanoajax({url:e,cors:!0},function(t,e){t?o(JSON.parse(e)):n(t,e)})};var n=function(){this.listeners={}};n.prototype.on=function(t,e,i){for(var o=arguments,s=[],n=arguments.length,r=0;r<n;r++)s.push(o[r]);s=s.length>3?s.splice(3,s.length-1):[],void 0!==this.listeners[t]?this.listeners[t].push({scope:i,callback:e,args:s}):this.listeners[t]=[{scope:i,callback:e,args:s}]},n.prototype.off=function(t,e,i){var o=this;if(void 0!==this.listeners[t]){for(var s=this.listeners[t].length,n=[],r=0;r<s;r++){var a=o.listeners[t][r];a.scope===i&&a.callback===e||n.push(a)}this.listeners[t]=n}},n.prototype.has=function(t,e,i){var o=this;if(void 0!==this.listeners[t]){var s=this.listeners[t].length;if(void 0===e&&void 0===i)return s>0;for(var n=0;n<s;n++){var r=o.listeners[t][n];if((!i||r.scope===i)&&r.callback===e)return!0}}return!1},n.prototype.trigger=function(t){for(var e=arguments,i=this,o=0,s={type:t},n=[],r=1;r<arguments.length;r++)n.push(e[r]);if(n=[s].concat(n),void 0!==this.listeners[t])for(var a=this.listeners[t].length,c=0;c<a;c++){var l=i.listeners[t][c];if(l&&l.callback){var h=n.concat(l.args);l.callback.apply(l.scope,h),o+=1}}},n.prototype.getEvents=function(){var t=this,e="";for(var i in this.listeners)for(var o=t.listeners[i].length,s=0;s<o;s++){var n=t.listeners[i][s];e+=n.scope&&n.scope.className?n.scope.className:"anonymous",e+=" listen for '"+i+"'\n"}return e},n.prototype.destroy=function(){this.listeners={}},s.EventBus=new n,s.Events={FEED_LOADED:"feed:loaded",FEED_FAILED:"feed:failed",FILTER_CHANGED:"filter:changed",POSTS_LOADED:"posts:loaded",POSTS_FAILED:"posts:failed",POST_CREATED:"post:created",POST_CLICK:"post:click",POST_CLICK_READ_MORE:"post:clickReadMore",POST_IMAGE_LOADED:"post:imageLoaded",CAROUSEL_CHANGED:"curator:changed"};var r=function(t){function e(e){t.call(this),s.log("Feed->init with options"),this.widget=e,this.posts=[],this.currentPage=0,this.postsLoaded=0,this.postCount=0,this.loading=!1,this.allPostsLoaded=!1,this.pagination={after:null,before:null},this.options=this.widget.options,this.params=this.options.feedParams||{},this.params.limit=this.options.postsPerPage,this.feedBase=this.options.apiEndpoint+"/feeds"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.loadPosts=function(t,e){if(t=t||0,s.log("Feed->loadPosts "+this.loading),this.loading)return!1;this.currentPage=t;var o=i.extend({},this.options.feedParams,e);o.limit=this.options.postsPerPage,o.offset=t*this.options.postsPerPage,this._loadPosts(o)},e.prototype.loadMore=function(t){if(s.log("Feed->loadMore "+this.loading),this.loading)return!1;var e={limit:this.options.postsPerPage};i.extend(e,this.options.feedParams,t),e.offset=this.posts.length,this._loadPosts(e)},e.prototype.load=function(t){if(s.log("Feed->load "+this.loading),this.loading)return!1;this.currentPage=0;var e=i.extend(this.params,t);this._loadPosts(e)},e.prototype.loadAfter=function(){if(s.log("Feed->loadAfter "+this.loading),this.loading)return!1;this.currentPage=0;var t=i.extend({},this.params);this.pagination&&this.pagination.after&&(t.after=this.pagination.after,delete t.before),this._loadPosts(t)},e.prototype._loadPosts=function(t){var e=this;s.log("Feed->_loadPosts"),this.loading=!0,s.ajax(this.getUrl("/posts"),t,function(t){s.log("Feed->_loadPosts success"),t.success?(e.postCount=t.postCount,e.postsLoaded+=t.posts.length,e.allPostsLoaded=e.postsLoaded>=e.postCount,e.posts=e.posts.concat(t.posts),e.networks=t.networks,t.pagination&&(e.pagination=t.pagination),e.widget.trigger(s.Events.FEED_LOADED,t),e.widget.trigger(s.Events.POSTS_LOADED,t.posts),e.trigger(s.Events.FEED_LOADED,t),e.trigger(s.Events.POSTS_LOADED,t.posts)):e.trigger(s.Events.POSTS_FAILED,t.posts),e.loading=!1},function(t,i,o){s.log("Feed->_loadPosts fail"),s.log(i),s.log(o),e.trigger(s.Events.POSTS_FAILED,[]),e.loading=!1})},e.prototype.loadPost=function(t,e,o){o=o||function(){},i.get(this.getUrl("/post/"+t),{},function(t){t.success?e(t.post):o()})},e.prototype.inappropriatePost=function(t,e,o,s){var n={reason:e};i.post(this.getUrl("/post/"+t+"/inappropriate"),n,function(t,e,n){t=i.parseJSON(t),t.success===!0?o():s(n)})},e.prototype.lovePost=function(t,e,o){var s={}
;i.post(this.getUrl("/post/"+t+"/love"),s,function(t,s,n){t=i.parseJSON(t),t.success===!0?e(t.loves):o(n)})},e.prototype.getUrl=function(t){return this.feedBase+"/"+this.options.feedId+t},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(n);s.Feed=r;var a=function(t){var e=this;s.log("Filter->construct"),this.client=t,this.options=t.options,this.$filter=s.Template.render(this.options.templateFilter,{}),this.$filterNetworks=this.$filter.find(".crt-filter-networks"),this.$filterNetworksUl=this.$filter.find(".crt-filter-networks ul"),this.$filterSources=this.$filter.find(".crt-filter-sources"),this.$filterSourcesUl=this.$filter.find(".crt-filter-sources ul"),this.client.$container.append(this.$filter),this.$filterNetworks.find("label").text(this.client.options.filter.networksLabel),this.$filterSources.find("label").text(this.client.options.filter.sourcesLabel),this.$filter.on("click",".crt-filter-networks a",function(t){t.preventDefault();var o=i(t.target),n=o.data("network");e.$filter.find(".crt-filter-networks li").removeClass("active"),o.parent().addClass("active"),e.client.trigger(s.Events.FILTER_CHANGED),n?e.client.feed.loadPosts(0,{network_id:n}):e.client.feed.loadPosts(0,{})}),this.$filter.on("click",".crt-filter-sources a",function(t){t.preventDefault();var o=i(t.target),n=o.data("source");e.$filter.find(".crt-filter-sources li").removeClass("active"),o.parent().addClass("active"),e.client.trigger(s.Events.FILTER_CHANGED),n?e.client.feed.loadPosts(0,{source_id:n}):e.client.feed.loadPosts(0,{})}),this.client.on(s.Events.FEED_LOADED,this.onPostsLoaded.bind(this))};a.prototype.onPostsLoaded=function(t,e){var i=this,o=e.networks;if(!this.filtersLoaded){if(this.options.filter.showNetworks){this.$filterNetworksUl.append('<li class="crt-filter-label"><label>'+this.client.options.filter.networksLabel+"</label></li>"),this.$filterNetworksUl.append('<li class="active"><a href="#" data-network="0"> All</a></li>');for(var n=0,r=o;n<r.length;n+=1){var a=r[n],c=s.Networks[a];c?i.$filterNetworksUl.append('<li><a href="#" data-network="'+a+'"><i class="'+c.icon+'"></i> '+c.name+"</a></li>"):console.log(a)}}else this.$filterNetworks.hide();if(this.options.filter.showSources){this.$filterSourcesUl.append('<li class="crt-filter-label"><label>'+this.client.options.filter.sourcesLabel+"</label></li>"),this.$filterSourcesUl.append('<li class="active"><a href="#" data-source="0"> All</a></li>');for(var l=0,h=e.sources;l<h.length;l+=1){var p=h[l],u=s.Networks[p.network_id];u?i.$filterSourcesUl.append('<li><a href="#" data-source="'+p.id+'"><i class="'+u.icon+'"></i> '+p.name+"</a></li>"):console.log(p.network_id)}}else this.$filterSources.hide();this.filtersLoaded=!0}},a.prototype.destroy=function(){this.$filter.remove()},s.Filter=a,s.Networks={1:{name:"Twitter",icon:"crt-icon-twitter"},2:{name:"Instagram",icon:"crt-icon-instagram"},3:{name:"Facebook",icon:"crt-icon-facebook"},4:{name:"Pinterest",icon:"crt-icon-pinterest"},5:{name:"Google",icon:"crt-icon-google"},6:{name:"Vine",icon:"crt-icon-vine"},7:{name:"Flickr",icon:"crt-icon-flickr"},8:{name:"Youtube",icon:"crt-icon-youtube"},9:{name:"Tumblr",icon:"crt-icon-tumblr"},10:{name:"RSS",icon:"crt-icon-rss"},11:{name:"LinkedIn",icon:"crt-icon-linkedin"}},function(){var t={},e={networkIcon:function(){return this.data.network_name.toLowerCase()},networkName:function(){return this.data.network_name.toLowerCase()},userUrl:function(){if(this.data.user_url&&""!==this.data.user_url)return this.data.user_url;if(this.data.originator_user_url&&""!==this.data.originator_user_url)return this.data.originator_user_url;if(this.data.userUrl&&""!==this.data.userUrl)return this.data.userUrl;var t=this.data.network_id+"";return"1"===t?"http://twitter.com/"+this.data.user_screen_name:"2"===t?"http://instagram.com/"+this.data.user_screen_name:"3"===t?"http://facebook.com/"+this.data.user_screen_name:"#"},parseText:function(t){return this.data.is_html?t:("Twitter"===this.data.network_name?(t=s.StringUtils.linksToHref(t),t=s.StringUtils.twitterLinks(t)):"Instagram"===this.data.network_name?(t=s.StringUtils.linksToHref(t),t=s.StringUtils.instagramLinks(t)):"Facebook"===this.data.network_name?(t=s.StringUtils.linksToHref(t),t=s.StringUtils.facebookLinks(t)):t=s.StringUtils.linksToHref(t),s.StringUtils.nl2br(t))},nl2br:function(t){return s.StringUtils.nl2br(t)},contentImageClasses:function(){return this.data.image?"crt-post-has-image":"crt-post-content-image-hidden crt-post-no-image"},contentTextClasses:function(){return this.data.text?"crt-post-has-text":"crt-post-content-text-hidden crt-post-no-text"},fuzzyDate:function(t){var e=Date.parse(t+" UTC"),i=Math.round((new Date-e)/1e3);return i<30?"Just now":i<60?i+" seconds ago":i<120?"a minute ago.":i<3600?Math.floor(i/60)+" minutes ago":1===Math.floor(i/3600)?"1 hour ago.":i<86400?Math.floor(i/3600)+" hours ago":i<172800?"Yesterday":i<604800?"This week":i<1209600?"Last week":i<2592e3?"This month":e},prettyDate:function(t){var e=s.DateUtils.dateFromString(t),i=((new Date).getTime()-e.getTime())/1e3,o=Math.floor(i/86400),n=e.getFullYear(),r=e.getMonth()+1,a=e.getDate();return isNaN(o)||o<0||o>=31?n.toString()+"-"+(r<10?"0"+r.toString():r.toString())+"-"+(a<10?"0"+a.toString():a.toString()):0===o&&(i<60&&"just now"||i<120&&"1 minute ago"||i<3600&&Math.floor(i/60)+" minutes ago"||i<7200&&"1 hour ago"||i<86400&&Math.floor(i/3600)+" hours ago")||1===o&&"Yesterday"||o<7&&o+" days ago"||o<31&&Math.ceil(o/7)+" weeks ago"}};s.render=function(i,o){var s="";try{var n=t[i];if(!n){var r=i.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('"),a="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+r+"');}return p.join('');";n=new Function("obj",a),t[i]=n}return e.data=o,n.call(e,o)}catch(t){window.console.log("Template parse error: "+t.message),s=t.message}return" # ERROR: "+s+" # "}}(),s.SocialFacebook={share:function(t){var e=t;e.url=s.Utils.postUrl(t),e.cleanText=s.StringUtils.filterHtml(t.text);0!==e.url.indexOf("http")&&(e.url=e.image);var i=s.Utils.tinyparser("https://www.facebook.com/sharer/sharer.php?u={{url}}&d={{cleanText}}",e);s.Utils.popup(i,"twitter","600","430","0")}},s.SocialPinterest={share:function(t){var e=t;e.url=s.Utils.postUrl(t);s.Utils.popup(s.Utils.tinyparser("http://pinterest.com/pin/create/button/?url={{url}}&media={{image}}&description={{text}}",e),"pintrest","600","270","0")}},s.SocialTwitter={share:function(t){var e=t;e.url=s.Utils.postUrl(t),e.cleanText=s.StringUtils.filterHtml(t.text);var i="http://twitter.com/share?url={{url}}&text={{cleanText}}&hashtags={{hashtags}}";console.log(i);var o=s.Utils.tinyparser(i,e);s.Utils.popup(o,"twitter","600","430","0")}};var c='<div class="crt-filter"> <div class="crt-filter-networks"><ul class="crt-networks"> </ul></div> <div class="crt-filter-sources"><ul class="crt-sources"> </ul></div> </div>',l=' <div class="crt-popup-wrapper">     <div class="crt-popup-wrapper-c">         <div class="crt-popup-underlay"></div>         <div class="crt-popup-container"></div>     </div> </div>',h=' <div class="crt-popup">     <a href="#" class="crt-close crt-icon-cancel"></a>     <a href="#" class="crt-next crt-icon-right-open"></a>     <a href="#" class="crt-previous crt-icon-left-open"></a>     <div class="crt-popup-left">          <div class="crt-video">             <div class="crt-video-container">                <video preload="none">                <source src="<%=video%>" type="video/mp4" >                </video>                <img src="<%=image%>" />                <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a>             </div>         </div>         <div class="crt-image">             <img src="<%=image%>" />         </div>     </div>     <div class="crt-popup-right">         <div class="crt-popup-header">             <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>             <img src="<%=user_image%>"  />             <div class="crt-post-name"><span><%=user_full_name%></span><br/><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div>         </div>         <div class="crt-popup-text <%=this.contentTextClasses()%>">             <div class="crt-popup-text-container">                 <p class="crt-date"><%=this.prettyDate(source_created_at)%></p>                 <div class="crt-popup-text-body"><%=this.parseText(text)%></div>             </div>         </div>         <div class="crt-popup-footer">            <div class="crt-post-share"><span class="ctr-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>        </div>     </div> </div>';s.Templates={"v1-post":' <div class="crt-post-v1 crt-post-c">    <div class="crt-post-bg"></div>     <div class="crt-post post<%=id%> crt-post-<%=this.networkIcon()%>">         <div class="crt-post-header">             <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>             <img src="<%=user_image%>"  />             <div class="crt-post-name">            <div class="crt-post-fullname"><%=user_full_name%></div>            <div class="crt-post-username"><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div>            </div>         </div>         <div class="crt-post-content">             <div class="crt-image crt-hitarea crt-post-content-image <%=this.contentImageClasses()%>" >                 <div class="crt-image-c"><img src="<%=image%>" class="crt-post-image" /></div>                 <span class="crt-play"><i class="crt-play-icon"></i></span>             </div>             <div class="text crt-post-content-text <%=this.contentTextClasses()%>">                 <div class="crt-post-text-body"><%=this.parseText(text)%></div>             </div>         </div>         <div class="crt-post-footer">            <div class="crt-date"><%=this.prettyDate(source_created_at)%></div>             <div class="crt-post-share"><span class="ctr-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>        </div>         <div class="crt-post-read-more"><a href="#" class="crt-post-read-more-button">Read more</a> </div>     </div></div>',"v1-filter":c,"v1-popup":h,"v1-popup-underlay":"","v1-popup-wrapper":l,"v1-grid-post":' <div class="crt-post-c">    <div class="crt-post post<%=id%> <%=this.contentImageClasses()%> <%=this.contentTextClasses()%>">         <div class="crt-post-content">             <div class="crt-hitarea" >                 <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class="spacer" />                 <div class="crt-post-content-image" style="background-image: url(<%=image%>);"> </div>                 <div class="crt-post-content-text-c">                     <div class="crt-post-content-text">                         <%=this.parseText(text)%>                     </div>                 </div>                 <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a>                 <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                 <div class="crt-post-hover">                    <div class="crt-post-header">                         <img src="<%=user_image%>"  />                         <div class="crt-post-name"><span><%=user_full_name%></span><br/><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div>                     </div>                     <div class="crt-post-hover-text">                         <%=this.parseText(text)%>                     </div>                     <span class="crt-social-icon crt-social-icon-hover"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                 </div>             </div>         </div>     </div></div>',"v2-post":' <div class="crt-post-v2 crt-post crt-post-<%=this.networkIcon()%> <%=this.contentTextClasses()%>  <%=this.contentImageClasses()%>" data-post="<%=id%>">     <div class="crt-post-border">        <div class="crt-post-c">            <div class="crt-post-content">                <div class="crt-image crt-hitarea crt-post-content-image" >                     <div class="crt-image-c"><img src="<%=image%>" class="crt-post-image" /></div>                     <span class="crt-play"><i class="crt-play-icon"></i></span>                 </div>                 <div class="crt-post-header">                     <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                     <div class="crt-post-fullname"><a href="<%=this.userUrl()%>" target="_blank"><%=user_full_name%></a></div>                </div>                 <div class="text crt-post-content-text">                     <%=this.parseText(text)%>                 </div>                 <div class="crt-post-read-more"><a href="#" class="crt-post-read-more-button">Read more</a> </div>             </div>             <div class="crt-post-footer">                <img class="crt-post-userimage" src="<%=user_image%>" />                 <span class="crt-post-username"><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></span>                <span class="crt-date"><%=this.prettyDate(source_created_at)%></span>                 <div class="crt-post-share"><span class="ctr-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>            </div>         </div>     </div> </div>',"v2-filter":c,"v2-popup":h,"v2-popup-underlay":"","v2-popup-wrapper":l,"v2-grid-post":' <div class="crt-grid-post crt-grid-post-v2 crt-post-<%=id%> <%=this.contentImageClasses()%> <%=this.contentTextClasses()%>">     <div class="crt-post-c">         <div class="crt-post-content">             <div class="crt-hitarea" >                 <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class="crt-spacer" />                 <div class="crt-grid-post-image">                    <div class="crt-post-content-image" style="background-image: url(<%=image%>);"> </div>                     <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a>                     <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                 </div>                <div class="crt-grid-post-text">                    <div class="crt-grid-post-text-wrap">                         <div><%=this.parseText(text)%></div>                     </div>                     <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                 </div>                <div class="crt-post-hover">                    <div class="crt-post-header">                         <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                         <div class="crt-post-fullname"><a href="<%=this.userUrl()%>" target="_blank"><%=user_full_name%></a></div>                    </div>                     <div class="crt-post-content-text">                         <%=this.parseText(text)%>                     </div>                     <div class="crt-post-read-more"><a href="#" class="crt-post-read-more-button">Read more</a> </div>                     <div class="crt-post-footer">                        <img class="crt-post-userimage" src="<%=user_image%>" />                         <span class="crt-post-username"><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></span>                        <span class="crt-date"><%=this.prettyDate(source_created_at)%></span>                         <div class="crt-post-share"><span class="ctr-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>                    </div>                 </div>             </div>         </div>     </div></div>',"v2-grid-feed":' <div class="crt-feed-window">    <div class="crt-feed"></div></div><div class="crt-feed-more"><a href="#">Load more</a></div>'},s.Template={render:function(t,e){var o="";if(1===i("#"+t).length?o=i("#"+t).html():void 0!==s.Templates[t]&&(o=s.Templates[t]),""===o)throw new Error("Could not find template "+t);var n=s.render(o,e);return i.parseHTML&&(n=i.parseHTML(n)),i(n).filter("div")}},s.UI={Layout:{}},s.UI.Layout.CarouselSettings={circular:!1,speed:5e3,duration:700,minWidth:250,panesVisible:null,moveAmount:0,autoPlay:!1,useCss:!0},i.zepto&&(s.UI.Layout.CarouselSettings.easing="ease-in-out");var p=function(t){function e(e,o){s.log("LayoutCarousel->construct"),t.call(this),this.id=s.Utils.uId(),this.current_position=0,this.animating=!1,this.timeout=null,this.FAKE_NUM=0,this.PANES_VISIBLE=0,this.options=i.extend({},s.UI.Layout.CarouselSettings,o),this.$viewport=i(e),this.$panes=this.$viewport.children(),this.$panes.detach(),this.$stage=i('<div class="ctr-carousel-stage"></div>').appendTo(this.$viewport),this.$pane_slider=i('<div class="ctr-carousel-slider"></div>').appendTo(this.$stage),this.addControls(),this.createHandlers(),this.update()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createHandlers=function(){var t=this;i(window).on("resize."+this.id,s.Utils.debounce(function(){t.updateLayout()},100))},e.prototype.destroyHandlers=function(){i(window).off("resize."+this.id)},e.prototype.update=function(){s.log("LayoutCarousel->update "),this.$panes=this.$pane_slider.children(),this.NUM_PANES=this.options.circular?this.$panes.length+1:this.$panes.length,this.NUM_PANES>0&&(this.resize(),this.move(this.current_position,!0),this.animating||this.options.autoPlay&&this.animate())},e.prototype.add=function(t){s.log("LayoutCarousel->add "+t.length),this.$pane_slider.append(t),this.$panes=this.$pane_slider.children()},e.prototype.resize=function(){var t=this,e=this.options.infinite?100*(this.NUM_PANES+1)+"%":100*this.NUM_PANES+"%";if(this.$pane_slider.css({width:e}),this.VIEWPORT_WIDTH=this.$viewport.width(),this.options.panesVisible?(this.PANES_VISIBLE=this.options.panesVisible(),this.PANE_WIDTH=this.VIEWPORT_WIDTH/this.PANES_VISIBLE):(this.PANES_VISIBLE=this.VIEWPORT_WIDTH<this.options.minWidth?1:Math.floor(this.VIEWPORT_WIDTH/this.options.minWidth),this.PANE_WIDTH=this.VIEWPORT_WIDTH/this.PANES_VISIBLE),this.options.infinite){this.$panes.filter(".crt-clone").remove();for(var o=this.NUM_PANES-1;o>this.NUM_PANES-1-this.PANES_VISIBLE;o--){var s=t.$panes.eq(o).clone();s.addClass("crt-clone"),s.css("opacity","1"),s.find(".crt-post-image").css({opacity:1}),t.$pane_slider.prepend(s),t.FAKE_NUM=t.PANES_VISIBLE}this.$panes=this.$pane_slider.children()}this.$panes.each(function(e,o){i(o).css({width:t.PANE_WIDTH+"px"})})},e.prototype.updateLayout=function(){this.resize(),this.move(this.current_position,!0),this.options.autoPlay&&this.animate()},e.prototype.animate=function(){var t=this;this.animating=!0,clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.next()},this.options.speed)},e.prototype.next=function(){var t=this.options.moveAmount?this.options.moveAmount:this.PANES_VISIBLE;this.move(this.current_position+t,!1)},e.prototype.prev=function(){var t=this.options.moveAmount?this.options.moveAmount:this.PANES_VISIBLE;this.move(this.current_position-t,!1)},e.prototype.move=function(t,e){s.log("LayoutCarousel->move "+t),this.current_position=t;var i=this.NUM_PANES-this.PANES_VISIBLE;this.current_position<0?this.current_position=0:this.current_position>i&&(this.current_position=i);var o=this.FAKE_NUM+this.current_position,n=o*this.PANE_WIDTH,r=this.options.infinite?this.PANE_WIDTH*this.NUM_PANES:this.PANE_WIDTH*this.NUM_PANES-this.VIEWPORT_WIDTH;this.currentLeft=n,this.currentLeft=n<0?0:n>r?r:n;var a=0-this.currentLeft;if(s.log("LayoutCarousel->move x:"+a),e)this.$pane_slider.css({transform:"translate3d("+a+"px, 0px, 0px)"}),this.moveComplete();else{var c={duration:this.options.duration,complete:this.moveComplete.bind(this)};this.options.easing&&(c.easing=this.options.easing),this.$pane_slider.addClass("crt-animate-transform"),this.$pane_slider.animate({transform:"translate3d("+a+"px, 0px, 0px)"},c)}},e.prototype.moveComplete=function(){var t=this;s.log("LayoutCarousel->moveComplete"),this.options.infinite&&this.current_position>=this.NUM_PANES-this.PANES_VISIBLE&&(this.$pane_slider.css({transform:"translate3d(0px, 0px, 0px)"}),this.current_position=0-this.PANES_VISIBLE,this.currentLeft=0),setTimeout(function(){t.updateHeight()},50),this.trigger(s.Events.CAROUSEL_CHANGED,[this,this.current_position]),this.options.autoPlay&&this.animate()},e.prototype.updateHeight=function(){var t=this;s.log("LayoutCarousel->updateHeight");for(var e=0,o=this.options.infinite?this.current_position+this.FAKE_NUM:this.current_position,n=o+this.PANES_VISIBLE,r=o;r<n;r++){var a=i(t.$panes[r]).height();a>e&&(e=a)}this.$stage.height()!==e&&this.$stage.animate({height:e},300)},e.prototype.addControls=function(){this.$viewport.append('<button type="button" data-role="none" class="crt-panel-prev crt-panel-arrow" aria-label="Previous" role="button" aria-disabled="false">Previous</button>'),this.$viewport.append('<button type="button" data-role="none" class="crt-panel-next crt-panel-arrow" aria-label="Next" role="button" aria-disabled="false">Next</button>'),this.$viewport.on("click",".crt-panel-prev",this.prev.bind(this)),this.$viewport.on("click",".crt-panel-next",this.next.bind(this))},e.prototype.destroy=function(){this.destroyHandlers(),clearTimeout(this.timeout)},e}(n);s.UI.Layout.Carousel=p,s.UI.Layout.WaterfallSettings={selector:".item",width:225,gutter:20,animate:!1,animationOptions:{speed:200,duration:300,effect:"fadeInOnAppear",queue:!0,complete:function(){}}};var u=function(t,e){s.log("WaterfallLayout->onPostsLoaded"),this.element=i(e),this.id=s.Utils.uId();this.name=this._setName(5),this.gridArr=[],this.gridArrAppend=[],this.gridArrPrepend=[],this.setArr=!1,this.setGrid=!1,this.cols=0,this.itemCount=0,this.isPrepending=!1,this.appendCount=0,this.resetCount=!0,this.ifCallback=!0,this.box=this.element,this.boxWidth=this.box.width(),this.options=i.extend(!0,{},s.UI.Layout.WaterfallSettings,t),this.gridArr=i.makeArray(this.box.find(this.options.selector)),this.isResizing=!1,this.w=0,this.boxArr=[],this._setCols(),this._renderGrid("append"),i(this.box).addClass("gridalicious"),this.createHandlers()};u.prototype.createHandlers=function(){var t=this;s.log("WaterfallLayout->createHandlers"),i(window).on("resize."+this.id,s.Utils.debounce(function(){t.resize()},100))},u.prototype.destroyHandlers=function(){s.log("WaterfallLayout->destroyHandlers"),i(window).off("resize."+this.id)},u.prototype._setName=function(t,e){return e=e?e:"",t?this._setName(--t,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(60*Math.random()))+e):e},u.prototype._setCols=function(){var t=this;this.cols=Math.floor(this.box.width()/this.options.width),this.cols<1&&(this.cols=1),diff=(this.box.width()-this.cols*this.options.width-this.options.gutter)/this.cols,w=(this.options.width+diff)/this.box.width()*100,this.w=w,this.colHeights=new Array(this.cols),this.colHeights.fill(0),this.colItems=new Array(this.cols),this.colItems.fill([]);for(var e=0;e<this.cols;e++){var o=i("<div></div>").addClass("galcolumn").attr("id","item"+e+t.name).css({width:w+"%",paddingLeft:t.options.gutter,paddingBottom:t.options.gutter,float:"left","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","-o-box-sizing":"border-box","box-sizing":"border-box"});t.box.append(o)}},u.prototype._renderGrid=function(t,e,o,s){var n=this,r=[],a=[],c=this.appendCount,l=(this.options.gutter,this.cols),h=this.name;i(".galcolumn").width();e?(a=e,"append"===t&&(c+=o,this.appendCount),"prepend"===t&&(this.isPrepending=!0,Math.round(o%l)<=0&&l),"renderAfterPrepend"===t&&(c+=o)):(a=this.gridArr,c=i(this.gridArr).length);for(var p=0,u=a;p<u.length;p+=1){var d=u[p];d.hasClass("not-responsive")&&"auto",d.css({zoom:"1",filter:"alpha(opacity=0)",opacity:"0"});for(var f=0,g=1;g<this.colHeights.length;g++)n.colHeights[g]<n.colHeights[f]&&(f=g);"prepend"===t?(i("#item"+f+h).prepend(d),r.push(d)):(i("#item"+f+h).append(d),r.push(d),c>=l&&(c-=l)),n.colItems[f].push(d),n.colHeights[f]+=d.height()}this.appendCount=c,"append"===t||"prepend"===t?("prepend"===t&&this._updateAfterPrepend(this.gridArr,a),this._renderItem(r),this.isPrepending=!1):this._renderItem(this.gridArr)},u.prototype._collectItems=function(){var t=[];return i(this.box).find(this.options.selector).each(function(e){t.push(i(this))}),t},u.prototype._renderItem=function(t){var e=this.options.animationOptions.speed,o=this.options.animationOptions.effect,s=this.options.animationOptions.duration,n=this.options.animationOptions.queue,r=this.options.animate,a=this.options.animationOptions.complete,c=0,l=0;r!==!0||this.isResizing?(i.each(t,function(t,e){i(e).css({opacity:"1",filter:"alpha(opacity=100)"})}),this.ifCallback&&a.call(t)):(n===!0&&"fadeInOnAppear"===o?(this.isPrepending&&t.reverse(),i.each(t,function(o,n){setTimeout(function(){i(n).animate({opacity:"1.0"},s),++l===t.length&&a.call(void 0,t)},c*e),c++})):n===!1&&"fadeInOnAppear"===o&&(this.isPrepending&&t.reverse(),i.each(t,function(e,o){i(o).animate({opacity:"1.0"},s),++l===t.length&&this.ifCallback&&a.call(void 0,t)})),n!==!0||o||i.each(t,function(e,o){i(o).css({opacity:"1",filter:"alpha(opacity=100)"}),++l===t.length&&this.ifCallback&&a.call(void 0,t)}))},u.prototype._updateAfterPrepend=function(t,e){var o=this.gridArr;i.each(e,function(t,e){o.unshift(e)}),this.gridArr=o},u.prototype.resize=function(){if(this.box.width()!==this.boxWidth){var t=Math.floor(this.box.width()/this.options.width);this.cols!==t&&(this.box.find(i(".galcolumn")).remove(),this._setCols(),this.ifCallback=!1,this.isResizing=!0,this._renderGrid("append"),this.ifCallback=!0,this.isResizing=!1,this.boxWidth=this.box.width())}},u.prototype.append=function(t){var e=this.gridArr,o=this.gridArrPrepend;i.each(t,function(t,i){e.push(i),o.push(i)}),this._renderGrid("append",t,i(t).length)},u.prototype.prepend=function(t){this.ifCallback=!1,this._renderGrid("prepend",t,i(t).length),this.ifCallback=!0},u.prototype.destroy=function(){this.destroyHandlers()},s.UI.Layout.Waterfall=u;var d=function(t,e,i){s.log("Popup->init "),this.popupManager=t,this.json=e.json,this.widget=i;var o=this.widget.options.templatePopup;if(this.videoPlaying=!1,this.$popup=s.Template.render(o,this.json),this.json.image&&this.$popup.addClass("has-image"),this.json.video&&this.$popup.addClass("has-video"),this.json.video&&this.json.video.indexOf("youtu")>=0){this.$popup.find("video").remove();var n=s.StringUtils.youtubeVideoId(this.json.video),r='<iframe id="ytplayer" type="text/html" width="615" height="615"         src="https://www.youtube.com/embed/'+n+'?autoplay=0&rel=0&showinfo"         frameborder="0"></iframe>';this.$popup.find(".crt-video-container img").remove(),this.$popup.find(".crt-video-container a").remove(),this.$popup.find(".crt-video-container").append(r)}else if(this.json.video&&this.json.video.indexOf("vimeo")>=0){this.$popup.find("video").remove();var a=s.StringUtils.vimeoVideoId(this.json.video);if(a){var c='<iframe src="https://player.vimeo.com/video/'+a+'?color=ffffff&title=0&byline=0&portrait=0" width="615" height="615" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>';this.$popup.find(".crt-video-container img").remove(),this.$popup.find(".crt-video-container a").remove(),this.$popup.find(".crt-video-container").append(c)}}this.$popup.on("click"," .crt-close",this.onClose.bind(this)),this.$popup.on("click"," .crt-previous",this.onPrevious.bind(this)),this.$popup.on("click"," .crt-next",this.onNext.bind(this)),this.$popup.on("click"," .crt-play",this.onPlay.bind(this)),this.$popup.on("click",".crt-share-facebook",this.onShareFacebookClick.bind(this)),this.$popup.on("click",".crt-share-twitter",this.onShareTwitterClick.bind(this))};d.prototype.onShareFacebookClick=function(t){return t.preventDefault(),s.SocialFacebook.share(this.json),this.widget.track("share:facebook"),!1},d.prototype.onShareTwitterClick=function(t){return t.preventDefault(),s.SocialTwitter.share(this.json),this.widget.track("share:twitter"),!1},d.prototype.onClose=function(t){t.preventDefault();var e=this;this.hide(function(){e.popupManager.onClose()})},d.prototype.onPrevious=function(t){t.preventDefault(),this.popupManager.onPrevious()},d.prototype.onNext=function(t){t.preventDefault(),this.popupManager.onNext()},d.prototype.onPlay=function(t){s.log("Popup->onPlay"),t.preventDefault(),this.videoPlaying=!this.videoPlaying,this.videoPlaying?(this.$popup.find("video")[0].play(),this.widget.track("video:play")):(this.$popup.find("video")[0].pause(),this.widget.track("video:pause")),s.log(this.videoPlaying),this.$popup.toggleClass("video-playing",this.videoPlaying)},d.prototype.show=function(){this.$popup.fadeIn(function(){})},d.prototype.hide=function(t){s.log("Popup->hide");var e=this;this.$popup.fadeOut(function(){e.destroy(),t()})},d.prototype.destroy=function(){this.$popup&&this.$popup.length&&(this.$popup.remove(),this.$popup.find("video").length&&this.$popup.find("video")[0].pause()),delete this.$popup},s.Popup=d,s.PopupInappropriate=function(t,e){this.init(t,e)},i.extend(s.PopupInappropriate.prototype,{feed:null,post:null,init:function(t,e){var o=this;this.feed=e,this.post=t,this.jQueryel=i(".mark-bubble"),i(".mark-close").click(function(t){t.preventDefault(),i(this).parent().fadeOut("slow")}),i(".mark-bubble .submit").click(function(){var t=o.$el.find("input.text"),s=i.trim(t.val());s&&(t.disabled=!0,i(this).hide(),o.$el.find(".waiting").show(),e.inappropriatePost(o.post.id,s,function(){t.val(""),o.$el.find(".waiting").hide(),o.$el.find(".title").html("Thank you"),o.$el.find("input.text").hide(),o.$el.find("input.text").html(""),o.$el.find(".success-message").html("This message has been marked as inappropriate").show()},function(){o.$el.find(".waiting").hide(),o.$el.find(".title").html("Oops"),o.$el.find("input.text").hide(),o.$el.find("input.text").html(""),o.$el.find(".success-message").html("It looks like a problem has occurred. Please try again later").show()}))}),this.$el.fadeIn("slow")}});var f=function(t){s.log("PopupManager->init "),this.widget=t;var e=this.widget.options.templatePopupWrapper;this.$wrapper=s.Template.render(e,{}),this.$popupContainer=this.$wrapper.find(".crt-popup-container"),this.$underlay=this.$wrapper.find(".crt-popup-underlay"),i("body").append(this.$wrapper),this.$underlay.click(this.onUnderlayClick.bind(this))};f.prototype.showPopup=function(t){var e=this;this.popup?this.popup.hide(function(){e.popup.destroy(),e.showPopup2(t)}):this.showPopup2(t)},f.prototype.showPopup2=function(t){var e=this;this.popup=new s.Popup(this,t,this.widget),this.$popupContainer.append(this.popup.$popup),this.$wrapper.show(),"block"!==this.$underlay.css("display")&&this.$underlay.fadeIn(),this.popup.show(),i("body").addClass("crt-popup-visible"),this.currentPostNum=0;for(var o=0;o<this.posts.length;o++)if(t.json.id==e.posts[o].id){e.currentPostNum=o,s.log("Found post "+o);break}this.widget.track("popup:show")},f.prototype.setPosts=function(t){this.posts=t},f.prototype.onClose=function(){this.hide()},f.prototype.onPrevious=function(){this.currentPostNum-=1,this.currentPostNum=this.currentPostNum>=0?this.currentPostNum:this.posts.length-1,this.showPopup({json:this.posts[this.currentPostNum]})},f.prototype.onNext=function(){
this.currentPostNum+=1,this.currentPostNum=this.currentPostNum<this.posts.length?this.currentPostNum:0,this.showPopup({json:this.posts[this.currentPostNum]})},f.prototype.onUnderlayClick=function(t){s.log("PopupManager->onUnderlayClick"),t.preventDefault(),this.popup&&this.popup.hide(function(){this.hide()}.bind(this))},f.prototype.hide=function(){var t=this;s.log("PopupManager->hide"),this.widget.track("popup:hide"),i("body").removeClass("crt-popup-visible"),this.currentPostNum=0,this.popup=null,this.$underlay.fadeOut(function(){t.$underlay.css({display:"",opacity:""}),t.$wrapper.hide()})},f.prototype.destroy=function(){this.$underlay.remove(),delete this.$popup,delete this.$underlay},s.PopupManager=f;var g=function(t){function e(e,i,o){var n=this;t.call(this),this.options=i,this.widget=o;var r=this.widget.options.templatePost;if(this.json=e,this.$el=s.Template.render(r,e),this.$el.find(".crt-share-facebook").click(this.onShareFacebookClick.bind(this)),this.$el.find(".crt-share-twitter").click(this.onShareTwitterClick.bind(this)),this.$el.find(".crt-post-read-more-button").click(this.onReadMoreClick.bind(this)),this.$el.click(this.onPostClick.bind(this)),this.$post=this.$el.find(".crt-post-c"),this.$image=this.$el.find(".crt-post-image"),this.$imageContainer=this.$el.find(".crt-image-c"),this.$image.css({opacity:0}),this.json.image?(this.$image.on("load",this.onImageLoaded.bind(this)),this.$image.on("error",this.onImageError.bind(this))):setTimeout(function(){n.setHeight()},100),this.json.image_width>0){var a=this.json.image_height/this.json.image_width*100;this.$imageContainer.addClass("crt-image-responsive").css("padding-bottom",a+"%")}0!==this.json.url.indexOf("http")&&this.$el.find(".crt-post-share").hide(),this.$image.data("dims",this.json.image_width+":"+this.json.image_height),this.$post=this.$el.find(".crt-post"),this.json.video&&this.$post.addClass("has-video")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onShareFacebookClick=function(t){return t.preventDefault(),s.SocialFacebook.share(this.json),this.widget.track("share:facebook"),!1},e.prototype.onShareTwitterClick=function(t){return t.preventDefault(),s.SocialTwitter.share(this.json),this.widget.track("share:twitter"),!1},e.prototype.onPostClick=function(t){s.log("Post->click");var e=i(t.target);e.is("a")&&"#"!==e.attr("href")?this.widget.track("click:link"):(t.preventDefault(),this.trigger(s.Events.POST_CLICK,this,this.json,t))},e.prototype.onImageLoaded=function(){this.$image.animate({opacity:1}),this.setHeight(),this.trigger(s.Events.POST_IMAGE_LOADED,this)},e.prototype.onImageError=function(){this.$image.hide(),this.setHeight()},e.prototype.setHeight=function(){var t=this.$post.height();this.options.maxHeight&&this.options.maxHeight>0&&t>this.options.maxHeight&&this.$post.css({maxHeight:this.options.maxHeight}).addClass("crt-post-max-height"),this.layout()},e.prototype.layout=function(){this.layoutFooter()},e.prototype.layoutFooter=function(){var t=this.$el.find(".crt-post-username"),e=this.$el.find(".crt-date"),i=this.$el.find(".crt-post-footer"),o=this.$el.find(".crt-post-share"),s=this.$el.find(".crt-post-userimage"),n=i.width();t.width()+e.width()+o.width()+s.width()+40>n&&t.hide()},e.prototype.onReadMoreClick=function(t){t.preventDefault(),this.widget.track("click:read-more"),this.trigger(s.Events.POST_CLICK_READ_MORE,this,this.json,t)},e}(n);s.Post=g,s.Utils={postUrl:function(t){return t.url&&""!==t.url&&"''"!==t.url?t.url:(console.log(t.url),t.network_id+""=="1"?"https://twitter.com/"+t.user_screen_name+"/status/"+t.source_identifier:"")},center:function(t,e,i){var o=window.screen,s=i||{},n=s.height||o.height,r=s.width||o.height;return{top:n?(n-e)/2:0,left:r?(r-t)/2:0}},popup:function(t,e,i,o,s){var n=this.center(i,o),r="height="+o+",width="+i+",top="+n.top+",left="+n.left+",scrollbars="+s+",resizable";window.open(t,e,r)},tinyparser:function(t,e){return t.replace(/\{\{(.*?)\}\}/g,function(t,i){return e&&void 0!==e[i]?encodeURIComponent(e[i]):""})},debounce:function(t,e,i){var o;return function(){var s=this,n=arguments,r=function(){o=null,i||t.apply(s,n)},a=i&&!o;clearTimeout(o),o=setTimeout(r,e),a&&t.apply(s,n)}},uId:function(){return"_"+Math.random().toString(36).substr(2,9)}},s.DateUtils={dateFromString:function(t){dtstr=t.replace(/\D/g," ");var e=dtstr.split(" ");return e[1]--,new Date(Date.UTC(e[0],e[1],e[2],e[3],e[4],e[5]))},dateAsDayMonthYear:function(t){var e=new Date(parseInt(t,10)),i=e.getDate()+"",o=e.getMonth()+1+"",s=e.getFullYear()+"";return i=1===i.length?"0"+i:i,o=1===o.length?"0"+o:o,i+"/"+o+"/"+s},dateAsTimeArray:function(t){var e,i=new Date(parseInt(t,10)),o=i.getHours()+"",s=i.getMinutes()+"";return o>=12?(e="PM",o>12&&(o=o-12+"")):e="AM",o=1===o.length?"0"+o:o,s=1===s.length?"0"+s:s,[parseInt(o.charAt(0),10),parseInt(o.charAt(1),10),parseInt(s.charAt(0),10),parseInt(s.charAt(1),10),e]}},s.StringUtils={camelize:function(t){return t.replace(/(?:^|[-_])(\w)/g,function(t,e){return e?e.toUpperCase():""})},twitterLinks:function(t){return t=t.replace(/[@]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("@","");return s.StringUtils.url("https://twitter.com/"+e,t)}),t=t.replace(/[#]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("#","%23");return s.StringUtils.url("https://twitter.com/search?q="+e,t)})},instagramLinks:function(t){return t=t.replace(/[@]+[A-Za-z0-9-_\.]+/g,function(t){var e=t.replace("@","");return s.StringUtils.url("https://www.instagram.com/"+e+"/",t)}),t=t.replace(/[#]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("#","");return s.StringUtils.url("https://www.instagram.com/explore/tags/"+e+"/",t)})},facebookLinks:function(t){return t=t.replace(/[@]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("@","");return s.StringUtils.url("https://www.facebook.com/"+e+"/",t)}),t=t.replace(/[#]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("#","%23");return s.StringUtils.url("https://www.facebook.com/search/top/?q="+e,t)})},linksToHref:function(t){return t=t.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&~\?\/.=]+/g,function(t){return s.StringUtils.url(t)})},url:function(t,e){return e=e||t,'<a href="'+t+'" target="_blank">'+e+"</a>"},youtubeVideoId:function(t){var e=t.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);if(e&&11==e[7].length)return e[7];var i=t.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/))([^#\&\?]*).*/);return!(!i||11!=i[6].length)&&i[6]},vimeoVideoId:function(t){var e=t.match(/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?/);return console.log(e),!!(e&&e.length>=2)&&e[1]},filterHtml:function(t){try{var e=document.createElement("div");e.innerHTML=t;return e.textContent||e.innerText||""}catch(e){return t}},nl2br:function(t){return t=t.trim(),t=t.replace(/(?:\r\n|\r|\n)/g,"<br />")}};var v=function(t){function e(){s.log("Widget->construct"),t.call(this),this.id=s.Utils.uId()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setOptions=function(t,e){return this.options=i.extend(!0,{},e,t),t.debug&&(s.debug=!0),!0},e.prototype.init=function(){return!!s.checkContainer(this.options.container)&&(this.$container=i(this.options.container),this.$container.addClass("crt-feed"),this.createFeed(),this.createFilter(),this.createPopupManager(),!0)},e.prototype.createFeed=function(){this.feed=new s.Feed(this),this.feed.on(s.Events.POSTS_LOADED,this.onPostsLoaded.bind(this)),this.feed.on(s.Events.POSTS_FAILED,this.onPostsFail.bind(this)),this.feed.on(s.Events.FEED_LOADED,this.onFeedLoaded.bind(this))},e.prototype.createPopupManager=function(){this.popupManager=new s.PopupManager(this)},e.prototype.createFilter=function(){s.log("Widget->createFilter"),s.log(this.options.filter),this.options.filter&&(this.options.filter.showNetworks||this.options.filter.showSources)&&(this.filter=new s.Filter(this))},e.prototype.loadPosts=function(t){this.feed.loadPosts(t)},e.prototype.createPostElements=function(t){var e=this,o=[];return i(t).each(function(){var t=e.createPostElement(this);o.push(t.$el)}),o},e.prototype.createPostElement=function(t){var e=new s.Post(t,this.options,this);return e.on(s.Events.POST_CLICK,this.onPostClick.bind(this)),e.on(s.Events.POST_CLICK_READ_MORE,this.onPostClick.bind(this)),e.on(s.Events.POST_IMAGE_LOADED,this.onPostImageLoaded.bind(this)),this.trigger(s.Events.POST_CREATED,e),e},e.prototype.onPostsLoaded=function(t,e){s.log("Widget->onPostsLoaded"),s.log(e)},e.prototype.onPostsFail=function(t,e){s.log("Widget->onPostsLoadedFail"),s.log(e)},e.prototype.onPostClick=function(t,e,i){s.log("Widget->onPostClick"),s.log(t),s.log(i),this.options.showPopupOnClick&&this.popupManager.showPopup(e)},e.prototype.onPostImageLoaded=function(t,e){s.log("Widget->onPostImageLoaded")},e.prototype.onFeedLoaded=function(t,e){e.account.plan.unbranded||this.$container.addClass("crt-feed-branded")},e.prototype.track=function(t){s.log("Feed->track "+t),s.ajax(this.getUrl("/track/"+this.options.feedId),{a:t},function(t){s.log("Feed->track success"),s.log(t)},function(t,e,i){s.log("Feed->_loadPosts fail"),s.log(e),s.log(i)})},e.prototype.getUrl=function(t){return this.options.apiEndpoint+t},e.prototype.destroy=function(){s.log("Widget->destroy"),t.prototype.destroy.call(this),this.feed&&this.feed.destroy(),this.filter&&this.filter.destroy(),this.popupManager&&this.popupManager.destroy(),this.$container.removeClass("crt-feed")},e}(n);s.Widget=v,s.Config.Carousel=i.extend({},s.Config.Defaults,{scroll:"more",carousel:{autoPlay:!0,autoLoad:!0,infinite:!1}});var m=function(t){function e(e){var o=this;t.call(this),e.postsPerPage=60,this.setOptions(e,s.Config.Carousel),this.containerHeight=0,this.loading=!1,this.posts=[],this.firstLoad=!0,s.log("Carousel->init with options:"),s.log(this.options),this.init(this)&&(this.allLoaded=!1,this.$feed=i('<div class="crt-carousel-feed"></div>').appendTo(this.$container),this.$container.addClass("crt-carousel"),this.carousel=new s.UI.Layout.Carousel(this.$feed,this.options.carousel),this.carousel.on(s.Events.CAROUSEL_CHANGED,this.onCarouselChange.bind(this)),this.on(s.Events.FILTER_CHANGED,function(t){o.$feed.find(".crt-post").remove()}),this.loadPosts(0))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.loadMorePosts=function(){s.log("Carousel->loadMorePosts"),this.feed.postCount>this.feed.postsLoaded&&this.feed.loadPosts(this.feed.currentPage+1)},e.prototype.onPostsLoaded=function(t,e){if(s.log("Carousel->onPostsLoaded"),this.loading=!1,0===e.length)this.allLoaded=!0;else{var o=this,n=[];i(e).each(function(t){var e=o.createPostElement(this);n.push(e.$el),o.options.animate&&o.firstLoad&&(e.$el.css({opacity:0}),setTimeout(function(){console.log(t),e.$el.css({opacity:0}).animate({opacity:1})},100*t))}),this.carousel.add(n),this.carousel.update(),this.popupManager.setPosts(e),this.options.onPostsLoaded(this,e)}this.firstLoad=!1},e.prototype.onCarouselChange=function(t,e){this.options&&this.options.carousel.autoLoad&&e>=this.feed.postsLoaded-this.carousel.PANES_VISIBLE&&this.loadMorePosts()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.feed.destroy(),this.carousel.off(s.Events.CAROUSEL_CHANGED,this.onCarouselChange.bind(this)),this.carousel.destroy(),this.$feed.remove(),this.$container.removeClass("crt-carousel"),delete this.$feed,delete this.$container,delete this.options,delete this.feed.postsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},e}(v);s.Carousel=m,s.Config.Custom=i.extend({},s.Config.Defaults,{});!function(t){function e(e){t.call(this),this.containerHeight=0,this.loading=!1,this.feed=null,this.$container=null,this.$feed=null,this.posts=[],this.totalPostsLoaded=0,this.allLoaded=!1,this.setOptions(e,s.Config.Custom),s.log("Panel->init with options:"),s.log(this.options),this.init(this)&&(this.$feed=i('<div class="crt-feed"></div>').appendTo(this.$container),this.$container.addClass("crt-custom"),this.loadPosts(0))}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onPostsLoaded=function(t,e){if(s.log("Custom->onPostsLoaded"),this.loading=!1,0===e.length)this.allLoaded=!0;else{var o=this,n=[];i(e).each(function(){var t=o.createPostElement(this);n.push(t.$el),o.$feed.append(t.$el)}),this.popupManager.setPosts(e),this.options.onPostsLoaded(this,e)}},e.prototype.onPostClick=function(t,e){this.popupManager.showPopup(e)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.feed.destroy(),this.$feed.remove(),this.$container.removeClass("crt-custom"),delete this.$feed,delete this.$container,delete this.options,delete this.totalPostsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},e}(v);s.Config.Grid=i.extend({},s.Config.Defaults,{templatePost:"v2-grid-post",templateFeed:"v2-grid-feed",animate:!1,grid:{minWidth:200,rows:3}});var y=function(t){function e(e){if(t.call(this),this.setOptions(e,s.Config.Grid),s.log("Grid->init with options:"),s.log(this.options),this.containerHeight=0,this.loading=!1,this.feed=null,this.$container=null,this.$feed=null,this.posts=[],this.columnCount=0,this.rowsMax=0,this.totalPostsLoaded=0,this.allLoaded=!1,this.init(this)){var i=s.Template.render(this.options.templateFeed,{});this.$container.append(i),this.$feed=this.$container.find(".crt-feed"),this.$feedWindow=this.$container.find(".crt-feed-window"),this.$loadMore=this.$container.find(".crt-feed-more a"),this.$container.addClass("crt-grid"),this.options.grid.showLoadMore?(this.$feedWindow.css({position:"relative"}),this.$loadMore.click(this.onMoreClicked.bind(this))):this.$loadMore.hide(),this.createHandlers(),this.rowsMax=this.options.grid.rows,this.updateLayout()}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.loadPosts=function(){},e.prototype.updateLayout=function(){var t=Math.floor(this.$container.width()/this.options.grid.minWidth);t=t<1?1:t,this.$container.removeClass("crt-grid-col"+this.columnCount),this.columnCount=t,this.$container.addClass("crt-grid-col"+this.columnCount);var e=t*(this.rowsMax+1);if(e>this.feed.postsLoaded&&!this.feed.allPostsLoaded){var i=e-this.feed.postsLoaded,o={limit:i};this.feed.pagination&&this.feed.pagination.after&&(o.after=this.feed.pagination.after),this.feed._loadPosts(o)}else this.updateHeight(!1)},e.prototype.updateHeight=function(t){var e=this.$container.find(".crt-post-c").width();this.$feedWindow.css({overflow:"hidden"});var i=Math.ceil(this.feed.postCount/this.columnCount),o=this.rowsMax<i?this.rowsMax:i;t?this.$feedWindow.animate({height:o*e}):this.$feedWindow.height(o*e),this.options.grid.showLoadMore&&(this.feed.allPostsLoaded?this.$loadMore.hide():this.$loadMore.show())},e.prototype.createHandlers=function(){var t=this,e=this.id,o=s.Utils.debounce(function(){t.updateLayout()},100);i(window).on("resize."+e,o),i(window).on("curatorCssLoaded."+e,o),i(document).on("ready."+e,o)},e.prototype.destroyHandlers=function(){var t=this.id;i(window).off("resize."+t),i(window).off("curatorCssLoaded."+t),i(document).off("ready."+t)},e.prototype.onPostsLoaded=function(t,e){var i=this;if(s.log("Grid->onPostsLoaded"),this.loading=!1,0===e.length)this.allLoaded=!0;else{this.postElements=[];for(var o=0,n=0,r=e;n<r.length;n+=1)!function(){var t=r[n],e=i.createPostElement(t);i.postElements.push(e),i.$feed.append(e.$el),e.layout(),i.options.animate&&(e.$el.css({opacity:0}),setTimeout(function(){e.$el.css({opacity:0}).animate({opacity:1})},100*o),o++)}();this.popupManager.setPosts(e),this.options.onPostsLoaded(this,e),this.updateHeight(!0)}},e.prototype.onMoreClicked=function(t){t.preventDefault();var e=1;this.columnCount<=1?e=4:2===this.columnCount&&(e=2),this.rowsMax+=e,this.updateLayout()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.feed.destroy(),this.destroyHandlers(),this.$container.empty().removeClass("crt-grid").removeClass("crt-grid-col"+this.columnCount).css({height:"",overflow:""}),delete this.$feed,delete this.$container,delete this.options,delete this.totalPostsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},e}(v);s.Grid=y,s.Config.Panel=i.extend({},s.Config.Defaults,{panel:{autoPlay:!0,autoLoad:!0,moveAmount:1,fixedHeight:!1,infinite:!0,minWidth:2e3}});var P=function(t){function e(e){t.call(this),this.setOptions(e,s.Config.Panel),s.log("Panel->init with options:"),s.log(this.options),this.containerHeight=0,this.loading=!1,this.feed=null,this.$container=null,this.$feed=null,this.posts=[],this.init(this)&&(this.allLoaded=!1,this.$feed=i('<div class="crt-feed"></div>').appendTo(this.$container),this.$container.addClass("crt-carousel"),this.$container.addClass("crt-panel"),this.options.panel.fixedHeight&&this.$container.addClass("crt-panel-fixed-height"),this.carousel=new s.UI.Layout.Carousel(this.$feed,this.options.panel),this.carousel.on(s.Events.CAROUSEL_CHANGED,this.onCarouselChange.bind(this)),this.loadPosts(0))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.loadMorePosts=function(){s.log("Panel->loadMorePosts"),this.feed.loadPosts(this.feed.currentPage+1)},e.prototype.onPostsLoaded=function(t,e){if(s.log("Panel->onPostsLoaded"),this.loading=!1,0===e.length)this.allLoaded=!0;else{var o=this,n=[];i(e).each(function(){var t=o.createPostElement(this);n.push(t.$el)}),this.carousel.add(n),this.carousel.update(),this.popupManager.setPosts(e),this.options.onPostsLoaded(this,e)}},e.prototype.onPostImageLoaded=function(t,e){s.log("Panel->onPostImageLoaded"),this.carousel.updateHeight()},e.prototype.onCarouselChange=function(t,e){this.options&&this.options.panel.autoLoad&&e>=this.feed.postsLoaded-4&&this.loadMorePosts()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.feed.destroy(),this.carousel.off(s.Events.CAROUSEL_CHANGED,this.onCarouselChange.bind(this)),this.carousel.destroy(),this.$feed.remove(),this.$container.removeClass("crt-panel"),this.$container.removeClass("crt-carousel"),delete this.$feed,delete this.$container,delete this.options,delete this.feed.postsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},e}(v);s.Panel=P,s.Config.Waterfall=i.extend({},s.Config.Defaults,{scroll:"more",waterfall:{gridWidth:300,animate:!0,animateSpeed:400}});var b=function(t){function e(e){var o=this;t.call(this),this.setOptions(e,s.Config.Waterfall),s.log("Waterfall->init with options:"),s.log(this.options),this.init(this)&&(this.$scroll=i('<div class="crt-feed-scroll"></div>').appendTo(this.$container),this.$feed=i('<div class="crt-feed"></div>').appendTo(this.$scroll),this.$container.addClass("crt-feed-container"),"continuous"===this.options.scroll?i(this.$scroll).scroll(function(){var t=o.$scroll.height(),e=o.$feed.height();o.$scroll.scrollTop()>=e-t&&o.loadMorePosts()}):"none"===this.options.scroll||(this.$more=i('<div class="crt-feed-more"><a href="#"><span>Load more</span></a></div>').appendTo(this.$scroll),this.$more.find("a").on("click",function(t){t.preventDefault(),o.loadMorePosts()})),this.ui=new s.UI.Layout.Waterfall({selector:".crt-post-c",gutter:0,width:this.options.waterfall.gridWidth,animate:this.options.waterfall.animate,animationOptions:{speed:this.options.waterfall.animateSpeed/2,duration:this.options.waterfall.animateSpeed}},this.$feed),this.on(s.Events.FILTER_CHANGED,function(t){o.$feed.find(".crt-post").remove()}),this.feed.load())}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.loadMorePosts=function(){s.log("Waterfall->loadMorePosts"),this.feed.loadAfter()},e.prototype.loadPage=function(t){s.log("Waterfall->loadPage"),this.$feed.find(".crt-post").remove(),this.feed.loadPosts(t)},e.prototype.onPostsLoaded=function(t,e){s.log("Waterfall->onPostsLoaded");var o=this.createPostElements(e);this.ui.append(o);var n=this;i.each(o,function(t){var e=this;n.options.waterfall.showReadMore&&e.find(".crt-post").addClass("crt-post-show-read-more")}),this.feed.allPostsLoaded&&this.$more&&this.$more.hide(),this.popupManager.setPosts(e),this.loading=!1,this.options.onPostsLoaded(this,e)},e.prototype.destroy=function(){s.log("Waterfall->destroy"),t.prototype.destroy.call(this),this.feed.destroy(),this.ui.destroy(),this.$feed.remove(),this.$scroll.remove(),this.$more&&this.$more.remove(),this.$container.removeClass("crt-feed-container"),delete this.$feed,delete this.$scroll,delete this.$container,delete this.options,delete this.totalPostsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},e}(v);return s.Waterfall=b,t.Curator=s,s}(window)}(this);