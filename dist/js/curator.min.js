!function(global,factory){"function"==typeof define&&define.amd?define("zepto",function(){return factory(global)}):factory(global)}(window,function(window){var Zepto=function(){function type(obj){return null==obj?String(obj):class2type[toString.call(obj)]||"object"}function isFunction(value){return"function"==type(value)}function isWindow(obj){return null!=obj&&obj==obj.window}function isDocument(obj){return null!=obj&&obj.nodeType==obj.DOCUMENT_NODE}function isObject(obj){return"object"==type(obj)}function isPlainObject(obj){return isObject(obj)&&!isWindow(obj)&&Object.getPrototypeOf(obj)==Object.prototype}function likeArray(obj){var length=!!obj&&"length"in obj&&obj.length,type=$.type(obj);return"function"!=type&&!isWindow(obj)&&("array"==type||0===length||"number"==typeof length&&length>0&&length-1 in obj)}function compact(array){return filter.call(array,function(item){return null!=item})}function flatten(array){return array.length>0?$.fn.concat.apply([],array):array}function dasherize(str){return str.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function classRE(name){return name in classCache?classCache[name]:classCache[name]=new RegExp("(^|\\s)"+name+"(\\s|$)")}function maybeAddPx(name,value){return"number"!=typeof value||cssNumber[dasherize(name)]?value:value+"px"}function defaultDisplay(nodeName){var element,display;return elementDisplay[nodeName]||(element=document.createElement(nodeName),document.body.appendChild(element),display=getComputedStyle(element,"").getPropertyValue("display"),element.parentNode.removeChild(element),"none"==display&&(display="block"),elementDisplay[nodeName]=display),elementDisplay[nodeName]}function children(element){return"children"in element?slice.call(element.children):$.map(element.childNodes,function(node){if(1==node.nodeType)return node})}function Z(dom,selector){var i,len=dom?dom.length:0;for(i=0;i<len;i++)this[i]=dom[i];this.length=len,this.selector=selector||""}function extend(target,source,deep){for(key in source)deep&&(isPlainObject(source[key])||isArray(source[key]))?(isPlainObject(source[key])&&!isPlainObject(target[key])&&(target[key]={}),isArray(source[key])&&!isArray(target[key])&&(target[key]=[]),extend(target[key],source[key],deep)):source[key]!==undefined&&(target[key]=source[key])}function filtered(nodes,selector){return null==selector?$(nodes):$(nodes).filter(selector)}function funcArg(context,arg,idx,payload){return isFunction(arg)?arg.call(context,idx,payload):arg}function setAttribute(node,name,value){null==value?node.removeAttribute(name):node.setAttribute(name,value)}function className(node,value){var klass=node.className||"",svg=klass&&klass.baseVal!==undefined;if(value===undefined)return svg?klass.baseVal:klass;svg?klass.baseVal=value:node.className=value}function deserializeValue(value){try{return value?"true"==value||"false"!=value&&("null"==value?null:+value+""==value?+value:/^[\[\{]/.test(value)?$.parseJSON(value):value):value}catch(e){return value}}function traverseNode(node,fun){fun(node);for(var i=0,len=node.childNodes.length;i<len;i++)traverseNode(node.childNodes[i],fun)}var undefined,key,$,classList,camelize,uniq,emptyArray=[],concat=emptyArray.concat,filter=emptyArray.filter,slice=emptyArray.slice,document=window.document,elementDisplay={},classCache={},cssNumber={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},fragmentRE=/^\s*<(\w+|!)[^>]*>/,singleTagRE=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rootNodeRE=/^(?:body|html)$/i,methodAttributes=["val","css","html","text","data","width","height","offset"],adjacencyOperators=["after","prepend","before","append"],table=document.createElement("table"),tableRow=document.createElement("tr"),containers={tr:document.createElement("tbody"),tbody:table,thead:table,tfoot:table,td:tableRow,th:tableRow,"*":document.createElement("div")},simpleSelectorRE=/^[\w-]*$/,class2type={},toString=class2type.toString,zepto={},tempParent=document.createElement("div"),propMap={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},isArray=Array.isArray||function(object){return object instanceof Array};return zepto.matches=function(element,selector){if(!selector||!element||1!==element.nodeType)return!1;var matchesSelector=element.matches||element.webkitMatchesSelector||element.mozMatchesSelector||element.oMatchesSelector||element.matchesSelector;if(matchesSelector)return matchesSelector.call(element,selector);var match,parent=element.parentNode,temp=!parent;return temp&&(parent=tempParent).appendChild(element),match=~zepto.qsa(parent,selector).indexOf(element),temp&&tempParent.removeChild(element),match},camelize=function(str){return str.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})},uniq=function(array){return filter.call(array,function(item,idx){return array.indexOf(item)==idx})},zepto.fragment=function(html,name,properties){var dom,nodes,container;return singleTagRE.test(html)&&(dom=$(document.createElement(RegExp.$1))),dom||(html.replace&&(html=html.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,"<$1></$2>")),name===undefined&&(name=fragmentRE.test(html)&&RegExp.$1),name in containers||(name="*"),container=containers[name],container.innerHTML=""+html,dom=$.each(slice.call(container.childNodes),function(){container.removeChild(this)})),isPlainObject(properties)&&(nodes=$(dom),$.each(properties,function(key,value){methodAttributes.indexOf(key)>-1?nodes[key](value):nodes.attr(key,value)})),dom},zepto.Z=function(dom,selector){return new Z(dom,selector)},zepto.isZ=function(object){return object instanceof zepto.Z},zepto.init=function(selector,context){var dom;if(!selector)return zepto.Z();if("string"==typeof selector)if(selector=selector.trim(),"<"==selector[0]&&fragmentRE.test(selector))dom=zepto.fragment(selector,RegExp.$1,context),selector=null;else{if(context!==undefined)return $(context).find(selector);dom=zepto.qsa(document,selector)}else{if(isFunction(selector))return $(document).ready(selector);if(zepto.isZ(selector))return selector;if(isArray(selector))dom=compact(selector);else if(isObject(selector))dom=[selector],selector=null;else if(fragmentRE.test(selector))dom=zepto.fragment(selector.trim(),RegExp.$1,context),selector=null;else{if(context!==undefined)return $(context).find(selector);dom=zepto.qsa(document,selector)}}return zepto.Z(dom,selector)},$=function(selector,context){return zepto.init(selector,context)},$.extend=function(target){var deep,args=slice.call(arguments,1);return"boolean"==typeof target&&(deep=target,target=args.shift()),args.forEach(function(arg){extend(target,arg,deep)}),target},zepto.qsa=function(element,selector){var found,maybeID="#"==selector[0],maybeClass=!maybeID&&"."==selector[0],nameOnly=maybeID||maybeClass?selector.slice(1):selector,isSimple=simpleSelectorRE.test(nameOnly);return element.getElementById&&isSimple&&maybeID?(found=element.getElementById(nameOnly))?[found]:[]:1!==element.nodeType&&9!==element.nodeType&&11!==element.nodeType?[]:slice.call(isSimple&&!maybeID&&element.getElementsByClassName?maybeClass?element.getElementsByClassName(nameOnly):element.getElementsByTagName(selector):element.querySelectorAll(selector))},$.contains=document.documentElement.contains?function(parent,node){return parent!==node&&parent.contains(node)}:function(parent,node){for(;node&&(node=node.parentNode);)if(node===parent)return!0;return!1},$.type=type,$.isFunction=isFunction,$.isWindow=isWindow,$.isArray=isArray,$.isPlainObject=isPlainObject,$.isEmptyObject=function(obj){var name;for(name in obj)return!1;return!0},$.isNumeric=function(val){var num=Number(val),type=typeof val;return null!=val&&"boolean"!=type&&("string"!=type||val.length)&&!isNaN(num)&&isFinite(num)||!1},$.inArray=function(elem,array,i){return emptyArray.indexOf.call(array,elem,i)},$.camelCase=camelize,$.trim=function(str){return null==str?"":String.prototype.trim.call(str)},$.uuid=0,$.support={},$.expr={},$.noop=function(){},$.map=function(elements,callback){var value,i,key,values=[];if(likeArray(elements))for(i=0;i<elements.length;i++)null!=(value=callback(elements[i],i))&&values.push(value);else for(key in elements)null!=(value=callback(elements[key],key))&&values.push(value);return flatten(values)},$.each=function(elements,callback){var i,key;if(likeArray(elements)){for(i=0;i<elements.length;i++)if(callback.call(elements[i],i,elements[i])===!1)return elements}else for(key in elements)if(callback.call(elements[key],key,elements[key])===!1)return elements;return elements},$.grep=function(elements,callback){return filter.call(elements,callback)},window.JSON&&($.parseJSON=JSON.parse),$.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()}),$.fn={constructor:zepto.Z,length:0,forEach:emptyArray.forEach,reduce:emptyArray.reduce,push:emptyArray.push,sort:emptyArray.sort,splice:emptyArray.splice,indexOf:emptyArray.indexOf,concat:function(){var i,value,args=[];for(i=0;i<arguments.length;i++)value=arguments[i],args[i]=zepto.isZ(value)?value.toArray():value;return concat.apply(zepto.isZ(this)?this.toArray():this,args)},map:function(fn){return $($.map(this,function(el,i){return fn.call(el,i,el)}))},slice:function(){return $(slice.apply(this,arguments))},ready:function(callback){if("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll)setTimeout(function(){callback($)},0);else{var handler=function(){document.removeEventListener("DOMContentLoaded",handler,!1),window.removeEventListener("load",handler,!1),callback($)};document.addEventListener("DOMContentLoaded",handler,!1),window.addEventListener("load",handler,!1)}return this},get:function(idx){return idx===undefined?slice.call(this):this[idx>=0?idx:idx+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(callback){return emptyArray.every.call(this,function(el,idx){return callback.call(el,idx,el)!==!1}),this},filter:function(selector){return isFunction(selector)?this.not(this.not(selector)):$(filter.call(this,function(element){return zepto.matches(element,selector)}))},add:function(selector,context){return $(uniq(this.concat($(selector,context))))},is:function(selector){return"string"==typeof selector?this.length>0&&zepto.matches(this[0],selector):selector&&this.selector==selector.selector},not:function(selector){var nodes=[];if(isFunction(selector)&&selector.call!==undefined)this.each(function(idx){selector.call(this,idx)||nodes.push(this)});else{var excludes="string"==typeof selector?this.filter(selector):likeArray(selector)&&isFunction(selector.item)?slice.call(selector):$(selector);this.forEach(function(el){excludes.indexOf(el)<0&&nodes.push(el)})}return $(nodes)},has:function(selector){return this.filter(function(){return isObject(selector)?$.contains(this,selector):$(this).find(selector).size()})},eq:function(idx){return idx===-1?this.slice(idx):this.slice(idx,+idx+1)},first:function(){var el=this[0];return el&&!isObject(el)?el:$(el)},last:function(){var el=this[this.length-1];return el&&!isObject(el)?el:$(el)},find:function(selector){var $this=this;return selector?"object"==typeof selector?$(selector).filter(function(){var node=this;return emptyArray.some.call($this,function(parent){return $.contains(parent,node)})}):1==this.length?$(zepto.qsa(this[0],selector)):this.map(function(){return zepto.qsa(this,selector)}):$()},closest:function(selector,context){var nodes=[],collection="object"==typeof selector&&$(selector);return this.each(function(_,node){for(;node&&!(collection?collection.indexOf(node)>=0:zepto.matches(node,selector));)node=node!==context&&!isDocument(node)&&node.parentNode;node&&nodes.indexOf(node)<0&&nodes.push(node)}),$(nodes)},parents:function(selector){for(var ancestors=[],nodes=this;nodes.length>0;)nodes=$.map(nodes,function(node){if((node=node.parentNode)&&!isDocument(node)&&ancestors.indexOf(node)<0)return ancestors.push(node),node});return filtered(ancestors,selector)},parent:function(selector){return filtered(uniq(this.pluck("parentNode")),selector)},children:function(selector){return filtered(this.map(function(){return children(this)}),selector)},contents:function(){return this.map(function(){return this.contentDocument||slice.call(this.childNodes)})},siblings:function(selector){return filtered(this.map(function(i,el){return filter.call(children(el.parentNode),function(child){return child!==el})}),selector)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(property){return $.map(this,function(el){return el[property]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=defaultDisplay(this.nodeName))})},replaceWith:function(newContent){return this.before(newContent).remove()},wrap:function(structure){var func=isFunction(structure);if(this[0]&&!func)var dom=$(structure).get(0),clone=dom.parentNode||this.length>1;return this.each(function(index){$(this).wrapAll(func?structure.call(this,index):clone?dom.cloneNode(!0):dom)})},wrapAll:function(structure){if(this[0]){$(this[0]).before(structure=$(structure));for(var children;(children=structure.children()).length;)structure=children.first();$(structure).append(this)}return this},wrapInner:function(structure){var func=isFunction(structure);return this.each(function(index){var self=$(this),contents=self.contents(),dom=func?structure.call(this,index):structure;contents.length?contents.wrapAll(dom):self.append(dom)})},unwrap:function(){return this.parent().each(function(){$(this).replaceWith($(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(setting){return this.each(function(){var el=$(this);(setting===undefined?"none"==el.css("display"):setting)?el.show():el.hide()})},prev:function(selector){return $(this.pluck("previousElementSibling")).filter(selector||"*")},next:function(selector){return $(this.pluck("nextElementSibling")).filter(selector||"*")},html:function(html){return 0 in arguments?this.each(function(idx){var originHtml=this.innerHTML;$(this).empty().append(funcArg(this,html,idx,originHtml))}):0 in this?this[0].innerHTML:null},text:function(text){return 0 in arguments?this.each(function(idx){var newText=funcArg(this,text,idx,this.textContent);this.textContent=null==newText?"":""+newText}):0 in this?this.pluck("textContent").join(""):null},attr:function(name,value){var result;return"string"!=typeof name||1 in arguments?this.each(function(idx){if(1===this.nodeType)if(isObject(name))for(key in name)setAttribute(this,key,name[key]);else setAttribute(this,name,funcArg(this,value,idx,this.getAttribute(name)))}):0 in this&&1==this[0].nodeType&&null!=(result=this[0].getAttribute(name))?result:undefined},removeAttr:function(name){return this.each(function(){1===this.nodeType&&name.split(" ").forEach(function(attribute){setAttribute(this,attribute)},this)})},prop:function(name,value){return name=propMap[name]||name,"string"!=typeof name||1 in arguments?this.each(function(idx){if(isObject(name))for(key in name)this[propMap[key]||key]=name[key];else this[name]=funcArg(this,value,idx,this[name])}):this[0]&&this[0][name]},removeProp:function(name){return name=propMap[name]||name,this.each(function(){delete this[name]})},data:function(name,value){var attrName="data-"+name.replace(/([A-Z])/g,"-$1").toLowerCase(),data=1 in arguments?this.attr(attrName,value):this.attr(attrName);return null!==data?deserializeValue(data):undefined},val:function(value){return 0 in arguments?(null==value&&(value=""),this.each(function(idx){this.value=funcArg(this,value,idx,this.value)})):this[0]&&(this[0].multiple?$(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(coordinates){if(coordinates)return this.each(function(index){var $this=$(this),coords=funcArg(this,coordinates,index,$this.offset()),parentOffset=$this.offsetParent().offset(),props={top:coords.top-parentOffset.top,left:coords.left-parentOffset.left};"static"==$this.css("position")&&(props.position="relative"),$this.css(props)});if(!this.length)return null;if(document.documentElement!==this[0]&&!$.contains(document.documentElement,this[0]))return{top:0,left:0};var obj=this[0].getBoundingClientRect();return{left:obj.left+window.pageXOffset,top:obj.top+window.pageYOffset,width:Math.round(obj.width),height:Math.round(obj.height)}},css:function(property,value){if(arguments.length<2){var element=this[0];if("string"==typeof property){if(!element)return;return element.style[camelize(property)]||getComputedStyle(element,"").getPropertyValue(property)}if(isArray(property)){if(!element)return;var props={},computedStyle=getComputedStyle(element,"");return $.each(property,function(_,prop){props[prop]=element.style[camelize(prop)]||computedStyle.getPropertyValue(prop)}),props}}var css="";if("string"==type(property))value||0===value?css=dasherize(property)+":"+maybeAddPx(property,value):this.each(function(){this.style.removeProperty(dasherize(property))});else for(key in property)property[key]||0===property[key]?css+=dasherize(key)+":"+maybeAddPx(key,property[key])+";":this.each(function(){this.style.removeProperty(dasherize(key))});return this.each(function(){this.style.cssText+=";"+css})},index:function(element){return element?this.indexOf($(element)[0]):this.parent().children().indexOf(this[0])},hasClass:function(name){return!!name&&emptyArray.some.call(this,function(el){return this.test(className(el))},classRE(name))},addClass:function(name){return name?this.each(function(idx){if("className"in this){classList=[];var cls=className(this);funcArg(this,name,idx,cls).split(/\s+/g).forEach(function(klass){$(this).hasClass(klass)||classList.push(klass)},this),classList.length&&className(this,cls+(cls?" ":"")+classList.join(" "))}}):this},removeClass:function(name){return this.each(function(idx){if("className"in this){if(name===undefined)return className(this,"");classList=className(this),funcArg(this,name,idx,classList).split(/\s+/g).forEach(function(klass){classList=classList.replace(classRE(klass)," ")}),className(this,classList.trim())}})},toggleClass:function(name,when){return name?this.each(function(idx){var $this=$(this);funcArg(this,name,idx,className(this)).split(/\s+/g).forEach(function(klass){(when===undefined?!$this.hasClass(klass):when)?$this.addClass(klass):$this.removeClass(klass)})}):this},scrollTop:function(value){if(this.length){var hasScrollTop="scrollTop"in this[0];return value===undefined?hasScrollTop?this[0].scrollTop:this[0].pageYOffset:this.each(hasScrollTop?function(){this.scrollTop=value}:function(){this.scrollTo(this.scrollX,value)})}},scrollLeft:function(value){if(this.length){var hasScrollLeft="scrollLeft"in this[0];return value===undefined?hasScrollLeft?this[0].scrollLeft:this[0].pageXOffset:this.each(hasScrollLeft?function(){this.scrollLeft=value}:function(){this.scrollTo(value,this.scrollY)})}},position:function(){if(this.length){var elem=this[0],offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=rootNodeRE.test(offsetParent[0].nodeName)?{top:0,left:0}:offsetParent.offset();return offset.top-=parseFloat($(elem).css("margin-top"))||0,offset.left-=parseFloat($(elem).css("margin-left"))||0,parentOffset.top+=parseFloat($(offsetParent[0]).css("border-top-width"))||0,parentOffset.left+=parseFloat($(offsetParent[0]).css("border-left-width"))||0,{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}}},offsetParent:function(){return this.map(function(){for(var parent=this.offsetParent||document.body;parent&&!rootNodeRE.test(parent.nodeName)&&"static"==$(parent).css("position");)parent=parent.offsetParent;return parent})}},$.fn.detach=$.fn.remove,["width","height"].forEach(function(dimension){var dimensionProperty=dimension.replace(/./,function(m){return m[0].toUpperCase()});$.fn[dimension]=function(value){var offset,el=this[0];return value===undefined?isWindow(el)?el["inner"+dimensionProperty]:isDocument(el)?el.documentElement["scroll"+dimensionProperty]:(offset=this.offset())&&offset[dimension]:this.each(function(idx){el=$(this),el.css(dimension,funcArg(this,value,idx,el[dimension]()))})}}),adjacencyOperators.forEach(function(operator,operatorIndex){var inside=operatorIndex%2;$.fn[operator]=function(){var argType,parent,nodes=$.map(arguments,function(arg){var arr=[];return argType=type(arg),"array"==argType?(arg.forEach(function(el){return el.nodeType!==undefined?arr.push(el):$.zepto.isZ(el)?arr=arr.concat(el.get()):void(arr=arr.concat(zepto.fragment(el)))}),arr):"object"==argType||null==arg?arg:zepto.fragment(arg)}),copyByClone=this.length>1;return nodes.length<1?this:this.each(function(_,target){parent=inside?target:target.parentNode,target=0==operatorIndex?target.nextSibling:1==operatorIndex?target.firstChild:2==operatorIndex?target:null;var parentInDocument=$.contains(document.documentElement,parent);nodes.forEach(function(node){if(copyByClone)node=node.cloneNode(!0);else if(!parent)return $(node).remove();parent.insertBefore(node,target),parentInDocument&&traverseNode(node,function(el){if(!(null==el.nodeName||"SCRIPT"!==el.nodeName.toUpperCase()||el.type&&"text/javascript"!==el.type||el.src)){var target=el.ownerDocument?el.ownerDocument.defaultView:window;target.eval.call(target,el.innerHTML)}})})})},$.fn[inside?operator+"To":"insert"+(operatorIndex?"Before":"After")]=function(html){return $(html)[operator](this),this}}),zepto.Z.prototype=Z.prototype=$.fn,zepto.uniq=uniq,zepto.deserializeValue=deserializeValue,$.zepto=zepto,$}();return window.Zepto=Zepto,window.$crt=Zepto,void 0===window.$&&(window.$=Zepto),function($){function zid(element){return element._zid||(element._zid=_zid++)}function findHandlers(element,event,fn,selector){if(event=parse(event),event.ns)var matcher=matcherFor(event.ns);return(handlers[zid(element)]||[]).filter(function(handler){return handler&&(!event.e||handler.e==event.e)&&(!event.ns||matcher.test(handler.ns))&&(!fn||zid(handler.fn)===zid(fn))&&(!selector||handler.sel==selector)})}function parse(event){var parts=(""+event).split(".");return{e:parts[0],ns:parts.slice(1).sort().join(" ")}}function matcherFor(ns){return new RegExp("(?:^| )"+ns.replace(" "," .* ?")+"(?: |$)")}function eventCapture(handler,captureSetting){return handler.del&&!focusinSupported&&handler.e in focus||!!captureSetting}function realEvent(type){return hover[type]||focusinSupported&&focus[type]||type}function add(element,events,fn,data,selector,delegator,capture){var id=zid(element),set=handlers[id]||(handlers[id]=[]);events.split(/\s/).forEach(function(event){if("ready"==event)return $(document).ready(fn);var handler=parse(event);handler.fn=fn,handler.sel=selector,handler.e in hover&&(fn=function(e){var related=e.relatedTarget;if(!related||related!==this&&!$.contains(this,related))return handler.fn.apply(this,arguments)}),handler.del=delegator;var callback=delegator||fn;handler.proxy=function(e){if(e=compatible(e),!e.isImmediatePropagationStopped()){e.data=data;var result=callback.apply(element,e._args==undefined?[e]:[e].concat(e._args));return result===!1&&(e.preventDefault(),e.stopPropagation()),result}},handler.i=set.length,set.push(handler),"addEventListener"in element&&element.addEventListener(realEvent(handler.e),handler.proxy,eventCapture(handler,capture))})}function remove(element,events,fn,selector,capture){var id=zid(element);(events||"").split(/\s/).forEach(function(event){findHandlers(element,event,fn,selector).forEach(function(handler){delete handlers[id][handler.i],"removeEventListener"in element&&element.removeEventListener(realEvent(handler.e),handler.proxy,eventCapture(handler,capture))})})}function compatible(event,source){if(source||!event.isDefaultPrevented){source||(source=event),$.each(eventMethods,function(name,predicate){var sourceMethod=source[name];event[name]=function(){return this[predicate]=returnTrue,sourceMethod&&sourceMethod.apply(source,arguments)},event[predicate]=returnFalse});try{event.timeStamp||(event.timeStamp=Date.now())}catch(ignored){}(source.defaultPrevented!==undefined?source.defaultPrevented:"returnValue"in source?source.returnValue===!1:source.getPreventDefault&&source.getPreventDefault())&&(event.isDefaultPrevented=returnTrue)}return event}function createProxy(event){var key,proxy={originalEvent:event};for(key in event)ignoreProperties.test(key)||event[key]===undefined||(proxy[key]=event[key]);return compatible(proxy,event)}var undefined,_zid=1,slice=Array.prototype.slice,isFunction=$.isFunction,isString=function(obj){return"string"==typeof obj},handlers={},specialEvents={},focusinSupported="onfocusin"in window,focus={focus:"focusin",blur:"focusout"},hover={mouseenter:"mouseover",mouseleave:"mouseout"};specialEvents.click=specialEvents.mousedown=specialEvents.mouseup=specialEvents.mousemove="MouseEvents",$.event={add:add,remove:remove},$.proxy=function(fn,context){var args=2 in arguments&&slice.call(arguments,2);if(isFunction(fn)){var proxyFn=function(){return fn.apply(context,args?args.concat(slice.call(arguments)):arguments)};return proxyFn._zid=zid(fn),proxyFn}if(isString(context))return args?(args.unshift(fn[context],fn),$.proxy.apply(null,args)):$.proxy(fn[context],fn);throw new TypeError("expected function")},$.fn.bind=function(event,data,callback){return this.on(event,data,callback)},$.fn.unbind=function(event,callback){return this.off(event,callback)},$.fn.one=function(event,selector,data,callback){return this.on(event,selector,data,callback,1)};var returnTrue=function(){return!0},returnFalse=function(){return!1},ignoreProperties=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,eventMethods={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};$.fn.delegate=function(selector,event,callback){return this.on(event,selector,callback)},$.fn.undelegate=function(selector,event,callback){return this.off(event,selector,callback)},$.fn.live=function(event,callback){return $(document.body).delegate(this.selector,event,callback),this},$.fn.die=function(event,callback){return $(document.body).undelegate(this.selector,event,callback),this},$.fn.on=function(event,selector,data,callback,one){var autoRemove,delegator,$this=this;return event&&!isString(event)?($.each(event,function(type,fn){$this.on(type,selector,data,fn,one)}),$this):(isString(selector)||isFunction(callback)||callback===!1||(callback=data,data=selector,selector=undefined),callback!==undefined&&data!==!1||(callback=data,data=undefined),callback===!1&&(callback=returnFalse),$this.each(function(_,element){one&&(autoRemove=function(e){return remove(element,e.type,callback),callback.apply(this,arguments)}),selector&&(delegator=function(e){var evt,match=$(e.target).closest(selector,element).get(0);if(match&&match!==element)return evt=$.extend(createProxy(e),{currentTarget:match,liveFired:element}),(autoRemove||callback).apply(match,[evt].concat(slice.call(arguments,1)))}),add(element,event,callback,data,selector,delegator||autoRemove)}))},$.fn.off=function(event,selector,callback){var $this=this;return event&&!isString(event)?($.each(event,function(type,fn){$this.off(type,selector,fn)}),$this):(isString(selector)||isFunction(callback)||callback===!1||(callback=selector,selector=undefined),callback===!1&&(callback=returnFalse),$this.each(function(){remove(this,event,callback,selector)}))},$.fn.trigger=function(event,args){return event=isString(event)||$.isPlainObject(event)?$.Event(event):compatible(event),event._args=args,this.each(function(){event.type in focus&&"function"==typeof this[event.type]?this[event.type]():"dispatchEvent"in this?this.dispatchEvent(event):$(this).triggerHandler(event,args)})},$.fn.triggerHandler=function(event,args){var e,result;return this.each(function(i,element){e=createProxy(isString(event)?$.Event(event):event),e._args=args,e.target=element,$.each(findHandlers(element,event.type||event),function(i,handler){if(result=handler.proxy(e),e.isImmediatePropagationStopped())return!1})}),result},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(event){$.fn[event]=function(callback){return 0 in arguments?this.bind(event,callback):this.trigger(event)}}),$.Event=function(type,props){isString(type)||(props=type,type=props.type);var event=document.createEvent(specialEvents[type]||"Events"),bubbles=!0;if(props)for(var name in props)"bubbles"==name?bubbles=!!props[name]:event[name]=props[name];return event.initEvent(type,bubbles,!0),compatible(event)}}(Zepto),function(){try{getComputedStyle(void 0)}catch(e){var nativeGetComputedStyle=getComputedStyle;window.getComputedStyle=function(element,pseudoElement){try{return nativeGetComputedStyle(element,pseudoElement)}catch(e){return null}}}}(),function($,undefined){function dasherize(str){return str.replace(/([A-Z])/g,"-$1").toLowerCase()}function normalizeEvent(name){return eventPrefix?eventPrefix+name:name.toLowerCase()}var eventPrefix,transform,transitionProperty,transitionDuration,transitionTiming,transitionDelay,animationName,animationDuration,animationTiming,animationDelay,prefix="",vendors={Webkit:"webkit",Moz:"",O:"o"},testEl=document.createElement("div"),supportedTransforms=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,cssReset={};void 0===testEl.style.transform&&$.each(vendors,function(vendor,event){if(void 0!==testEl.style[vendor+"TransitionProperty"])return prefix="-"+vendor.toLowerCase()+"-",eventPrefix=event,!1}),transform=prefix+"transform",cssReset[transitionProperty=prefix+"transition-property"]=cssReset[transitionDuration=prefix+"transition-duration"]=cssReset[transitionDelay=prefix+"transition-delay"]=cssReset[transitionTiming=prefix+"transition-timing-function"]=cssReset[animationName=prefix+"animation-name"]=cssReset[animationDuration=prefix+"animation-duration"]=cssReset[animationDelay=prefix+"animation-delay"]=cssReset[animationTiming=prefix+"animation-timing-function"]="",$.fx={off:void 0===eventPrefix&&void 0===testEl.style.transitionProperty,speeds:{_default:400,fast:200,slow:600},cssPrefix:prefix,transitionEnd:normalizeEvent("TransitionEnd"),animationEnd:normalizeEvent("AnimationEnd")},$.fn.animate=function(properties,duration,ease,callback,delay){return $.isFunction(duration)&&(callback=duration,ease=void 0,duration=void 0),$.isFunction(ease)&&(callback=ease,ease=void 0),$.isPlainObject(duration)&&(ease=duration.easing,callback=duration.complete,delay=duration.delay,duration=duration.duration),duration&&(duration=("number"==typeof duration?duration:$.fx.speeds[duration]||$.fx.speeds._default)/1e3),delay&&(delay=parseFloat(delay)/1e3),this.anim(properties,duration,ease,callback,delay)},$.fn.anim=function(properties,duration,ease,callback,delay){var key,cssProperties,wrappedCallback,cssValues={},transforms="",that=this,endEvent=$.fx.transitionEnd,fired=!1;if(void 0===duration&&(duration=$.fx.speeds._default/1e3),void 0===delay&&(delay=0),$.fx.off&&(duration=0),"string"==typeof properties)cssValues[animationName]=properties,cssValues[animationDuration]=duration+"s",cssValues[animationDelay]=delay+"s",cssValues[animationTiming]=ease||"linear",endEvent=$.fx.animationEnd;else{cssProperties=[]
;for(key in properties)supportedTransforms.test(key)?transforms+=key+"("+properties[key]+") ":(cssValues[key]=properties[key],cssProperties.push(dasherize(key)));transforms&&(cssValues[transform]=transforms,cssProperties.push(transform)),duration>0&&"object"==typeof properties&&(cssValues[transitionProperty]=cssProperties.join(", "),cssValues[transitionDuration]=duration+"s",cssValues[transitionDelay]=delay+"s",cssValues[transitionTiming]=ease||"linear")}return wrappedCallback=function(event){if(void 0!==event){if(event.target!==event.currentTarget)return;$(event.target).unbind(endEvent,wrappedCallback)}else $(this).unbind(endEvent,wrappedCallback);fired=!0,$(this).css(cssReset),callback&&callback.call(this)},duration>0&&(this.bind(endEvent,wrappedCallback),setTimeout(function(){fired||wrappedCallback.call(that)},1e3*(duration+delay)+25)),this.size()&&this.get(0).clientLeft,this.css(cssValues),duration<=0&&setTimeout(function(){that.each(function(){wrappedCallback.call(this)})},0),this},testEl=null}(Zepto),function($,undefined){function anim(el,speed,opacity,scale,callback){"function"!=typeof speed||callback||(callback=speed,speed=undefined);var props={opacity:opacity};return scale&&(props.scale=scale,el.css($.fx.cssPrefix+"transform-origin","0 0")),el.animate(props,speed,null,callback)}function hide(el,speed,scale,callback){return anim(el,speed,0,scale,function(){origHide.call($(this)),callback&&callback.call(this)})}var origShow=(window.document,$.fn.show),origHide=$.fn.hide,origToggle=$.fn.toggle;$.fn.show=function(speed,callback){return origShow.call(this),speed===undefined?speed=0:this.css("opacity",0),anim(this,speed,1,"1,1",callback)},$.fn.hide=function(speed,callback){return speed===undefined?origHide.call(this):hide(this,speed,"0,0",callback)},$.fn.toggle=function(speed,callback){return speed===undefined||"boolean"==typeof speed?origToggle.call(this,speed):this.each(function(){var el=$(this);el["none"==el.css("display")?"show":"hide"](speed,callback)})},$.fn.fadeTo=function(speed,opacity,callback){return anim(this,speed,opacity,null,callback)},$.fn.fadeIn=function(speed,callback){var target=this.css("opacity");return target>0?this.css("opacity",0):target=1,origShow.call(this).fadeTo(speed,target,callback)},$.fn.fadeOut=function(speed,callback){return hide(this,speed,null,callback)},$.fn.fadeToggle=function(speed,callback){return this.each(function(){var el=$(this);el[0==el.css("opacity")||"none"==el.css("display")?"fadeIn":"fadeOut"](speed,callback)})}}(Zepto),function($){function getData(node,name){var id=node[exp],store=id&&data[id];if(void 0===name)return store||setData(node);if(store){if(name in store)return store[name];var camelName=camelize(name);if(camelName in store)return store[camelName]}return dataAttr.call($(node),name)}function setData(node,name,value){var id=node[exp]||(node[exp]=++$.uuid),store=data[id]||(data[id]=attributeData(node));return void 0!==name&&(store[camelize(name)]=value),store}function attributeData(node){var store={};return $.each(node.attributes||emptyArray,function(i,attr){0==attr.name.indexOf("data-")&&(store[camelize(attr.name.replace("data-",""))]=$.zepto.deserializeValue(attr.value))}),store}var data={},dataAttr=$.fn.data,camelize=$.camelCase,exp=$.expando="Zepto"+ +new Date,emptyArray=[];$.fn.data=function(name,value){return void 0===value?$.isPlainObject(name)?this.each(function(i,node){$.each(name,function(key,value){setData(node,key,value)})}):0 in this?getData(this[0],name):void 0:this.each(function(){setData(this,name,value)})},$.data=function(elem,name,value){return $(elem).data(name,value)},$.hasData=function(elem){var id=elem[exp],store=id&&data[id];return!!store&&!$.isEmptyObject(store)},$.fn.removeData=function(names){return"string"==typeof names&&(names=names.split(/\s+/)),this.each(function(){var id=this[exp],store=id&&data[id];store&&$.each(names||store,function(key){delete store[names?camelize(this):key]})})},["remove","empty"].forEach(function(methodName){var origFn=$.fn[methodName];$.fn[methodName]=function(){var elements=this.find("*");return"remove"===methodName&&(elements=elements.add(this)),elements.removeData(),origFn.call(this)}})}(Zepto),Zepto}),function(root,factory){"function"==typeof define&&define.amd?define("curator",factory):"object"==typeof exports?module.exports=factory(require("jquery")):root.Curator=factory(root.jQuery||root.Zepto)}(this,function($local){return void 0==$local?(window.alert("jQuery not found\n\nThe Curator Widget is running in dependency mode - this requires jQuery of Zepto. Try disabling DEPENDENCY MODE in the Admin on the Publish page."),!1):function(){"use strict";function nanoajax(params,callback){function cb(statusCode,responseText){return function(){called||(callback(void 0===req.status?statusCode:req.status,0===req.status?"Error":req.response||req.responseText||responseText,req),called=!0)}}var headers=params.headers||{},body=params.body,method=params.method||(body?"POST":"GET"),called=!1,req=getRequest(params.cors);req.open(method,params.url,!0);var success=req.onload=cb(200);req.onreadystatechange=function(){4===req.readyState&&success()},req.onerror=cb(null,"Error"),req.ontimeout=cb(null,"Timeout"),req.onabort=cb(null,"Abort"),body&&(setDefault(headers,"X-Requested-With","XMLHttpRequest"),global.FormData&&body instanceof global.FormData||setDefault(headers,"Content-Type","application/x-www-form-urlencoded"));for(var i=0,len=reqfields.length,field=void 0;i<len;i++)field=reqfields[i],void 0!==params[field]&&(req[field]=params[field]);for(var field$1 in headers)req.setRequestHeader(field$1,headers[field$1]);return req.send(body),req}function getRequest(cors){return cors&&window.XDomainRequest&&!/MSIE 1/.test(window.navigator.userAgent)?new window.XDomainRequest:window.XMLHttpRequest?new window.XMLHttpRequest:void 0}function setDefault(obj,key,value){obj[key]=obj[key]||value}var reqfields=["responseType","withCredentials","timeout","onprogress"],arrayFill=function(array,value,start,end){if(!Array.isArray(array))throw new TypeError("array is not a Array");var length=array.length;start=parseInt(start,10)||0,end=void 0===end?length:parseInt(end,10)||0;var i,l;for(i=start<0?Math.max(length+start,0):Math.min(start,length),l=end<0?Math.max(length+end,0):Math.min(end,length);i<l;i++)array[i]=value;return array};if(Array.prototype.fill||(Array.prototype.fill=function(value,start,end){return arrayFill(this,value,start,end)}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function keys(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;i<ii;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}!function(){function regexSupplant(regex,flags){return flags=flags||"","string"!=typeof regex&&(regex.global&&flags.indexOf("g")<0&&(flags+="g"),regex.ignoreCase&&flags.indexOf("i")<0&&(flags+="i"),regex.multiline&&flags.indexOf("m")<0&&(flags+="m"),regex=regex.source),new RegExp(regex.replace(/#\{(\w+)\}/g,function(match,name){var newRegex=twttr.txt.regexen[name]||"";return"string"!=typeof newRegex&&(newRegex=newRegex.source),newRegex}),flags)}function stringSupplant(str,values){return str.replace(/#\{(\w+)\}/g,function(match,name){return values[name]||""})}function addCharsToCharClass(charClass,start,end){var s=String.fromCharCode(start);return end!==start&&(s+="-"+String.fromCharCode(end)),charClass.push(s),charClass}var twttr={};twttr.txt={},twttr.txt.regexen={};var HTML_ENTITIES={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};twttr.txt.htmlEscape=function(text){return text&&text.replace(/[&"'><]/g,function(character){return HTML_ENTITIES[character]})},twttr.txt.regexSupplant=regexSupplant,twttr.txt.stringSupplant=stringSupplant,twttr.txt.addCharsToCharClass=addCharsToCharClass;var unicodeLettersAndMarks=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B2\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uAB65\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E4-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2D/.source,unicodeNumbers=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,hashtagSpecialChars=/_\u200c\u200d\ua67e\u05be\u05f3\u05f4\uff5e\u301c\u309b\u309c\u30a0\u30fb\u3003\u0f0b\u0f0c\u00b7/.source,hashTagSpecialChars2=/\.-/.source;twttr.txt.regexen.hashSigns=/[#＃]/,twttr.txt.regexen.hashtagAlpha=new RegExp("["+unicodeLettersAndMarks+"]"),twttr.txt.regexen.hashtagAlphaNumeric=new RegExp("["+unicodeLettersAndMarks+unicodeNumbers+hashtagSpecialChars+hashTagSpecialChars2+"]"),twttr.txt.regexen.endHashtagMatch=regexSupplant(/^(?:#{hashSigns}|:\/\/)/),twttr.txt.regexen.hashtagBoundary=new RegExp("(?:^|$|[^&"+unicodeLettersAndMarks+unicodeNumbers+hashtagSpecialChars+"])"),twttr.txt.regexen.validHashtag=regexSupplant(/[#]+(#{hashtagAlphaNumeric}*)/gi),window.twttr=twttr}();var EventBus=function(){this.listeners={}};EventBus.prototype.on=function(type,callback,scope){for(var arguments$1=arguments,args=[],numOfArgs=arguments.length,i=0;i<numOfArgs;i++)args.push(arguments$1[i]);args=args.length>3?args.splice(3,args.length-1):[],void 0!==this.listeners[type]?this.listeners[type].push({scope:scope,callback:callback,args:args}):this.listeners[type]=[{scope:scope,callback:callback,args:args}]},EventBus.prototype.off=function(type,callback,scope){var this$1=this;if(void 0!==this.listeners[type]){for(var numOfCallbacks=this.listeners[type].length,newArray=[],i=0;i<numOfCallbacks;i++){var listener=this$1.listeners[type][i];listener.scope===scope&&listener.callback===callback||newArray.push(listener)}this.listeners[type]=newArray}},EventBus.prototype.has=function(type,callback,scope){var this$1=this;if(void 0!==this.listeners[type]){var numOfCallbacks=this.listeners[type].length;if(void 0===callback&&void 0===scope)return numOfCallbacks>0;for(var i=0;i<numOfCallbacks;i++){var listener=this$1.listeners[type][i];if((!scope||listener.scope===scope)&&listener.callback===callback)return!0}}return!1},EventBus.prototype.trigger=function(type){for(var arguments$1=arguments,this$1=this,event={type:type},args=[],i=1;i<arguments.length;i++)args.push(arguments$1[i]);if(args=[event].concat(args),void 0!==this.listeners[type])for(var numOfCallbacks=this.listeners[type].length,i$1=0;i$1<numOfCallbacks;i$1++){var listener=this$1.listeners[type][i$1];if(listener&&listener.callback){var concatArgs=args.concat(listener.args);listener.callback.apply(listener.scope,concatArgs)}}},EventBus.prototype.getEvents=function(){var this$1=this,str="";for(var type in this$1.listeners)for(var numOfCallbacks=this$1.listeners[type].length,i=0;i<numOfCallbacks;i++){var listener=this$1.listeners[type][i];str+=listener.scope&&listener.scope.className?listener.scope.className:"anonymous",str+=" listen for '"+type+"'\n"}return str},EventBus.prototype.destroy=function(){this.listeners={}};for(var Globals={POST_CLICK_ACTION_OPEN_POPUP:"open-popup",POST_CLICK_ACTION_GOTO_SOURCE:"goto-source",POST_CLICK_ACTION_NOTHING:"nothing"},CommonUtils={postUrl:function(post){return post.url&&""!==post.url&&"''"!==post.url?post.url:post.network_id+""=="1"?"https://twitter.com/"+post.user_screen_name+"/status/"+post.source_identifier:""},center:function(w,h,bound){var s=window.screen,b=bound||{},bH=b.height||s.height,bW=b.width||s.height;return{top:bH?(bH-h)/2:0,left:bW?(bW-w)/2:0}},popup:function(mypage,myname,w,h,scroll){var position=this.center(w,h),settings="height="+h+",width="+w+",top="+position.top+",left="+position.left+",scrollbars="+scroll+",resizable";window.open(mypage,myname,settings)},tinyparser:function(string,obj){return string.replace(/\{\{(.*?)\}\}/g,function(a,b){return obj&&void 0!==obj[b]?encodeURIComponent(obj[b]):""})},debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)},callNow=immediate&&!timeout;window.clearTimeout(timeout),timeout=window.setTimeout(later,wait),callNow&&func.apply(context,args)}},uId:function(){return"_"+Math.random().toString(36).substr(2,9)}},StringUtils={camelize:function(s){return s.replace(/(?:^|[-_])(\w)/g,function(_,c){return c?c.toUpperCase():""})},twitterLinks:function(s){return s=s.replace(/[@]+[A-Za-z0-9-_]+/g,function(u){var username=u.replace("@","");return StringUtils.url("https://twitter.com/"+username,u)}),s=s.replace(twttr.txt.regexen.validHashtag,function(t){var tag=t.replace("#","%23");return StringUtils.url("https://twitter.com/search?q="+tag,t)})},instagramLinks:function(s){return s=s.replace(/[@]+[A-Za-z0-9-_\.]+/g,function(u){var username=u.replace("@","");return StringUtils.url("https://www.instagram.com/"+username+"/",u)}),s=s.replace(twttr.txt.regexen.validHashtag,function(t){var tag=t.replace("#","");return StringUtils.url("https://www.instagram.com/explore/tags/"+tag+"/",t)})},facebookLinks:function(s){return s=s.replace(/[@]+[A-Za-z0-9-_]+/g,function(u){var username=u.replace("@","");return StringUtils.url("https://www.facebook.com/"+username+"/",u)}),s=s.replace(/[#]+[A-Za-z0-9-_]+/g,function(t){var tag=t.replace("#","%23");return StringUtils.url("https://www.facebook.com/search/top/?q="+tag,t)})},linksToHref:function(s){return s=s.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&~\?\/.=]+[A-Za-z0-9-_:%&~\?\/=]+/g,function(url){return StringUtils.url(url)})},url:function(s,t){return t=t||s,'<a href="'+s+'" target="_blank">'+t+"</a>"},youtubeVideoId:function(url){var match=url.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);if(match&&11===match[7].length)return match[7];var match2=url.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/))([^#\&\?]*).*/);return!(!match2||11!==match2[6].length)&&match2[6]},vimeoVideoId:function(url){var match=url.match(/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?/);return!!(match&&match.length>=2)&&match[1]},filterHtml:function(html){try{var div=document.createElement("div");div.innerHTML=html;return div.textContent||div.innerText||""}catch(e){return html}},nl2br:function(s){return s=s.trim(),s=s.replace(/(?:\r\n|\r|\n)/g,"<br />")}},SocialFacebook={share:function(post){var obj=post;obj.url=CommonUtils.postUrl(post),obj.cleanText=StringUtils.filterHtml(post.text),0!==obj.url.indexOf("http")&&(obj.url=obj.image);var url2=CommonUtils.tinyparser("https://www.facebook.com/sharer/sharer.php?u={{url}}&d={{cleanText}}",obj);CommonUtils.popup(url2,"twitter","600","430","0")}},SocialTwitter={share:function(post){var obj=post;obj.url=CommonUtils.postUrl(post),obj.cleanText=StringUtils.filterHtml(post.text);var url2=CommonUtils.tinyparser("http://twitter.com/share?url={{url}}&text={{cleanText}}&hashtags={{hashtags}}",obj);CommonUtils.popup(url2,"twitter","600","430","0")}},Logger={debug:!1,log:function(s){window.console&&Logger.debug&&window.console.log(s)}},Events={FEED_LOADED:"feed:loaded",FEED_FAILED:"feed:failed",FILTER_CHANGED:"filter:changed",POSTS_LOADED:"posts:loaded",POSTS_FAILED:"posts:failed",POSTS_RENDERED:"posts:rendered",POST_CREATED:"post:created",POST_CLICK:"post:click",POST_CLICK_READ_MORE:"post:clickReadMore",POST_IMAGE_LOADED:"post:imageLoaded",POST_IMAGE_FAILED:"post:imageFailed",CAROUSEL_CHANGED:"carousel:changed"},Templates={filter:'<div class="crt-filter"> \n<div class="crt-filter-networks">\n<ul class="crt-networks"> \n    <li class="crt-filter-label"><label><%=this._t(\'filter\')%>:</label></li>\n    <li class="active"><a href="#" data-network="0"> <%=this._t(\'all\')%></a></li>\n</ul>\n</div> \n<div class="crt-filter-sources">\n<ul class="crt-sources"> \n    <li class="crt-filter-label"><label><%=this._t(\'filter\')%>:</label></li>\n    <li class="active"><a href="#" data-source="0"> <%=this._t(\'all\')%></a></li>\n</ul>\n</div> \n</div>',popup:' \n<div class="crt-popup"> \n    <a href="#" class="crt-close crt-icon-cancel"></a> \n    <a href="#" class="crt-next crt-icon-right-open"></a> \n    <a href="#" class="crt-previous crt-icon-left-open"></a> \n    <div class="crt-popup-left">  \n        <div class="crt-video"> \n            <div class="crt-video-container">\n                <video preload="none">\n                <source src="<%=video%>" type="video/mp4">\n                </video>\n                <img src="<%=image%>" alt="Image posted by <%=user_screen_name%> to <%=this.networkName()%>" />\n                <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a> \n            </div> \n        </div> \n        <div class="crt-image"> \n            <img src="<%=image%>" alt="Image posted by <%=user_screen_name%> to <%=this.networkName()%>" /> \n        </div> \n        <div class="crt-pagination"><ul></ul></div>\n    </div> \n    <div class="crt-popup-right"> \n        <div class="crt-popup-header"> \n            <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span> \n            <img src="<%=user_image%>" alt="Profile image for <%=user_full_name%>"  /> \n            <div class="crt-post-name"><span><%=user_full_name%></span><br/><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div> \n        </div> \n        <div class="crt-popup-text <%=this.contentTextClasses()%>"> \n            <div class="crt-popup-text-container"> \n                <p class="crt-date"><%=this.prettyDate(source_created_at)%></p> \n                <a class="crt-link" href="<%= this.networkIcon() == "facebook" ? url :"" %>" target="_blank"><%= this.networkIcon() == "facebook" ? "Go to post" :"" %></a>\n                <div class="crt-popup-text-body"><%=this.parseText(text)%></div> \n            </div> \n        </div> \n        <div class="crt-popup-read-more">\n            <a href="#" class="crt-post-read-more-button"><%=this._t("read-more")%></a> \n        </div>\n        <div class="crt-popup-footer">\n            <div class="crt-popup-stats"><span><%=likes%></span> <%=this._t("likes", likes)%> <i class="sep"></i> <span><%=comments%></span> <%=this._t("comments", comments)%></div> \n            <div class="crt-post-share"><span class="ctr-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>\n        </div> \n    </div> \n</div>',"popup-underlay":"","popup-wrapper":' <div class="crt-popup-wrapper">     <div class="crt-popup-wrapper-c">         <div class="crt-popup-underlay"></div>         <div class="crt-popup-container"></div>     </div> </div>',"post-v1":' <div class="crt-post-v1 crt-post-c">    <div class="crt-post-bg"></div>     <div class="crt-post post<%=id%> crt-post-<%=this.networkIcon()%>">         <div class="crt-post-header">             <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>             <img src="<%=user_image%>" alt="Profile image for <%=user_full_name%>"  />             <div class="crt-post-name">            <div class="crt-post-fullname"><%=user_full_name%></div>            <div class="crt-post-username"><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div>            </div>         </div>         <div class="crt-post-content">             <div class="crt-image crt-hitarea crt-post-content-image <%=this.contentImageClasses()%>" >                 <div class="crt-image-c"><img src="<%=image%>" class="crt-post-image" alt="Image posted by <%=user_screen_name%> to <%=this.networkName()%>" /></div>                 <span class="crt-play"><i class="crt-play-icon"></i></span>             </div>             <div class="text crt-post-content-text <%=this.contentTextClasses()%>">                 <div class="crt-post-text-body"><%=this.parseText(text)%></div>             </div>         </div>         <div class="crt-post-footer">            <div class="crt-date"><%=this.prettyDate(source_created_at)%></div>             <div class="crt-post-share"><span class="crt-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>        </div>         <div class="crt-post-read-more"><a href="#" class="crt-post-read-more-button">Read more</a> </div>     </div></div>',"grid-post-v1":' <div class="crt-post-c">    <div class="crt-post post<%=id%> <%=this.contentImageClasses()%> <%=this.contentTextClasses()%>">         <div class="crt-post-content">             <div class="crt-hitarea" >                 <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class="spacer" alt="Image posted by <%=user_screen_name%> to <%=this.networkName()%>" />                 <div class="crt-post-content-image" style="background-image: url(<%=image%>);"> </div>                 <div class="crt-post-content-text-c">                     <div class="crt-post-content-text">                         <%=this.parseText(text)%>                     </div>                 </div>                 <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a>                 <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                 <div class="crt-post-hover">                    <div class="crt-post-header">                         <img src="<%=user_image%>" alt="Profile image for <%=user_full_name%>"  />                         <div class="crt-post-name"><span><%=user_full_name%></span><br/><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div>                     </div>                     <div class="crt-post-hover-text">                         <%=this.parseText(text)%>                     </div>                     <span class="crt-social-icon crt-social-icon-hover"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                 </div>             </div>         </div>     </div></div>',"post-v2":' \n<div class="crt-post-v2 crt-post crt-post-<%=this.networkIcon()%> <%=this.contentTextClasses()%>  <%=this.contentImageClasses()%>" data-post="<%=id%>"> \n    <div class="crt-post-border">\n        <div class="crt-post-c">\n            <div class="crt-post-content">\n                <div class="crt-image crt-hitarea crt-post-content-image" > \n                    <div class="crt-image-c"><img src="<%=image%>" class="crt-post-image" alt="Image posted by <%=user_screen_name%> to <%=this.networkName()%>" /></div>   \n                    <span class="crt-play"><i class="crt-play-icon"></i></span> \n                    <div class="crt-image-carousel"><i class="crt-icon-image-carousel"></i></div> \n                </div> \n                <div class="crt-post-header"> \n                    <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span> \n                    <div class="crt-post-fullname"><a href="<%=this.userUrl()%>" target="_blank"><%=user_full_name%></a></div>\n                </div> \n                <div class="text crt-post-content-text"> \n                    <%=this.parseText(text)%> \n                </div> \n            </div> \n            <div class="crt-post-footer"> \n                <img class="crt-post-userimage" src="<%=user_image%>" alt="Profile image for <%=user_screen_name%>" /> \n                <span class="crt-post-username"><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></span>\n                <span class="crt-date"><%=this.prettyDate(source_created_at)%></span> \n                <div class="crt-post-share"><span class="crt-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>\n            </div> \n            <div class="crt-post-max-height-read-more"><a href="#" class="crt-post-read-more-button"><%=this._t("read-more")%></a></div> \n        </div> \n    </div> \n</div>',
"grid-post-v2":'\n<div class="crt-grid-post crt-grid-post-v2 crt-post-<%=id%> <%=this.contentImageClasses()%> <%=this.contentTextClasses()%>" data-post="<%=id%>">     <div class="crt-post-c"> \n        <div class="crt-post-content"> \n            <div class="crt-hitarea" > \n                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class="crt-spacer" alt="Image posted by <%=user_screen_name%> to <%=this.networkName()%>" /> \n                <div class="crt-grid-post-image">\n                    <div class="crt-post-content-image" style="background-image: url(<%=image%>);"> </div> \n                    <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a> \n                    <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span> \n                    <div class="crt-image-carousel"><i class="crt-icon-image-carousel"></i></div> \n                </div>\n                <div class="crt-grid-post-text">\n                    <div class="crt-grid-post-text-wrap"> \n                        <div><%=this.parseText(text)%></div> \n                    </div> \n                    <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span> \n                </div>\n                <div class="crt-post-hover">\n                    <div>\n                        <div class="crt-post-header"> \n                            <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span> \n                            <div class="crt-post-fullname"><a href="<%=this.userUrl()%>" target="_blank"><%=user_full_name%></a></div>\n                        </div> \n                        <div class="crt-post-content-text"> \n                            <%=this.parseText(text)%> \n                        </div> \n                        <div class="crt-post-read-more"><a href="#" class="crt-post-read-more-button"><%=this._t("read-more")%></a></div> \n                        <div class="crt-post-footer">\n                            <img class="crt-post-userimage" src="<%=user_image%>" alt="Profile image for <%=user_full_name%>" /> \n                            <span class="crt-post-username"><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></span>\n                            <span class="crt-date"><%=this.prettyDate(source_created_at)%></span> \n                            <div class="crt-post-share"><span class="crt-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>\n                        </div> \n                    </div>\n                </div> \n            </div> \n        </div> \n    </div>\n</div>',"grid-post-minimal":'\n<div class="crt-grid-post crt-grid-post-minimal crt-grid-post-v2 crt-post-<%=id%> <%=this.contentImageClasses()%> <%=this.contentTextClasses()%>" data-post="<%=id%>">     <div class="crt-post-c"> \n        <div class="crt-post-content"> \n            <div class="crt-hitarea" > \n                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class="crt-spacer" alt="Image posted by <%=user_screen_name%> to <%=this.networkName()%>" /> \n                <div class="crt-grid-post-image">\n                    <div class="crt-post-content-image" style="background-image: url(<%=image%>);"> </div> \n                    <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a> \n                    <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span> \n                    <div class="crt-image-carousel"><i class="crt-icon-image-carousel"></i></div> \n                </div>\n                <div class="crt-grid-post-text">\n                    <div class="crt-grid-post-text-wrap"> \n                        <div><%=this.parseText(text)%></div> \n                    </div> \n                    <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span> \n                </div>\n                <div class="crt-post-hover">\n                    <div>\n                        <div class="crt-post-header">\n                            <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>  \n                        </div> \n                        <div class="crt-post-minimal-stats"> \n                            <span class="crt-likes"><i class="crt-icon-heart"></i>&nbsp;<%=likes%></span>\n                            <span class="crt-comments"><i class="crt-icon-comment"></i>&nbsp;<%=comments%></span>\n                        </div> \n                    </div> \n                </div> \n            </div> \n        </div> \n    </div>\n</div>',"grid-feed-v2":' <div class="crt-feed-window">    <div class="crt-feed"></div></div><div class="crt-feed-more"><a href="#">Load more</a></div>',"list-feed":'\n<div class="crt-feed-window">\n    <div class="crt-feed"></div>\n</div>\n<div class="crt-feed-more"><a href="#">Load more</a></div>',"list-post":'\n<div class="crt-list-post crt-post-<%=id%> <%=this.contentImageClasses()%> <%=this.contentTextClasses()%>" data-post="<%=id%>">     <div class="crt-post-c"> \n        <div class="crt-post-content"> \n            <div class="crt-list-post-image">\n                <div>\n                <img class="crt-post-content-image" src="<%=image%>" alt="Image posted by <%=user_screen_name%> to <%=this.networkName()%>" /> \n                <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a> \n                <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span> \n                <span class="crt-image-carousel"><i class="crt-icon-image-carousel"></i></span>\n                </div> \n            </div>\n            <div class="crt-list-post-text">\n                <div class="crt-post-header"> \n                    <div class="crt-post-fullname"><%=id%> - <a href="<%=this.userUrl()%>" target="_blank"><%=user_full_name%></a></div>\n                </div> \n                <div class="crt-list-post-text-wrap"> \n                    <div><%=this.parseText(text)%></div> \n                </div> \n                <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>\n                 <div class="crt-post-footer">\n                    <img class="crt-post-userimage" src="<%=user_image%>" alt="Profile image for <%=user_full_name%>"/> \n                    <span class="crt-post-username"><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></span>\n                    <span class="crt-date"><%=this.prettyDate(source_created_at)%></span> \n                    <div class="crt-post-share"><span class="crt-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>\n                </div>  \n            </div>\n        </div> \n    </div>\n</div>'},isNumeric=function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},isObject=function(obj){return"object"==typeof obj&&null!==obj},isString=function(obj){return"[object String]"===Object.prototype.toString.call(obj)},libTranslate={getTranslationFunction:function(messageObject,options){function getTranslationValue(translationKey){if(messageObject[translationKey])return messageObject[translationKey];var components=translationKey.split(namespaceSplitter),namespace=components[0],key=components[1];return messageObject[namespace]&&messageObject[namespace][key]?messageObject[namespace][key]:null}function getPluralValue(translation,count){if(isObject(translation)){var upperCap,keys=Object.keys(translation);if(0===keys.length)return debug&&window.console.log("[Translation] No plural forms found."),null;for(var i=0;i<keys.length;i++)0===keys[i].indexOf("gt")&&(upperCap=parseInt(keys[i].replace("gt",""),10));translation[count]?translation=translation[count]:count>upperCap?translation=translation["gt"+upperCap]:translation.n?translation=translation.n:(debug&&window.console.log('[Translation] No plural forms found for count:"'+count+'" in',translation),translation=translation[Object.keys(translation).reverse()[0]])}return translation}function replacePlaceholders(translation,replacements){return isString(translation)?translation.replace(/\{(\w*)\}/g,function(match,key){return replacements.hasOwnProperty(key)?replacements.hasOwnProperty(key)?replacements[key]:key:(debug&&window.console.log('Could not find replacement "'+key+'" in provided replacements object:',replacements),"{"+key+"}")}):translation}options=isObject(options)?options:{};var debug=options.debug,namespaceSplitter=options.namespaceSplitter||"::";return function(translationKey){var replacements=isObject(arguments[1])?arguments[1]:isObject(arguments[2])?arguments[2]:{},count=isNumeric(arguments[1])?arguments[1]:isNumeric(arguments[2])?arguments[2]:null,translation=getTranslationValue(translationKey);return null!==count&&(replacements.n=replacements.n?replacements.n:count,translation=getPluralValue(translation,count)),translation=replacePlaceholders(translation,replacements),null===translation&&(translation=debug?"@@"+translationKey+"@@":translationKey,debug&&window.console.log('Translation for "'+translationKey+'" not found.')),translation}}},langsData="\nid,en,de,it,nl,es,fr,po,ru\nload-more,Load more,Mehr anzeigen,Di più,Laad meer,Cargar más,Voir plus,Carregar Mais,Загрузить больше\nminutes-ago.1,{n} minute ago,Vor einer Minute,Un minuto fa,{n} minuut geleden,Hace un minuto,Il y a {n} minute,Tem um minuto,Одну минуту назад\nminutes-ago.n,{n} minutes ago,Vor {n} Minuten,{n} minuti fa,{n} minuten geleden,Hace {n} minutos,Il y a {n} minutes,Tem {n} minutos,{n} минут назад\nhours-ago.1,{n} hour ago,Vor einer Stunde,Un'ora fa,{n} uur geleden,Hace una hora,Il y a {n} heure,Tem {n} hora,Один час назад\nhours-ago.n,{n} hours ago,Vor {n} Stunden,{n} ore fa,{n} uren geleden,Hace {n} horas,Il y a {n} heures,Tem {n} horas,{n} часов назад\ndays-ago.1,{n} day ago,Vor einem Tag,Un giorno fa,{n} dag geleden,Hace un día,Il y a {n} jour,Faz um dia,Один день назад\ndays-ago.n,{n} days ago,Vor {n} Tagen,{n} giorni fa,{n} dagen geleden,Hace {n} días,Il y a {n} jours,Fazem {n} dias,{n} дней назад\nweeks-ago.1,{n} week ago,Vor einer Woche,Una settimana fa,{n} week geleden,Hace una semana,Il y a {n} semaine,Faz uma semana,Одну неделю назад\nweeks-ago.n,{n} weeks ago,Vor {n} Wochen,{n} settimane fa,{n} weken geleden,Hace {n} semanas,Il y a {n} semaines,Fazem {n} semanas,{n} недель назад\nmonths-ago.1,{n} month ago,Vor einem Monat,Un mese fa,{n} maand geleden,Hace un mes,Il y a {n} mois,Tem um mês,Один месяц назад\nmonths-ago.n,{n} months ago,Vor {n} Monaten,{n} mesi,{n} maanden geleden,Hace {n} meses,Il y a {n} mois,Tem {n} meses,{n} месяцев назад\nyesterday,Yesterday,Gestern,Ieri,Gisteren,Ayer,Hier,Ontem,Вчера\njust-now,Just now,Eben,Appena,Nu,Ahora,Il y a un instant,Agora,Только что\nprevious,Previous,Zurück,Indietro,Vorige,Anterior,Précédent,Anterior,Предыдущий\nnext,Next,Weiter,Più,Volgende,Siguiente,Suivant,Próximo,Следующий\ncomments,Comments,Kommentare,Commenti,Comments,Comentarios,Commentaires,Comentários,Комментарии\nlikes,Likes,Gefällt mir,Mi piace,Likes,Me gusta,J'aime,Curtir,Лайки\nread-more,Read more,Weiterlesen,Di più,Lees meer,Leer más,En savoir plus,Leia mais,Подробнее\nfilter,Filter,Filtern,Filtrare,Filtreren,filtrar,Filtrer,Filtro,фильтровать\nall,All,Alle,Tutti,Alle,Todas,Tout,Todos,все\n",langs={},langDataLines=langsData.split("\n"),i=langDataLines.length-1;i>=0;i--)langDataLines[i]||langDataLines.splice(i,1);for(var keys=langDataLines[0].split(","),i$1=1;i$1<langDataLines.length;i$1++)for(var langDataCols=langDataLines[i$1].split(","),j=1;j<langDataCols.length;j++)!function(o,key,val){for(var kPath=key.split("."),i=0;i<kPath.length;i++){var k=kPath[i];o[k]||(o[k]={}),i===kPath.length-1?o[k]=val:o=o[k]}}(langs,keys[j]+"."+langDataCols[0],langDataCols[j]);var _cache={},currentLang="en",mod={setLang:function(lang){currentLang=lang},t:function(key,n,lang){return lang=lang||currentLang,_cache[lang]||(langs[lang]?_cache[lang]=libTranslate.getTranslationFunction(langs[lang]):(window.console.error("Unsupported language `"+lang+"`"),_cache[lang]=libTranslate.getTranslationFunction(langs.en))),key=key.toLowerCase(),key=key.replace(" ","-"),_cache[lang](key,n)}},DateUtils={dateFromString:function(time){var dtstr=time.replace(/\D/g," "),dtcomps=dtstr.split(" ");return dtcomps[1]--,new Date(Date.UTC(dtcomps[0],dtcomps[1],dtcomps[2],dtcomps[3],dtcomps[4],dtcomps[5]))},dateAsDayMonthYear:function(strEpoch){var myDate=new Date(parseInt(strEpoch,10)),day=myDate.getDate()+"",month=myDate.getMonth()+1+"",year=myDate.getFullYear()+"";return day=1===day.length?"0"+day:day,month=1===month.length?"0"+month:month,day+"/"+month+"/"+year},dateAsTimeArray:function(strEpoch){var ampm,myDate=new Date(parseInt(strEpoch,10)),hours=myDate.getHours()+"",mins=myDate.getMinutes()+"";return hours>=12?(ampm="PM",hours>12&&(hours=hours-12+"")):ampm="AM",hours=1===hours.length?"0"+hours:hours,mins=1===mins.length?"0"+mins:mins,[parseInt(hours.charAt(0),10),parseInt(hours.charAt(1),10),parseInt(mins.charAt(0),10),parseInt(mins.charAt(1),10),ampm]},fuzzyDate:function(dateString){var date=Date.parse(dateString+" UTC"),delta=Math.round((new Date-date)/1e3);return delta<30?"Just now":delta<60?delta+" seconds ago":delta<120?"a minute ago.":delta<3600?Math.floor(delta/60)+" minutes ago":1===Math.floor(delta/3600)?"1 hour ago.":delta<86400?Math.floor(delta/3600)+" hours ago":delta<172800?"Yesterday":delta<604800?"This week":delta<1209600?"Last week":delta<2592e3?"This month":date},prettyDate:function(time){var date=DateUtils.dateFromString(time),diff=((new Date).getTime()-date.getTime())/1e3,day_diff=Math.floor(diff/86400),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();if(isNaN(day_diff)||day_diff<0||day_diff>=31)return year.toString()+"-"+(month<10?"0"+month.toString():month.toString())+"-"+(day<10?"0"+day.toString():day.toString());var minute_diff=Math.floor(diff/60),hour_diff=Math.floor(diff/3600),week_diff=Math.ceil(day_diff/7);return 0===day_diff&&(diff<60&&mod.t("Just now")||diff<3600&&mod.t("minutes ago",minute_diff)||diff<86400&&mod.t("hours ago",hour_diff))||1===day_diff&&mod.t("Yesterday")||day_diff<7&&mod.t("days ago",day_diff)||day_diff<31&&mod.t("weeks ago",week_diff)}},helpers={networkIcon:function(){return this.data.network_name.toLowerCase()},networkName:function(){return this.data.network_name.toLowerCase()},userUrl:function(){if(this.data.user_url&&""!==this.data.user_url)return this.data.user_url;if(this.data.originator_user_url&&""!==this.data.originator_user_url)return this.data.originator_user_url;if(this.data.userUrl&&""!==this.data.userUrl)return this.data.userUrl;var netId=this.data.network_id+"";return"1"===netId?"http://twitter.com/"+this.data.user_screen_name:"2"===netId?"http://instagram.com/"+this.data.user_screen_name:"3"===netId?"http://facebook.com/"+this.data.user_screen_name:"#"},parseText:function(s){return this.data.is_html?s:("Twitter"===this.data.network_name?(s=StringUtils.linksToHref(s),s=StringUtils.twitterLinks(s)):"Instagram"===this.data.network_name?(s=StringUtils.linksToHref(s),s=StringUtils.instagramLinks(s)):"Facebook"===this.data.network_name?(s=StringUtils.linksToHref(s),s=StringUtils.facebookLinks(s)):s=StringUtils.linksToHref(s),StringUtils.nl2br(s))},nl2br:function(s){return StringUtils.nl2br(s)},contentImageClasses:function(){return this.data.image?"crt-post-has-image":"crt-post-content-image-hidden crt-post-no-image"},contentTextClasses:function(){return this.data.text?"crt-post-has-text":"crt-post-content-text-hidden crt-post-no-text"},fuzzyDate:function(dateString){return DateUtils.fuzzyDate(dateString)},prettyDate:function(time){return DateUtils.prettyDate(time)},_t:function(s,n){return mod.t(s,n)}},z=null;window.$crt?z=window.$crt:window.Zepto?z=window.Zepto:window.jQuery&&(z=window.jQuery),z||window.alert("Curator requires jQuery or Zepto. \n\nPlease include jQuery in your HTML before the Curator widget script tag.\n\nVisit http://jquery.com/download/ to get the latest version");var z$1=z,_rendererTmplCache={},Templating={renderTemplate:function(templateId,data){var source="",$t=z$1("#"+templateId);if(1===$t.length?source=$t.html():void 0!==Templates[templateId]&&(source=Templates[templateId]),""===source)throw new Error("Could not find template "+templateId);var tmpl=Templating.render(source,data);return z$1.parseHTML&&(tmpl=z$1.parseHTML(tmpl)),z$1(tmpl).filter("div")},render:function(str,data){var err="";try{var func=_rendererTmplCache[str];if(!func){var strComp=str.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('"),strFunc="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+strComp+"');}return p.join('');";func=new Function("obj",strFunc),_rendererTmplCache[str]=func}return helpers.data=data,func.call(helpers,data)}catch(e){Logger.log("Template parse error: "+e.message),err=e.message}return" # ERROR: "+err+" # "}},Post=function(EventBus$$1){function Post(postJson,options,widget){var this$1=this;EventBus$$1.call(this),this.options=options,this.widget=widget;var templateId=this.widget.options.templatePost;if(this.json=postJson,this.$el=Templating.renderTemplate(templateId,postJson),this.$postC=this.$el.find(".crt-post-c"),this.$image=this.$el.find(".crt-post-image"),this.$imageContainer=this.$el.find(".crt-image-c"),this.$el.find(".crt-share-facebook").click(this.onShareFacebookClick.bind(this)),this.$el.find(".crt-share-twitter").click(this.onShareTwitterClick.bind(this)),this.$el.find(".crt-post-read-more-button").click(this.onReadMoreClick.bind(this)),this.$postC.click(this.onPostClick.bind(this)),this.$image.css({opacity:0}),this.json.image?(this.$image.on("load",this.onImageLoaded.bind(this)),this.$image.on("error",this.onImageError.bind(this))):window.setTimeout(function(){this$1.setHeight()},100),this.json.image_width>0){var p=this.json.image_height/this.json.image_width*100;this.$imageContainer.addClass("crt-image-responsive").css("padding-bottom",p+"%")}0!==this.json.url.indexOf("http")&&this.$el.find(".crt-post-share").hide(),this.$image.data("dims",this.json.image_width+":"+this.json.image_height),this.json.video&&this.$el.addClass("crt-post-has-video"),this.json.images&&this.json.images.length>0&&this.$el.addClass("crt-has-image-carousel")}return EventBus$$1&&(Post.__proto__=EventBus$$1),Post.prototype=Object.create(EventBus$$1&&EventBus$$1.prototype),Post.prototype.constructor=Post,Post.prototype.onShareFacebookClick=function(ev){return ev.preventDefault(),SocialFacebook.share(this.json),this.widget.track("share:facebook"),!1},Post.prototype.onShareTwitterClick=function(ev){return ev.preventDefault(),SocialTwitter.share(this.json),this.widget.track("share:twitter"),!1},Post.prototype.onPostClick=function(ev){Logger.log("Post->click");var target=z$1(ev.target);console.log(target[0].className.indexOf("read-more")),target[0]&&target[0].className.indexOf("read-more")>0||(target.is("a")&&"#"!==target.attr("href")?this.widget.track("click:link"):(ev.preventDefault(),this.trigger(Events.POST_CLICK,this,ev)))},Post.prototype.onReadMoreClick=function(ev){ev.preventDefault(),this.widget.track("click:read-more"),this.trigger(Events.POST_CLICK_READ_MORE,this,this.json,ev)},Post.prototype.onImageLoaded=function(){this.$image.animate({opacity:1}),this.setHeight(),this.trigger(Events.POST_IMAGE_LOADED,this),this.widget.trigger(Events.POST_IMAGE_LOADED,this)},Post.prototype.onImageError=function(){this.$image.hide(),this.setHeight(),this.trigger(Events.POST_IMAGE_FAILED,this),this.widget.trigger(Events.POST_IMAGE_FAILED,this)},Post.prototype.setHeight=function(){var height=this.$postC.height();this.options.maxHeight&&this.options.maxHeight>0&&height>this.options.maxHeight&&(this.$postC.css({maxHeight:this.options.maxHeight}),this.$el.addClass("crt-post-max-height")),this.layout()},Post.prototype.getHeight=function(){return this.$el.hasClass("crt-post-max-height")?this.$postC.height():this.$el.find(".crt-post-content").height()+this.$el.find(".crt-post-footer").height()+2},Post.prototype.layout=function(){this.layoutFooter()},Post.prototype.layoutFooter=function(){var $userName=this.$el.find(".crt-post-username"),$date=this.$el.find(".crt-date"),$footer=this.$el.find(".crt-post-footer"),$share=this.$el.find(".crt-post-share"),$userImage=this.$el.find(".crt-post-userimage"),footerWidth=$footer.width();$userName.width()+$date.width()+$share.width()+$userImage.width()+40>footerWidth&&$userName.hide()},Post}(EventBus),HtmlUtils={checkContainer:function(container){return Logger.log("Curator->checkContainer: "+container),0!==z$1(container).length||(window.console&&window.console.log("Curator could not find the element "+container+". Please ensure this element existings in your HTML code. Exiting."),!1)},checkPowered:function(jQuerytag){return Logger.log("Curator->checkPowered"),jQuerytag.html().indexOf("Curator")>0||(window.alert("Container is missing Powered by Curator"),!1)},addCSSRule:function(sheet,selector,rules,index){index=index||0,"insertRule"in sheet?sheet.insertRule(selector+"{"+rules+"}",0):"addRule"in sheet&&sheet.addRule(selector,rules)},createSheet:function(){var style=document.createElement("style");return style.appendChild(document.createTextNode("")),document.head.appendChild(style),style.sheet},loadCSS:function(){}},serialize=function(obj){return"?"+Object.keys(obj).reduce(function(a,k){return a.push(k+"="+encodeURIComponent(obj[k])),a},[]).join("&")},fixUrl=function(url){var p=window.location.protocol,pp=url.indexOf("://");return pp&&(url=url.substr(pp+3)),p="https:"!==p&&"http:"!==p?"https:":p,url=p+"//"+url},ajax={get:function(url,params,success,fail){url=fixUrl(url),params&&(url+=serialize(params)),nanoajax({url:url,cors:!0},function(statusCode,responseText){statusCode?success(JSON.parse(responseText)):fail(statusCode,responseText)})},post:function(url,params,success,fail){url=fixUrl(url),nanoajax({url:url,cors:!0,body:params,method:"POST"},function(statusCode,responseText){statusCode?success(JSON.parse(responseText)):fail(statusCode,responseText)})}},Feed=function(EventBus$$1){function Feed(widget){EventBus$$1.call(this),Logger.log("Feed->init with options"),this.widget=widget,this.posts=[],this.currentPage=0,this.postsLoaded=0,this.postCount=0,this.loading=!1,this.allPostsLoaded=!1,this.pagination={after:null,before:null},this.options=this.widget.options,this.params=this.options.feedParams||{},this.params.limit=this.options.postsPerPage,this.feedBase=this.options.apiEndpoint+"/feeds"}return EventBus$$1&&(Feed.__proto__=EventBus$$1),Feed.prototype=Object.create(EventBus$$1&&EventBus$$1.prototype),Feed.prototype.constructor=Feed,Feed.prototype.loadPosts=function(page,paramsIn){if(page=page||0,Logger.log("Feed->loadPosts "+this.loading),this.loading)return!1;this.currentPage=page,0==+this.currentPage&&(this.posts=[],this.postsLoaded=0);var params=z$1.extend({},this.params,paramsIn);params.limit=this.options.postsPerPage,params.offset=page*this.options.postsPerPage,this._loadPosts(params)},Feed.prototype.loadMorePaginated=function(paramsIn){var params=z$1.extend({},this.params,paramsIn);this.pagination&&this.pagination.after&&(params.after=this.pagination.after),this._loadPosts(params)},Feed.prototype.loadMore=function(paramsIn){if(Logger.log("Feed->loadMore "+this.loading),this.loading)return!1;var params={limit:this.options.postsPerPage};z$1.extend(params,this.options.feedParams,paramsIn),params.offset=this.posts.length,this._loadPosts(params)},Feed.prototype.load=function(params){if(Logger.log("Feed->load "+this.loading),this.loading)return!1;this.currentPage=0;var loadPostParams=z$1.extend(this.params,params);this._loadPosts(loadPostParams)},Feed.prototype.loadAfter=function(){if(Logger.log("Feed->loadAfter "+this.loading),this.loading)return!1;this.currentPage=0;var params=z$1.extend({},this.params);this.pagination&&this.pagination.after&&(params.after=this.pagination.after,delete params.before),this._loadPosts(params)},Feed.prototype._loadPosts=function(params){var this$1=this;Logger.log("Feed->_loadPosts"),this.loading=!0,params.rnd=(new Date).getTime(),ajax.get(this.getUrl("/posts"),params,function(data){Logger.log("Feed->_loadPosts success"),data.success?(this$1.postCount=data.postCount,this$1.postsLoaded+=data.posts.length,this$1.allPostsLoaded=this$1.postsLoaded>=this$1.postCount,this$1.posts=this$1.posts.concat(data.posts),this$1.networks=data.networks,data.pagination&&(this$1.pagination=data.pagination),this$1.widget.trigger(Events.FEED_LOADED,data),this$1.trigger(Events.FEED_LOADED,data),this$1.widget.trigger(Events.POSTS_LOADED,data.posts),this$1.trigger(Events.POSTS_LOADED,data.posts)):(this$1.trigger(Events.POSTS_FAILED,data),this$1.widget.trigger(Events.POSTS_FAILED,data)),this$1.loading=!1},function(jqXHR,textStatus,errorThrown){Logger.log("Feed->_loadPosts fail"),Logger.log(textStatus),Logger.log(errorThrown),this$1.trigger(Events.POSTS_FAILED,[]),this$1.loading=!1})},Feed.prototype.loadPost=function(id,successCallback,failCallback){failCallback=failCallback||function(){},ajax.get(this.getUrl("/post/"+id),{},function(data){data.success?successCallback(data.post):failCallback()},function(jqXHR,textStatus,errorThrown){})},Feed.prototype.inappropriatePost=function(id,reason,success,failure){var params={reason:reason};ajax.post(this.getUrl("/post/"+id+"/inappropriate"),params,function(data,textStatus,jqXHR){data=z$1.parseJSON(data),data.success===!0?success():failure(jqXHR)})},Feed.prototype.lovePost=function(id,success,failure){var params={};z$1.post(this.getUrl("/post/"+id+"/love"),params,function(data,textStatus,jqXHR){data=z$1.parseJSON(data),data.success===!0?success(data.loves):failure(jqXHR)})},Feed.prototype.getUrl=function(trail){return this.feedBase+"/"+this.options.feedId+trail},Feed.prototype.destroy=function(){EventBus$$1.prototype.destroy.call(this)},Feed}(EventBus),networks={1:{name:"Twitter",icon:"crt-icon-twitter"},2:{name:"Instagram",icon:"crt-icon-instagram"},3:{name:"Facebook",icon:"crt-icon-facebook"},4:{name:"Pinterest",icon:"crt-icon-pinterest"},5:{name:"Google",icon:"crt-icon-google"},6:{name:"Vine",icon:"crt-icon-vine"},7:{name:"Flickr",icon:"crt-icon-flickr"},8:{name:"Youtube",icon:"crt-icon-youtube"},9:{name:"Tumblr",icon:"crt-icon-tumblr"},10:{name:"RSS",icon:"crt-icon-rss"},11:{name:"LinkedIn",icon:"crt-icon-linkedin"}},Filter=function(EventBus$$1){function Filter(widget){var this$1=this;Logger.log("Filter->construct"),EventBus$$1.call(this),this.widget=widget,this.options=widget.options,this.$filter=Templating.renderTemplate(this.options.templateFilter,{}),this.$filterNetworks=this.$filter.find(".crt-filter-networks"),this.$filterNetworksUl=this.$filter.find(".crt-filter-networks ul"),this.$filterSources=this.$filter.find(".crt-filter-sources"),this.$filterSourcesUl=this.$filter.find(".crt-filter-sources ul"),this.widget.$container.append(this.$filter),this.$filter.on("click",".crt-filter-networks a",function(ev){ev.preventDefault();var t=z$1(ev.target),networkId=t.data("network");this$1.$filter.find(".crt-filter-networks li").removeClass("active"),t.parent().addClass("active"),this$1.widget.trigger(Events.FILTER_CHANGED,this$1),this$1.widget.feed.params.network_id=networkId?networkId:0,this$1.widget.feed.loadPosts(0)}),this.$filter.on("click",".crt-filter-sources a",function(ev){ev.preventDefault();var t=z$1(ev.target),sourceId=t.data("source");this$1.$filter.find(".crt-filter-sources li").removeClass("active"),t.parent().addClass("active"),this$1.widget.trigger(Events.FILTER_CHANGED,this$1),this$1.widget.feed.params.source_id=sourceId?sourceId:0,this$1.widget.feed.loadPosts(0)}),this.widget.on(Events.FEED_LOADED,this.onPostsLoaded.bind(this))}return EventBus$$1&&(Filter.__proto__=EventBus$$1),Filter.prototype=Object.create(EventBus$$1&&EventBus$$1.prototype),Filter.prototype.constructor=Filter,Filter.prototype.onPostsLoaded=function(event,data){var this$1=this,networks$$1=data.networks,sources=data.sources;if(!this.filtersLoaded){if(this.options.filter.showNetworks)for(var i=0,list=networks$$1;i<list.length;i+=1){var id=list[i],network=networks[id];network&&this$1.$filterNetworksUl.append('<li><a href="#" data-network="'+id+'"><i class="'+network.icon+'"></i> '+network.name+"</a></li>")}else this.$filterNetworks.hide();if(this.options.filter.showSources)for(var i$1=0,list$1=sources;i$1<list$1.length;i$1+=1){var source=list$1[i$1],network$1=networks[source.network_id];network$1&&this$1.$filterSourcesUl.append('<li><a href="#" data-source="'+source.id+'"><i class="'+network$1.icon+'"></i> '+source.name+"</a></li>")}else this.$filterSources.hide();this.filtersLoaded=!0}},Filter.prototype.destroy=function(){this.$filter.remove()},Filter}(EventBus),Popup=function(popupManager,post,widget){var this$1=this;Logger.log("Popup->init "),this.popupManager=popupManager,this.json=post,this.widget=widget;var templateId=this.widget.options.templatePopup;if(this.videoPlaying=!1,this.$popup=Templating.renderTemplate(templateId,this.json),this.$left=this.$popup.find(".crt-popup-left"),this.json.image&&this.$popup.addClass("has-image"),this.json.video&&this.$popup.addClass("has-video"),this.json.video&&this.json.video.indexOf("youtu")>=0){this.$popup.find("video").remove();var youTubeId=StringUtils.youtubeVideoId(this.json.video),src='<div class="crt-responsive-video"><iframe id="ytplayer" src="https://www.youtube.com/embed/'+youTubeId+'?autoplay=0&rel=0&showinfo" frameborder="0" allowfullscreen></iframe></div>';this.$popup.find(".crt-video-container img").remove(),this.$popup.find(".crt-video-container a").remove(),this.$popup.find(".crt-video-container").append(src)}else if(this.json.video&&this.json.video.indexOf("vimeo")>=0){this.$popup.find("video").remove();var vimeoId=StringUtils.vimeoVideoId(this.json.video);if(vimeoId){var src$1='<div class="crt-responsive-video"><iframe src="https://player.vimeo.com/video/'+vimeoId+'?color=ffffff&title=0&byline=0&portrait=0" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>';this.$popup.find(".crt-video-container img").remove(),this.$popup.find(".crt-video-container a").remove(),this.$popup.find(".crt-video-container").append(src$1)}}if(this.json.images){this.$page=this.$popup.find(".crt-pagination ul");for(var i=0;i<this.json.images.length;i++)this$1.$page.append('<li><a href="" data-page="'+i+'"></a></li>');this.$page.find("a").click(this.onPageClick.bind(this)),this.currentImage=0,this.$page.find("li:nth-child("+(this.currentImage+1)+")").addClass("selected")}this.$popup.on("click"," .crt-close",this.onClose.bind(this)),this.$popup.on("click"," .crt-previous",this.onPrevious.bind(this)),this.$popup.on("click"," .crt-next",this.onNext.bind(this)),this.$popup.on("click"," .crt-play",this.onPlay.bind(this)),this.$popup.on("click",".crt-share-facebook",this.onShareFacebookClick.bind(this)),this.$popup.on("click",".crt-share-twitter",this.onShareTwitterClick.bind(this)),z$1(window).on("resize.crt-popup",CommonUtils.debounce(this.onResize.bind(this),50)),this.onResize()};Popup.prototype.onResize=function(){Logger.log("Popup->onResize");var windowWidth=z$1(window).width();windowWidth>1055?this.$left.width(935):windowWidth>910?this.$left.width(windowWidth-120):windowWidth>680?this.$left.width(600):this.$left.width(windowWidth-80)},Popup.prototype.onPageClick=function(ev){ev.preventDefault()
;var a=z$1(ev.target),page=a.data("page"),image=this.json.images[page];this.$popup.find(".crt-image img").attr("src",image.url),this.currentImage=page,this.$page.find("li").removeClass("selected"),this.$page.find("li:nth-child("+(this.currentImage+1)+")").addClass("selected")},Popup.prototype.onShareFacebookClick=function(ev){return ev.preventDefault(),SocialFacebook.share(this.json),this.widget.track("share:facebook"),!1},Popup.prototype.onShareTwitterClick=function(ev){return ev.preventDefault(),SocialTwitter.share(this.json),this.widget.track("share:twitter"),!1},Popup.prototype.onClose=function(e){e.preventDefault();var that=this;this.hide(function(){that.popupManager.onClose()})},Popup.prototype.onPrevious=function(e){e.preventDefault(),this.popupManager.onPrevious()},Popup.prototype.onNext=function(e){e.preventDefault(),this.popupManager.onNext()},Popup.prototype.onPlay=function(e){Logger.log("Popup->onPlay"),e.preventDefault(),this.videoPlaying=!this.videoPlaying,this.videoPlaying?(this.$popup.find("video")[0].play(),this.widget.track("video:play")):(this.$popup.find("video")[0].pause(),this.widget.track("video:pause")),Logger.log(this.videoPlaying),this.$popup.toggleClass("video-playing",this.videoPlaying)},Popup.prototype.show=function(){this.$popup.fadeIn(function(){})},Popup.prototype.hide=function(callback){Logger.log("Popup->hide");var that=this;this.$popup.fadeOut(function(){that.destroy(),callback()})},Popup.prototype.destroy=function(){this.$popup&&this.$popup.length&&(this.$popup.remove(),this.$popup.find("video").length&&this.$popup.find("video")[0].pause()),z$1(window).off("resize.crt-popup"),delete this.$popup};var PopupManager=function(widget){Logger.log("PopupManager->init "),this.widget=widget;var templateId=this.widget.options.templatePopupWrapper;this.$wrapper=Templating.renderTemplate(templateId,{}),this.$popupContainer=this.$wrapper.find(".crt-popup-container"),this.$underlay=this.$wrapper.find(".crt-popup-underlay"),z$1("body").append(this.$wrapper),this.$underlay.click(this.onUnderlayClick.bind(this))};PopupManager.prototype.showPopup=function(post){var this$1=this;this.popup?this.popup.hide(function(){this$1.popup.destroy(),this$1.showPopup2(post)}):this.showPopup2(post)},PopupManager.prototype.showPopup2=function(post){var this$1=this;this.popup=new Popup(this,post,this.widget),this.$popupContainer.append(this.popup.$popup),this.$wrapper.show(),"block"!==this.$underlay.css("display")&&this.$underlay.fadeIn(),this.popup.show(),z$1("body").addClass("crt-popup-visible"),this.currentPostNum=0;for(var i=0;i<this.posts.length;i++)if(post.id===this$1.posts[i].id){this$1.currentPostNum=i,Logger.log("Found post "+i);break}this.widget.track("popup:show")},PopupManager.prototype.setPosts=function(posts){this.posts=posts},PopupManager.prototype.onClose=function(){this.hide()},PopupManager.prototype.onPrevious=function(){this.currentPostNum-=1,this.currentPostNum=this.currentPostNum>=0?this.currentPostNum:this.posts.length-1,this.showPopup(this.posts[this.currentPostNum])},PopupManager.prototype.onNext=function(){this.currentPostNum+=1,this.currentPostNum=this.currentPostNum<this.posts.length?this.currentPostNum:0,this.showPopup(this.posts[this.currentPostNum])},PopupManager.prototype.onUnderlayClick=function(e){Logger.log("PopupManager->onUnderlayClick"),e.preventDefault(),this.popup&&this.popup.hide(function(){this.hide()}.bind(this))},PopupManager.prototype.hide=function(){var this$1=this;Logger.log("PopupManager->hide"),this.widget.track("popup:hide"),z$1("body").removeClass("crt-popup-visible"),this.currentPostNum=0,this.popup=null,this.$underlay.fadeOut(function(){this$1.$underlay.css({display:"",opacity:""}),this$1.$wrapper.hide()})},PopupManager.prototype.destroy=function(){this.$underlay.remove(),delete this.$popup,delete this.$underlay};var Widget=function(EventBus$$1){function Widget(){Logger.log("Widget->construct"),EventBus$$1.call(this),this.id=CommonUtils.uId()}return EventBus$$1&&(Widget.__proto__=EventBus$$1),Widget.prototype=Object.create(EventBus$$1&&EventBus$$1.prototype),Widget.prototype.constructor=Widget,Widget.prototype.init=function(options,defaults){var this$1=this;if(this.options=z$1.extend(!0,{},defaults,options),!HtmlUtils.checkContainer(this.options.container))return!1;this.$container=z$1(this.options.container),this.$container.addClass("crt-feed");for(var inlineOptions=["lang","debug"],i=0,list=inlineOptions;i<list.length;i+=1){var option=list[i],val=this$1.$container.data("crt-"+option);val&&(this$1.options[option]=val)}return this.options.debug&&(Logger.debug=!0),this.updateResponsiveOptions(),Logger.log("Setting language to: "+this.options.lang),mod.setLang(this.options.lang),this.createFeed(),this.createFilter(),this.createPopupManager(),!0},Widget.prototype.updateResponsiveOptions=function(){if(!this.options.responsive)return void(this.responsiveOptions=z$1.extend(!0,{},this.options));var width=z$1(window).width(),keys=Object.keys(this.options.responsive);keys=keys.map(function(x){return parseInt(x)}),keys=keys.sort(function(a,b){return a-b}),keys=keys.reverse();for(var foundKey=null,i=0,list=keys;i<list.length;i+=1){var key=list[i];width<=key&&(foundKey=key)}foundKey||(this.responsiveKey=null,this.responsiveOptions=z$1.extend(!0,{},this.options)),this.responsiveKey!==foundKey&&(this.responsiveKey=foundKey,this.responsiveOptions=z$1.extend(!0,{},this.options,this.options.responsive[foundKey]))},Widget.prototype.createFeed=function(){this.feed=new Feed(this),this.feed.on(Events.POSTS_LOADED,this.onPostsLoaded.bind(this)),this.feed.on(Events.POSTS_FAILED,this.onPostsFail.bind(this)),this.feed.on(Events.FEED_LOADED,this.onFeedLoaded.bind(this))},Widget.prototype.createPopupManager=function(){this.popupManager=new PopupManager(this)},Widget.prototype.createFilter=function(){Logger.log("Widget->createFilter"),Logger.log(this.options.filter),this.options.filter&&(this.options.filter.showNetworks||this.options.filter.showSources)&&(this.filter=new Filter(this))},Widget.prototype.loadPosts=function(page){this.feed.loadPosts(page)},Widget.prototype.createPostElements=function(posts){var that=this,postElements=[];return z$1(posts).each(function(){var p=that.createPostElement(this);postElements.push(p.$el)}),postElements},Widget.prototype.createPostElement=function(postJson){var post=new Post(postJson,this.options,this);return post.on(Events.POST_CLICK,this.onPostClick.bind(this)),post.on(Events.POST_CLICK_READ_MORE,this.onPostClickReadMore.bind(this)),post.on(Events.POST_IMAGE_LOADED,this.onPostImageLoaded.bind(this)),this.trigger(Events.POST_CREATED,post),post},Widget.prototype.onPostsLoaded=function(event,posts){Logger.log("Widget->onPostsLoaded"),Logger.log(event),Logger.log(posts)},Widget.prototype.onPostsFail=function(event,data){Logger.log("Widget->onPostsLoadedFail"),Logger.log(event),Logger.log(data)},Widget.prototype.onPostClick=function(ev,post){Logger.log("Widget->onPostClick"),Logger.log(ev),Logger.log(post),this.trigger(Events.POST_CLICK,post),this.options.postClickAction===Globals.POST_CLICK_ACTION_OPEN_POPUP?this.popupManager.showPopup(post.json):this.options.postClickAction===Globals.POST_CLICK_ACTION_GOTO_SOURCE&&window.open(post.json.url)},Widget.prototype.onPostClickReadMore=function(ev,post){Logger.log("Widget->onPostClickReadMore"),Logger.log(ev),Logger.log(post),this.trigger(Events.POST_CLICK_READ_MORE,post),this.options.postClickReadMoreAction===Globals.POST_CLICK_ACTION_OPEN_POPUP?this.popupManager.showPopup(post.json):this.options.postClickAction===Globals.POST_CLICK_ACTION_GOTO_SOURCE&&window.open(post.json.url)},Widget.prototype.onPostImageLoaded=function(ev,post){},Widget.prototype.onFeedLoaded=function(ev,response){this.options.hidePoweredBy&&1===response.account.plan.unbranded?this.$container.addClass("crt-feed-unbranded"):this.$container.addClass("crt-feed-branded")},Widget.prototype.track=function(a){Logger.log("Feed->track "+a),ajax.get(this.getUrl("/track/"+this.options.feedId),{a:a},function(data){Logger.log("Feed->track success"),Logger.log(data)},function(jqXHR,textStatus,errorThrown){Logger.log("Feed->_loadPosts fail"),Logger.log(textStatus),Logger.log(errorThrown)})},Widget.prototype.getUrl=function(trail){return this.options.apiEndpoint+trail},Widget.prototype._t=function(s){return mod.t(s)},Widget.prototype.destroy=function(){Logger.log("Widget->destroy"),EventBus$$1.prototype.destroy.call(this),this.feed&&this.feed.destroy(),this.filter&&this.filter.destroy(),this.popupManager&&this.popupManager.destroy(),this.$container.removeClass("crt-feed"),this.$container.removeClass("crt-feed-unbranded"),this.$container.removeClass("crt-feed-branded")},Widget}(EventBus),ConfigWidgetBase={apiEndpoint:"https://api.curator.io/v1.1",feedId:"",postsPerPage:12,maxPosts:0,templatePost:"post-v2",templatePopup:"popup",templatePopupWrapper:"popup-wrapper",templateFilter:"filter",lang:"en",debug:!1,postClickAction:"open-popup",postClickReadMoreAction:"open-popup",filter:{showNetworks:!1,showSources:!1}},ConfigWidgetWaterfall=z$1.extend({},ConfigWidgetBase,{waterfall:{showLoadMore:!0,continuousScroll:!1,gridWidth:300,animate:!0,animateSpeed:400}}),makeArray=function(array,results){return array=Array.prototype.slice.call(array),results?(results.push.apply(results,array),results):array},LayoutWaterfallSettings={selector:".item",width:225,gutter:20,animate:!1,animationOptions:{speed:200,duration:300,effect:"fadeInOnAppear",queue:!0,complete:function(){}}},LayoutWaterfall=function(options,element){Logger.log("WaterfallLayout->onPostsLoaded"),this.element=z$1(element),this.id=CommonUtils.uId(),this.name=this._setName(5),this.gridArr=[],this.gridArrAppend=[],this.gridArrPrepend=[],this.setArr=!1,this.setGrid=!1,this.cols=0,this.itemCount=0,this.isPrepending=!1,this.appendCount=0,this.resetCount=!0,this.ifCallback=!0,this.box=this.element,this.boxWidth=this.box.width(),this.options=z$1.extend(!0,{},LayoutWaterfallSettings,options),this.gridArr=makeArray(this.box.find(this.options.selector)),this.isResizing=!1,this.w=0,this.boxArr=[],this._setCols(),this._renderGrid("append"),z$1(this.box).addClass("gridalicious"),this.createHandlers()};LayoutWaterfall.prototype.createHandlers=function(){var this$1=this;Logger.log("WaterfallLayout->createHandlers"),z$1(window).on("resize."+this.id,CommonUtils.debounce(function(){this$1.resize()},100))},LayoutWaterfall.prototype.destroyHandlers=function(){Logger.log("WaterfallLayout->destroyHandlers"),z$1(window).off("resize."+this.id)},LayoutWaterfall.prototype._setName=function(length,current){return current=current?current:"",length?this._setName(--length,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(60*Math.random()))+current):current},LayoutWaterfall.prototype._setCols=function(){var this$1=this;this.cols=Math.floor(this.box.width()/this.options.width),this.cols<1&&(this.cols=1);var diff=(this.box.width()-this.cols*this.options.width-this.options.gutter)/this.cols,w=(this.options.width+diff)/this.box.width()*100;this.w=w,this.colHeights=new Array(this.cols),this.colHeights.fill(0),this.colItems=new Array(this.cols),this.colItems.fill([]);for(var i=0;i<this.cols;i++){var div=z$1("<div></div>").addClass("galcolumn").attr("id","item"+i+this$1.name).css({width:w+"%",paddingLeft:this$1.options.gutter,paddingBottom:this$1.options.gutter,float:"left","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","-o-box-sizing":"border-box","box-sizing":"border-box"});this$1.box.append(div)}},LayoutWaterfall.prototype._renderGrid=function(method,arr,count){var this$1=this,items=[],boxes=[],appendCount=this.appendCount,cols=this.cols,name=this.name;arr?(boxes=arr,"append"===method&&(appendCount+=count),"prepend"===method&&(this.isPrepending=!0),"renderAfterPrepend"===method&&(appendCount+=count)):(boxes=this.gridArr,appendCount=z$1(this.gridArr).length);for(var i$1=0,list=boxes;i$1<list.length;i$1+=1){var item=list[i$1];item.hasClass("not-responsive"),item.css({zoom:"1",filter:"alpha(opacity=0)",opacity:"0"});for(var shortestCol=0,i=1;i<this.colHeights.length;i++)this$1.colHeights[i]<this$1.colHeights[shortestCol]&&(shortestCol=i);"prepend"===method?(z$1("#item"+shortestCol+name).prepend(item),items.push(item)):(z$1("#item"+shortestCol+name).append(item),items.push(item),appendCount>=cols&&(appendCount-=cols)),this$1.colItems[shortestCol].push(item),this$1.colHeights[shortestCol]+=item.height()}this.appendCount=appendCount,"append"===method||"prepend"===method?("prepend"===method&&this._updateAfterPrepend(this.gridArr,boxes),this._renderItem(items),this.isPrepending=!1):this._renderItem(this.gridArr)},LayoutWaterfall.prototype._collectItems=function(){var collection=[];return z$1(this.box).find(this.options.selector).each(function(){collection.push(z$1(this))}),collection},LayoutWaterfall.prototype._renderItem=function(items){var speed=this.options.animationOptions.speed,effect=this.options.animationOptions.effect,duration=this.options.animationOptions.duration,queue=this.options.animationOptions.queue,animate=this.options.animate,complete=this.options.animationOptions.complete,i=0,t=0;animate!==!0||this.isResizing?(z$1.each(items,function(index,value){z$1(value).css({opacity:"1",filter:"alpha(opacity=100)"})}),this.ifCallback&&complete.call(items)):(queue===!0&&"fadeInOnAppear"===effect?(this.isPrepending&&items.reverse(),z$1.each(items,function(index,value){window.setTimeout(function(){z$1(value).animate({opacity:"1.0"},duration),++t===items.length&&complete.call(void 0,items)},i*speed),i++})):queue===!1&&"fadeInOnAppear"===effect&&(this.isPrepending&&items.reverse(),z$1.each(items,function(index,value){z$1(value).animate({opacity:"1.0"},duration),++t===items.length&&this.ifCallback&&complete.call(void 0,items)})),queue!==!0||effect||z$1.each(items,function(index,value){z$1(value).css({opacity:"1",filter:"alpha(opacity=100)"}),++t===items.length&&this.ifCallback&&complete.call(void 0,items)}))},LayoutWaterfall.prototype._updateAfterPrepend=function(prevItems,newItems){var gridArr=this.gridArr;z$1.each(newItems,function(index,value){gridArr.unshift(value)}),this.gridArr=gridArr},LayoutWaterfall.prototype.resize=function(){if(this.box.width()!==this.boxWidth){var newCols=Math.floor(this.box.width()/this.options.width);this.cols!==newCols&&(this.box.find(z$1(".galcolumn")).remove(),this._setCols(),this.ifCallback=!1,this.isResizing=!0,this._renderGrid("append"),this.ifCallback=!0,this.isResizing=!1,this.boxWidth=this.box.width())}},LayoutWaterfall.prototype.append=function(items){var gridArr=this.gridArr,gridArrAppend=this.gridArrPrepend;z$1.each(items,function(index,value){gridArr.push(value),gridArrAppend.push(value)}),this._renderGrid("append",items,z$1(items).length)},LayoutWaterfall.prototype.prepend=function(items){this.ifCallback=!1,this._renderGrid("prepend",items,z$1(items).length),this.ifCallback=!0},LayoutWaterfall.prototype.destroy=function(){this.destroyHandlers()};var Waterfall=function(Widget$$1){function Waterfall(options){var this$1=this;Widget$$1.call(this),this.init(options,ConfigWidgetWaterfall)&&(Logger.log("Waterfall->init with options:"),Logger.log(this.options),this.$scroll=z$1('<div class="crt-feed-scroll"></div>').appendTo(this.$container),this.$feed=z$1('<div class="crt-feed"></div>').appendTo(this.$scroll),this.$container.addClass("crt-feed-container"),this.options.continuousScroll&&z$1(this.$scroll).scroll(function(){var height=this$1.$scroll.height(),cHeight=this$1.$feed.height();this$1.$scroll.scrollTop()>=cHeight-height&&this$1.loadMorePosts()}),this.options.waterfall.showLoadMore&&(this.$more=z$1('<div class="crt-load-more"><a href="#"><span>'+this._t("Load more")+"</span></a></div>").appendTo(this.$scroll),this.$more.find("a").on("click",function(ev){ev.preventDefault(),this$1.loadMorePosts()})),this.ui=new LayoutWaterfall({selector:".crt-post-c",gutter:0,width:this.options.waterfall.gridWidth,animate:this.options.waterfall.animate,animationOptions:{speed:this.options.waterfall.animateSpeed/2,duration:this.options.waterfall.animateSpeed}},this.$feed),this.on(Events.FILTER_CHANGED,function(){this$1.$feed.find(".crt-post").remove()}),this.feed.load(),this.iniListeners())}return Widget$$1&&(Waterfall.__proto__=Widget$$1),Waterfall.prototype=Object.create(Widget$$1&&Widget$$1.prototype),Waterfall.prototype.constructor=Waterfall,Waterfall.prototype.iniListeners=function(){},Waterfall.prototype.destroyListeners=function(){},Waterfall.prototype.loadMorePosts=function(){Logger.log("Waterfall->loadMorePosts"),this.feed.loadAfter()},Waterfall.prototype.loadPage=function(page){Logger.log("Waterfall->loadPage"),this.$feed.find(".crt-post").remove(),this.feed.loadPosts(page)},Waterfall.prototype.onPostsLoaded=function(event,posts){Logger.log("Waterfall->onPostsLoaded");var postElements=this.createPostElements(posts);this.ui.append(postElements);var that=this;z$1.each(postElements,function(){var post=this;that.options.waterfall.showReadMore&&post.find(".crt-post").addClass("crt-post-show-read-more")}),this.options.waterfall.showLoadMore&&(this.feed.allPostsLoaded?this.$more.hide():this.$more.show()),this.popupManager.setPosts(posts),this.loading=!1,this.trigger(Events.POSTS_RENDERED,this)},Waterfall.prototype.destroy=function(){Logger.log("Waterfall->destroy"),Widget$$1.prototype.destroy.call(this),this.feed.destroy(),this.ui.destroy(),this.$feed.remove(),this.$scroll.remove(),this.$more&&this.$more.remove(),this.$container.removeClass("crt-feed-container"),this.destroyListeners(),delete this.$feed,delete this.$scroll,delete this.$container,delete this.options,delete this.totalPostsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},Waterfall}(Widget),ConfigWidgetList=z$1.extend({},ConfigWidgetBase,{templatePost:"list-post",templateFeed:"list-feed",animate:!1,list:{showLoadMore:!0}}),List=function(Widget$$1){function List(options){if(Widget$$1.call(this),this.loading=!1,this.feed=null,this.$container=null,this.$feed=null,this.posts=[],this.init(options,ConfigWidgetList)){Logger.log("List->init with options:"),Logger.log(this.options);var tmpl=Templating.renderTemplate(this.responsiveOptions.templateFeed,{});this.$container.append(tmpl),this.$feed=this.$container.find(".crt-feed"),this.$feedWindow=this.$container.find(".crt-feed-window"),this.$loadMore=this.$container.find(".crt-feed-more a"),this.$scroller=z$1(window),this.$container.addClass("crt-list"),this.responsiveOptions.list.showLoadMore?(this.$feedWindow.css({position:"relative"}),this.$loadMore.click(this.onMoreClicked.bind(this))):this.$loadMore.hide(),this.createHandlers(),this.feed.load()}}return Widget$$1&&(List.__proto__=Widget$$1),List.prototype=Object.create(Widget$$1&&Widget$$1.prototype),List.prototype.constructor=List,List.prototype.createHandlers=function(){var this$1=this,id=this.id,updateLayoutDebounced=CommonUtils.debounce(function(){this$1.updateLayout()},100);z$1(window).on("resize."+id,CommonUtils.debounce(function(){this$1.updateResponsiveOptions(),this$1.updateLayout()},100)),z$1(window).on("curatorCssLoaded."+id,updateLayoutDebounced),z$1(document).on("ready."+id,updateLayoutDebounced),this.responsiveOptions.list.continuousScroll&&z$1(window).on("scroll."+id,CommonUtils.debounce(function(){this$1.checkScroll()},100)),this.on(Events.FILTER_CHANGED,function(){this$1.$feed.find(".crt-list-post").remove()})},List.prototype.destroyHandlers=function(){var id=this.id;z$1(window).off("resize."+id),z$1(window).off("curatorCssLoaded."+id),z$1(document).off("ready."+id),z$1(window).off("scroll."+id)},List.prototype.loadPosts=function(){},List.prototype.updateLayout=function(){var cols=Math.floor(this.$container.width()/this.responsiveOptions.list.minWidth);cols=cols<1?1:cols,this.$container.removeClass("crt-list-col"+this.columnCount),this.columnCount=cols,this.$container.addClass("crt-list-col"+this.columnCount);var postsNeeded=cols*(this.rowsMax+1);if(postsNeeded>this.feed.postsLoaded&&!this.feed.allPostsLoaded){var limit=postsNeeded-this.feed.postsLoaded,params={limit:limit};this.feed.loadMorePaginated(params)}else this.updateHeight(!1)},List.prototype.updateHeight=function(animate){var $post=this.$container.find(".crt-post-c").first(),postHeight=$post.width();postHeight+=parseInt($post.css("margin-left")),this.$feedWindow.css({overflow:"hidden"});var maxRows=Math.ceil(this.feed.postCount/this.columnCount),rows=this.rowsMax<maxRows?this.rowsMax:maxRows,scrollTopOrig=this.$scroller.scrollTop();if(this.$feedWindow.height(rows*postHeight),this.$scroller.scrollTop()>scrollTopOrig+100&&this.$scroller.scrollTop(scrollTopOrig),this.responsiveOptions.list.showLoadMore){var postsVisible=this.columnCount*rows;this.feed.allPostsLoaded&&postsVisible>=this.feed.posts.length?this.$loadMore.hide():this.$loadMore.show()}},List.prototype.checkScroll=function(){Logger.log("List->checkScroll");var top=this.$container.offset().top,feedBottom=top+this.$feedWindow.height();this.$scroller.scrollTop()+z$1(window).height()-feedBottom>this.responsiveOptions.list.continuousScrollOffset&&(this.feed.loading||this.feed.allPostsLoaded||(this.rowsMax+=this.responsiveOptions.list.rowsToAdd,this.updateLayout()))},List.prototype.onPostsLoaded=function(event,posts){var this$1=this;if(Logger.log("List->onPostsLoaded"),this.loading=!1,0!==posts.length){this.postElements=[];for(var i=0,i$1=0,list=posts;i$1<list.length;i$1+=1){var postJson=list[i$1],post=this$1.createPostElement(postJson);this$1.postElements.push(post),this$1.$feed.append(post.$el),post.layout(),this$1.responsiveOptions.animate&&(post.$el.css({opacity:0}),function(post){window.setTimeout(function(){post.$el.css({opacity:0}).animate({opacity:1})},100*i)}(post),i++)}this.popupManager.setPosts(posts),this.responsiveOptions.list.showLoadMore?this.feed.allPostsLoaded?this.$loadMore.hide():this.$loadMore.show():this.$loadMore.hide()}},List.prototype.onMoreClicked=function(ev){ev.preventDefault(),this.feed.loadMorePaginated()},List.prototype.destroy=function(){Widget$$1.prototype.destroy.call(this),this.feed.destroy(),this.destroyHandlers(),this.$container.empty().removeClass("crt-list").removeClass("crt-list-col"+this.columnCount).css({height:"",overflow:""}),delete this.$feed,delete this.$container,delete this.options,delete this.loading,delete this.feed},List}(Widget),ConfigWidgetGrid$1=z$1.extend({},ConfigWidgetBase,{templatePost:"grid-post-v2",templateFeed:"grid-feed-v2",animate:!1,grid:{minWidth:200,rows:3,showLoadMore:!1,rowsToAdd:1,continuousScroll:!1,continuousScrollOffset:50,hover:{showName:!0,showFooter:!0,showText:!0}}}),Grid=function(Widget$$1){function Grid(options){if(Widget$$1.call(this),this.loading=!1,this.feed=null,this.$container=null,this.$feed=null,this.posts=[],this.columnCount=0,this.rowsMax=0,this.totalPostsLoaded=0,this.allLoaded=!1,this.init(options,ConfigWidgetGrid$1)){Logger.log("Grid->init with options:"),Logger.log(this.options);var tmpl=Templating.renderTemplate(this.responsiveOptions.templateFeed,{});this.$container.append(tmpl),this.$feed=this.$container.find(".crt-feed"),this.$feedWindow=this.$container.find(".crt-feed-window"),this.$loadMore=this.$container.find(".crt-feed-more a"),this.$scroller=z$1(window),this.$container.addClass("crt-grid"),this.responsiveOptions.grid.showLoadMore?(this.$feedWindow.css({position:"relative"}),this.$loadMore.click(this.onMoreClicked.bind(this))):this.$loadMore.hide(),this.responsiveOptions.grid.hover.showName||this.$container.addClass("crt-grid-hide-name"),this.responsiveOptions.grid.hover.showFooter||this.$container.addClass("crt-grid-hide-footer"),this.responsiveOptions.grid.hover.showText||this.$container.addClass("crt-grid-hide-text"),this.createHandlers(),this.rowsMax=this.responsiveOptions.grid.rows,this.updateLayout()}}return Widget$$1&&(Grid.__proto__=Widget$$1),Grid.prototype=Object.create(Widget$$1&&Widget$$1.prototype),Grid.prototype.constructor=Grid,Grid.prototype.createHandlers=function(){var this$1=this,id=this.id,updateLayoutDebounced=CommonUtils.debounce(function(){this$1.updateLayout()},100);z$1(window).on("resize."+id,CommonUtils.debounce(function(){this$1.updateResponsiveOptions(),this$1.updateLayout()},100)),z$1(window).on("curatorCssLoaded."+id,updateLayoutDebounced),z$1(document).on("ready."+id,updateLayoutDebounced),this.responsiveOptions.grid.continuousScroll&&z$1(window).on("scroll."+id,CommonUtils.debounce(function(){this$1.checkScroll()},100)),this.on(Events.FILTER_CHANGED,function(){this$1.$feed.find(".crt-grid-post").remove()})},Grid.prototype.destroyHandlers=function(){var id=this.id;z$1(window).off("resize."+id),z$1(window).off("curatorCssLoaded."+id),z$1(document).off("ready."+id),z$1(window).off("scroll."+id)},Grid.prototype.loadPosts=function(){},Grid.prototype.updateLayout=function(){var cols=Math.floor(this.$container.width()/this.responsiveOptions.grid.minWidth);cols=cols<1?1:cols,this.$container.removeClass("crt-grid-col"+this.columnCount),this.columnCount=cols,this.$container.addClass("crt-grid-col"+this.columnCount);var postsNeeded=cols*(this.rowsMax+1);if(postsNeeded>this.feed.postsLoaded&&!this.feed.allPostsLoaded){var limit=postsNeeded-this.feed.postsLoaded,params={limit:limit};this.feed.loadMorePaginated(params)}else this.updateHeight(!1)},Grid.prototype.updateHeight=function(animate){var $post=this.$container.find(".crt-grid-post").first(),postHeight=$post.height();postHeight+=parseInt($post.css("margin-bottom")),this.$feedWindow.css({overflow:"hidden"});var maxRows=Math.ceil(this.feed.postCount/this.columnCount),rows=this.rowsMax<maxRows?this.rowsMax:maxRows,scrollTopOrig=this.$scroller.scrollTop();if(this.$feedWindow.height(rows*postHeight),this.$scroller.scrollTop()>scrollTopOrig+100&&this.$scroller.scrollTop(scrollTopOrig),this.responsiveOptions.grid.showLoadMore){var postsVisible=this.columnCount*rows;this.feed.allPostsLoaded&&postsVisible>=this.feed.posts.length?this.$loadMore.hide():this.$loadMore.show()}},Grid.prototype.checkScroll=function(){Logger.log("Grid->checkScroll");var top=this.$container.offset().top,feedBottom=top+this.$feedWindow.height();this.$scroller.scrollTop()+z$1(window).height()-feedBottom>this.responsiveOptions.grid.continuousScrollOffset&&(this.feed.loading||this.feed.allPostsLoaded||(this.rowsMax+=this.responsiveOptions.grid.rowsToAdd,this.updateLayout()))},Grid.prototype.onPostsLoaded=function(event,posts){var this$1=this;if(Logger.log("Grid->onPostsLoaded"),this.loading=!1,0===posts.length)this.allLoaded=!0;else{this.postElements=[];for(var i=0,i$1=0,list=posts;i$1<list.length;i$1+=1){var postJson=list[i$1],post=this$1.createPostElement(postJson);this$1.postElements.push(post),this$1.$feed.append(post.$el),post.layout(),this$1.responsiveOptions.animate&&(post.$el.css({opacity:0}),function(post){window.setTimeout(function(){post.$el.css({opacity:0}).animate({opacity:1})},100*i)}(post),i++)}this.popupManager.setPosts(posts),window.setTimeout(function(){this$1.updateHeight(!0)},10)}},Grid.prototype.onMoreClicked=function(ev){ev.preventDefault();var rowsToAdd=1;this.columnCount<=1?rowsToAdd=4:2===this.columnCount&&(rowsToAdd=2),this.rowsMax+=rowsToAdd,this.updateLayout()},Grid.prototype.destroy=function(){Widget$$1.prototype.destroy.call(this),this.feed.destroy(),this.destroyHandlers(),this.$container.empty().removeClass("crt-grid").removeClass("crt-grid-col"+this.columnCount).css({height:"",overflow:""}),delete this.$feed,delete this.$container,delete this.options,delete this.totalPostsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},Grid}(Widget),LayoutCarouselSettings={infinite:!1,speed:5e3,duration:700,minWidth:250,panesVisible:null,moveAmount:0,autoPlay:!1,useCss:!0};z$1.zepto&&(LayoutCarouselSettings.easing="ease-in-out");var LayoutCarousel=function(EventBus$$1){function LayoutCarousel(container,options){Logger.log("LayoutCarousel->construct"),EventBus$$1.call(this),this.id=CommonUtils.uId(),this.current_position=0,this.animating=!1,this.timeout=null,this.FAKE_NUM=0,this.PANES_VISIBLE=0,this.options=z$1.extend({},LayoutCarouselSettings,options),(!this.options.minWidth||this.options.minWidth<100)&&(this.options.minWidth=LayoutCarouselSettings.minWidth),this.$viewport=z$1(container),this.$panes=this.$viewport.children(),this.$panes.detach(),this.$stage=z$1('<div class="crt-carousel-stage"></div>').appendTo(this.$viewport),this.$pane_slider=z$1('<div class="crt-carousel-slider"></div>').appendTo(this.$stage),this.options.matchHeights&&this.$stage.addClass("crt-match-heights"),this.addControls(),this.createHandlers(),this.update()}return EventBus$$1&&(LayoutCarousel.__proto__=EventBus$$1),LayoutCarousel.prototype=Object.create(EventBus$$1&&EventBus$$1.prototype),LayoutCarousel.prototype.constructor=LayoutCarousel,LayoutCarousel.prototype.createHandlers=function(){var this$1=this;z$1(window).on("resize."+this.id,CommonUtils.debounce(function(){this$1.updateLayout()},100))},LayoutCarousel.prototype.destroyHandlers=function(){z$1(window).off("resize."+this.id)},LayoutCarousel.prototype.update=function(){Logger.log("LayoutCarousel->update "),this.$panes=this.$pane_slider.children(),this.NUM_PANES=this.$panes.length,this.NUM_PANES>0&&(this.resize(),this.move(this.current_position,!0),this.animating||this.options.autoPlay&&this.animate())},LayoutCarousel.prototype.add=function($els){Logger.log("LayoutCarousel->add "+$els.length),this.$pane_slider.append($els),this.$panes=this.$pane_slider.children()},LayoutCarousel.prototype.resize=function(){var this$1=this,PANE_WRAPPER_WIDTH=this.options.infinite?100*(this.NUM_PANES+1)+"%":100*this.NUM_PANES+"%";if(this.$pane_slider.css({width:PANE_WRAPPER_WIDTH}),this.VIEWPORT_WIDTH=this.$viewport.width(),Logger.log("VIEWPORT_WIDTH = "+this.VIEWPORT_WIDTH),this.options.panesVisible?(this.PANES_VISIBLE=this.options.panesVisible(),this.PANE_WIDTH=this.VIEWPORT_WIDTH/this.PANES_VISIBLE):(this.PANES_VISIBLE=this.VIEWPORT_WIDTH<this.options.minWidth?1:Math.floor(this.VIEWPORT_WIDTH/this.options.minWidth),this.PANE_WIDTH=this.VIEWPORT_WIDTH/this.PANES_VISIBLE),this.options.infinite){this.$panes.filter(".crt-clone").remove();for(var i=this.NUM_PANES-1;i>this.NUM_PANES-1-this.PANES_VISIBLE;i--){var first=this$1.$panes.eq(i).clone();first.addClass("crt-clone"),first.css("opacity","1"),first.find(".crt-post-image").css({opacity:1}),this$1.$pane_slider.prepend(first),this$1.FAKE_NUM=this$1.PANES_VISIBLE}this.$panes=this.$pane_slider.children()}this.$panes.each(function(index,pane){z$1(pane).css({width:this$1.PANE_WIDTH+"px"})})},LayoutCarousel.prototype.updateLayout=function(){this.resize(),this.move(this.current_position,!0),this.options.autoPlay&&this.animate()},LayoutCarousel.prototype.animate=function(){var this$1=this;this.animating=!0,window.clearTimeout(this.timeout),this.timeout=window.setTimeout(function(){this$1.next()},this.options.speed)},LayoutCarousel.prototype.next=function(){var move=this.options.moveAmount?this.options.moveAmount:this.PANES_VISIBLE;this.move(this.current_position+move,!1)},LayoutCarousel.prototype.prev=function(){var move=this.options.moveAmount?this.options.moveAmount:this.PANES_VISIBLE;this.move(this.current_position-move,!1)},LayoutCarousel.prototype.move=function(i,noAnimate){Logger.log("LayoutCarousel->move "+i),this.current_position=i;var maxPos=this.NUM_PANES-this.PANES_VISIBLE;this.current_position<0?this.current_position=0:this.current_position>maxPos&&(this.current_position=maxPos);var curIncFake=this.FAKE_NUM+this.current_position,left=curIncFake*this.PANE_WIDTH,max=this.options.infinite?this.PANE_WIDTH*this.NUM_PANES:this.PANE_WIDTH*this.NUM_PANES-this.VIEWPORT_WIDTH;this.currentLeft=left,this.currentLeft=left<0?0:left>max?max:left;var x=0-this.currentLeft;if(Logger.log("LayoutCarousel->move x:"+x),noAnimate)this.$pane_slider.css({transform:"translate3d("+x+"px, 0px, 0px)"}),this.moveComplete();else{var options={duration:this.options.duration,complete:this.moveComplete.bind(this)}
;this.options.easing&&(options.easing=this.options.easing),this.$pane_slider.addClass("crt-animate-transform"),this.$pane_slider.animate({transform:"translate3d("+x+"px, 0px, 0px)"},options)}},LayoutCarousel.prototype.moveComplete=function(){var this$1=this;Logger.log("LayoutCarousel->moveComplete"),this.options.infinite&&this.current_position>=this.NUM_PANES-this.PANES_VISIBLE&&(this.$pane_slider.css({transform:"translate3d(0px, 0px, 0px)"}),this.current_position=0-this.PANES_VISIBLE,this.currentLeft=0),window.setTimeout(function(){this$1.updateHeight()},50),this.trigger(Events.CAROUSEL_CHANGED,[this,this.current_position]),this.options.autoPlay&&this.animate()},LayoutCarousel.prototype.updateHeight=function(){Logger.log("LayoutCarousel->updateHeight");var min=this.options.infinite?this.current_position+this.FAKE_NUM:this.current_position,paneMaxHeight=this.getMaxHeight(min);this.$stage.height()!==paneMaxHeight&&this.$stage.animate({height:paneMaxHeight},300),this.options.matchHeights&&(this.setPaneHeights(min),this.setPaneHeights(min+this.PANES_VISIBLE))},LayoutCarousel.prototype.setPaneHeights=function(min){var this$1=this;Logger.log("LayoutCarousel->setPaneHeights "+min);var max=min+this.PANES_VISIBLE,paneMaxHeight=this.getMaxHeight(min);if(this.options.matchHeights)for(var i=min;i<max;i++){var $pane=z$1(this$1.$panes[i]);$pane.find(".crt-post-c").height(paneMaxHeight-2)}},LayoutCarousel.prototype.getMaxHeight=function(min){var this$1=this;Logger.log("LayoutCarousel->getMaxHeight "+min);for(var paneMaxHeight=0,max=min+this.PANES_VISIBLE,i=min;i<max;i++)if(this$1.$panes[i]){var $pane=z$1(this$1.$panes[i]),h=0;if($pane.hasClass("crt-post-max-height"))h=$pane.height();else{var contentHeight=$pane.find(".crt-post-content").height(),footerHeight=$pane.find(".crt-post-footer").height();h=contentHeight+footerHeight+2}h>paneMaxHeight&&(paneMaxHeight=h)}return paneMaxHeight},LayoutCarousel.prototype.addControls=function(){this.$viewport.append('<button type="button" data-role="none" class="crt-panel-prev crt-panel-arrow" aria-label="Previous" role="button" aria-disabled="false">Previous</button>'),this.$viewport.append('<button type="button" data-role="none" class="crt-panel-next crt-panel-arrow" aria-label="Next" role="button" aria-disabled="false">Next</button>'),this.$viewport.on("click",".crt-panel-prev",this.prev.bind(this)),this.$viewport.on("click",".crt-panel-next",this.next.bind(this))},LayoutCarousel.prototype.destroy=function(){this.destroyHandlers(),window.clearTimeout(this.timeout)},LayoutCarousel}(EventBus),ConfigCarousel=z$1.extend({},ConfigWidgetBase,{scroll:"more",carousel:{autoPlay:!0,autoLoad:!0,infinite:!1,matchHeights:!1}}),Carousel=function(Widget$$1){function Carousel(options){var this$1=this;Widget$$1.call(this),options.postsPerPage=30,this.loading=!1,this.posts=[],this.firstLoad=!0,this.init(options,ConfigCarousel)&&(Logger.log("Carousel->init with options:"),Logger.log(this.options),this.allLoaded=!1,this.$feed=z$1('<div class="crt-carousel-feed"></div>').appendTo(this.$container),this.$container.addClass("crt-carousel"),this.carousel=new LayoutCarousel(this.$feed,this.options.carousel),this.carousel.on(Events.CAROUSEL_CHANGED,this.onCarouselChange.bind(this)),this.on(Events.FILTER_CHANGED,function(){this$1.$feed.find(".crt-post").remove()}),this.loadPosts(0))}return Widget$$1&&(Carousel.__proto__=Widget$$1),Carousel.prototype=Object.create(Widget$$1&&Widget$$1.prototype),Carousel.prototype.constructor=Carousel,Carousel.prototype.loadMorePosts=function(){Logger.log("Carousel->loadMorePosts"),this.feed.postCount>this.feed.postsLoaded&&this.feed.loadPosts(this.feed.currentPage+1)},Carousel.prototype.onPostsLoaded=function(event,posts){if(Logger.log("Carousel->onPostsLoaded"),this.loading=!1,0===posts.length)this.allLoaded=!0;else{var that=this,$els=[];z$1(posts).each(function(i){var p=that.createPostElement(this);$els.push(p.$el),that.options.animate&&that.firstLoad&&(p.$el.css({opacity:0}),window.setTimeout(function(){p.$el.css({opacity:0}).animate({opacity:1})},100*i))}),this.carousel.add($els),this.carousel.update(),this.popupManager.setPosts(posts)}this.firstLoad=!1},Carousel.prototype.onCarouselChange=function(event,currentSlide){this.options&&this.options.carousel.autoLoad&&currentSlide>=this.feed.postsLoaded-this.carousel.PANES_VISIBLE&&this.loadMorePosts()},Carousel.prototype.destroy=function(){Widget$$1.prototype.destroy.call(this),this.feed.destroy(),this.carousel.off(Events.CAROUSEL_CHANGED,this.onCarouselChange.bind(this)),this.carousel.destroy(),this.$feed.remove(),this.$container.removeClass("crt-carousel"),delete this.$feed,delete this.$container,delete this.options,delete this.feed.postsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},Carousel}(Widget),ConfigPanel=z$1.extend({},ConfigWidgetBase,{panel:{autoPlay:!0,autoLoad:!0,moveAmount:1,fixedHeight:!1,infinite:!0,minWidth:2e3}}),Panel=function(Widget$$1){function Panel(options){Widget$$1.call(this),this.loading=!1,this.feed=null,this.$container=null,this.$feed=null,this.posts=[],this.init(options,ConfigPanel)&&(Logger.log("Panel->init with options:"),Logger.log(this.options),this.allLoaded=!1,this.$feed=z$1('<div class="crt-feed"></div>').appendTo(this.$container),this.$container.addClass("crt-carousel"),this.$container.addClass("crt-panel"),this.options.panel.fixedHeight&&this.$container.addClass("crt-panel-fixed-height"),this.carousel=new LayoutCarousel(this.$feed,this.options.panel),this.carousel.on(Events.CAROUSEL_CHANGED,this.onCarouselChange.bind(this)),this.loadPosts(0))}return Widget$$1&&(Panel.__proto__=Widget$$1),Panel.prototype=Object.create(Widget$$1&&Widget$$1.prototype),Panel.prototype.constructor=Panel,Panel.prototype.loadMorePosts=function(){Logger.log("Panel->loadMorePosts"),this.feed.loadPosts(this.feed.currentPage+1)},Panel.prototype.onPostsLoaded=function(event,posts){if(Logger.log("Panel->onPostsLoaded"),this.loading=!1,0===posts.length)this.allLoaded=!0;else{var that=this,$els=[];z$1(posts).each(function(){var p=that.createPostElement(this);$els.push(p.$el)}),this.carousel.add($els),this.carousel.update(),this.popupManager.setPosts(posts)}},Panel.prototype.onPostImageLoaded=function(){this.carousel.updateHeight()},Panel.prototype.onCarouselChange=function(event,currentSlide){this.options&&this.options.panel.autoLoad&&currentSlide>=this.feed.postsLoaded-4&&this.loadMorePosts()},Panel.prototype.destroy=function(){Widget$$1.prototype.destroy.call(this),this.feed.destroy(),this.carousel.off(Events.CAROUSEL_CHANGED,this.onCarouselChange.bind(this)),this.carousel.destroy(),this.$feed.remove(),this.$container.removeClass("crt-panel"),this.$container.removeClass("crt-carousel"),delete this.$feed,delete this.$container,delete this.options,delete this.feed.postsLoaded,delete this.loading,delete this.allLoaded,delete this.feed},Panel}(Widget),loadWidget=function(config){return new(0,Crt.Widgets[config.type])(config)},Crt={loadWidget:loadWidget,loadCSS:function(){},z:z$1,_t:function(s,n,lang){return mod.t(s,n,lang)},Templates:Templates,Templating:Templating,EventBus:EventBus,Events:Events,Logger:Logger,Globals:Globals,Ui:{Post:Post},Widgets:{Waterfall:Waterfall,Grid:Grid,Carousel:Carousel,Panel:Panel,List:List},Utils:{Html:HtmlUtils,String:StringUtils}};return Crt}()});