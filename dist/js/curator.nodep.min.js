!function(t,e){t.Curator=e(window)}(this,function(t){function e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t){return null==t?String(t):G[X.call(t)]||"object"}function e(e){return"function"==t(e)}function i(t){return null!=t&&t==t.window}function n(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function o(e){return"object"==t(e)}function s(t){return o(t)&&!i(t)&&Object.getPrototypeOf(t)==Object.prototype}function r(t){var e=!!t&&"length"in t&&t.length,n=$.type(t);return"function"!=n&&!i(t)&&("array"==n||0===e||"number"==typeof e&&e>0&&e-1 in t)}function a(t){return A.call(t,function(t){return null!=t})}function l(t){return t.length>0?$.fn.concat.apply([],t):t}function c(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function u(t){return t in M?M[t]:M[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function h(t,e){return"number"!=typeof e||I[c(t)]?e:e+"px"}function p(t){var e,i;return j[t]||(e=N.createElement(t),N.body.appendChild(e),i=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==i&&(i="block"),j[t]=i),j[t]}function d(t){return"children"in t?L.call(t.children):$.map(t.childNodes,function(t){if(1==t.nodeType)return t})}function f(t,e){var i,n=t?t.length:0;for(i=0;i<n;i++)this[i]=t[i];this.length=n,this.selector=e||""}function g(t,e,i){for(x in e)i&&(s(e[x])||K(e[x]))?(s(e[x])&&!s(t[x])&&(t[x]={}),K(e[x])&&!K(t[x])&&(t[x]=[]),g(t[x],e[x],i)):e[x]!==k&&(t[x]=e[x])}function v(t,e){return null==e?$(t):$(t).filter(e)}function m(t,i,n,o){return e(i)?i.call(t,n,o):i}function y(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function w(t,e){var i=t.className||"",n=i&&i.baseVal!==k;return e===k?n?i.baseVal:i:void(n?i.baseVal=e:t.className=e)}function b(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?$.parseJSON(t):t):t}catch(e){return t}}function P(t,e){e(t);for(var i=0,n=t.childNodes.length;i<n;i++)P(t.childNodes[i],e)}var k,x,$,C,_,T,E=[],S=E.concat,A=E.filter,L=E.slice,N=window.document,j={},M={},I={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},O=/^\s*<(\w+|!)[^>]*>/,D=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,F=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,U=/^(?:body|html)$/i,H=/([A-Z])/g,R=["val","css","html","text","data","width","height","offset"],z=["after","prepend","before","append"],W=N.createElement("table"),B=N.createElement("tr"),V={tr:N.createElement("tbody"),tbody:W,thead:W,tfoot:W,td:B,th:B,"*":N.createElement("div")},Z=/complete|loaded|interactive/,q=/^[\w-]*$/,G={},X=G.toString,J={},Y=N.createElement("div"),Q={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},K=Array.isArray||function(t){return t instanceof Array};return J.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var i=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(i)return i.call(t,e);var n,o=t.parentNode,s=!o;return s&&(o=Y).appendChild(t),n=~J.qsa(o,e).indexOf(t),s&&Y.removeChild(t),n},_=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},T=function(t){return A.call(t,function(e,i){return t.indexOf(e)==i})},J.fragment=function(t,e,i){var n,o,r;return D.test(t)&&(n=$(N.createElement(RegExp.$1))),n||(t.replace&&(t=t.replace(F,"<$1></$2>")),e===k&&(e=O.test(t)&&RegExp.$1),e in V||(e="*"),r=V[e],r.innerHTML=""+t,n=$.each(L.call(r.childNodes),function(){r.removeChild(this)})),s(i)&&(o=$(n),$.each(i,function(t,e){R.indexOf(t)>-1?o[t](e):o.attr(t,e)})),n},J.Z=function(t,e){return new f(t,e)},J.isZ=function(t){return t instanceof J.Z},J.init=function(t,i){var n;if(!t)return J.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&O.test(t))n=J.fragment(t,RegExp.$1,i),t=null;else{if(i!==k)return $(i).find(t);n=J.qsa(N,t)}else{if(e(t))return $(N).ready(t);if(J.isZ(t))return t;if(K(t))n=a(t);else if(o(t))n=[t],t=null;else if(O.test(t))n=J.fragment(t.trim(),RegExp.$1,i),t=null;else{if(i!==k)return $(i).find(t);n=J.qsa(N,t)}}return J.Z(n,t)},$=function(t,e){return J.init(t,e)},$.extend=function(t){var e,i=L.call(arguments,1);return"boolean"==typeof t&&(e=t,t=i.shift()),i.forEach(function(i){g(t,i,e)}),t},J.qsa=function(t,e){var i,n="#"==e[0],o=!n&&"."==e[0],s=n||o?e.slice(1):e,r=q.test(s);return t.getElementById&&r&&n?(i=t.getElementById(s))?[i]:[]:1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType?[]:L.call(r&&!n&&t.getElementsByClassName?o?t.getElementsByClassName(s):t.getElementsByTagName(e):t.querySelectorAll(e))},$.contains=N.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},$.type=t,$.isFunction=e,$.isWindow=i,$.isArray=K,$.isPlainObject=s,$.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},$.isNumeric=function(t){var e=Number(t),i=typeof t;return null!=t&&"boolean"!=i&&("string"!=i||t.length)&&!isNaN(e)&&isFinite(e)||!1},$.inArray=function(t,e,i){return E.indexOf.call(e,t,i)},$.camelCase=_,$.trim=function(t){return null==t?"":String.prototype.trim.call(t)},$.uuid=0,$.support={},$.expr={},$.noop=function(){},$.map=function(t,e){var i,n,o,s=[];if(r(t))for(n=0;n<t.length;n++)i=e(t[n],n),null!=i&&s.push(i);else for(o in t)i=e(t[o],o),null!=i&&s.push(i);return l(s)},$.each=function(t,e){var i,n;if(r(t)){for(i=0;i<t.length;i++)if(e.call(t[i],i,t[i])===!1)return t}else for(n in t)if(e.call(t[n],n,t[n])===!1)return t;return t},$.grep=function(t,e){return A.call(t,e)},window.JSON&&($.parseJSON=JSON.parse),$.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){G["[object "+e+"]"]=e.toLowerCase()}),$.fn={constructor:J.Z,length:0,forEach:E.forEach,reduce:E.reduce,push:E.push,sort:E.sort,splice:E.splice,indexOf:E.indexOf,concat:function(){var t,e,i=[];for(t=0;t<arguments.length;t++)e=arguments[t],i[t]=J.isZ(e)?e.toArray():e;return S.apply(J.isZ(this)?this.toArray():this,i)},map:function(t){return $($.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return $(L.apply(this,arguments))},ready:function(t){return Z.test(N.readyState)&&N.body?t($):N.addEventListener("DOMContentLoaded",function(){t($)},!1),this},get:function(t){return t===k?L.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return E.every.call(this,function(e,i){return t.call(e,i,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):$(A.call(this,function(e){return J.matches(e,t)}))},add:function(t,e){return $(T(this.concat($(t,e))))},is:function(t){return this.length>0&&J.matches(this[0],t)},not:function(t){var i=[];if(e(t)&&t.call!==k)this.each(function(e){t.call(this,e)||i.push(this)});else{var n="string"==typeof t?this.filter(t):r(t)&&e(t.item)?L.call(t):$(t);this.forEach(function(t){n.indexOf(t)<0&&i.push(t)})}return $(i)},has:function(t){return this.filter(function(){return o(t)?$.contains(this,t):$(this).find(t).size()})},eq:function(t){return t===-1?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!o(t)?t:$(t)},last:function(){var t=this[this.length-1];return t&&!o(t)?t:$(t)},find:function(t){var e,i=this;return e=t?"object"==typeof t?$(t).filter(function(){var t=this;return E.some.call(i,function(e){return $.contains(e,t)})}):1==this.length?$(J.qsa(this[0],t)):this.map(function(){return J.qsa(this,t)}):$()},closest:function(t,e){var i=[],o="object"==typeof t&&$(t);return this.each(function(s,r){for(;r&&!(o?o.indexOf(r)>=0:J.matches(r,t));)r=r!==e&&!n(r)&&r.parentNode;r&&i.indexOf(r)<0&&i.push(r)}),$(i)},parents:function(t){for(var e=[],i=this;i.length>0;)i=$.map(i,function(t){if((t=t.parentNode)&&!n(t)&&e.indexOf(t)<0)return e.push(t),t});return v(e,t)},parent:function(t){return v(T(this.pluck("parentNode")),t)},children:function(t){return v(this.map(function(){return d(this)}),t)},contents:function(){return this.map(function(){return this.contentDocument||L.call(this.childNodes)})},siblings:function(t){return v(this.map(function(t,e){return A.call(d(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return $.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var i=e(t);if(this[0]&&!i)var n=$(t).get(0),o=n.parentNode||this.length>1;return this.each(function(e){$(this).wrapAll(i?t.call(this,e):o?n.cloneNode(!0):n)})},wrapAll:function(t){if(this[0]){$(this[0]).before(t=$(t));for(var e;(e=t.children()).length;)t=e.first();$(t).append(this)}return this},wrapInner:function(t){var i=e(t);return this.each(function(e){var n=$(this),o=n.contents(),s=i?t.call(this,e):t;o.length?o.wrapAll(s):n.append(s)})},unwrap:function(){return this.parent().each(function(){$(this).replaceWith($(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=$(this);(t===k?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return $(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return $(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var i=this.innerHTML;$(this).empty().append(m(this,t,e,i))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var i=m(this,t,e,this.textContent);this.textContent=null==i?"":""+i}):0 in this?this.pluck("textContent").join(""):null},attr:function(t,e){var i;return"string"!=typeof t||1 in arguments?this.each(function(i){if(1===this.nodeType)if(o(t))for(x in t)y(this,x,t[x]);else y(this,t,m(this,e,i,this.getAttribute(t)))}):0 in this&&1==this[0].nodeType&&null!=(i=this[0].getAttribute(t))?i:k},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){y(this,t)},this)})},prop:function(t,e){return t=Q[t]||t,1 in arguments?this.each(function(i){this[t]=m(this,e,i,this[t])}):this[0]&&this[0][t]},removeProp:function(t){return t=Q[t]||t,this.each(function(){delete this[t]})},data:function(t,e){var i="data-"+t.replace(H,"-$1").toLowerCase(),n=1 in arguments?this.attr(i,e):this.attr(i);return null!==n?b(n):k},val:function(t){return 0 in arguments?(null==t&&(t=""),this.each(function(e){this.value=m(this,t,e,this.value)})):this[0]&&(this[0].multiple?$(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var i=$(this),n=m(this,t,e,i.offset()),o=i.offsetParent().offset(),s={top:n.top-o.top,left:n.left-o.left};"static"==i.css("position")&&(s.position="relative"),i.css(s)});if(!this.length)return null;if(N.documentElement!==this[0]&&!$.contains(N.documentElement,this[0]))return{top:0,left:0};var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,i){if(arguments.length<2){var n=this[0];if("string"==typeof e){if(!n)return;return n.style[_(e)]||getComputedStyle(n,"").getPropertyValue(e)}if(K(e)){if(!n)return;var o={},s=getComputedStyle(n,"");return $.each(e,function(t,e){o[e]=n.style[_(e)]||s.getPropertyValue(e)}),o}}var r="";if("string"==t(e))i||0===i?r=c(e)+":"+h(e,i):this.each(function(){this.style.removeProperty(c(e))});else for(x in e)e[x]||0===e[x]?r+=c(x)+":"+h(x,e[x])+";":this.each(function(){this.style.removeProperty(c(x))});return this.each(function(){this.style.cssText+=";"+r})},index:function(t){return t?this.indexOf($(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return!!t&&E.some.call(this,function(t){return this.test(w(t))},u(t))},addClass:function(t){return t?this.each(function(e){if("className"in this){C=[];var i=w(this),n=m(this,t,e,i);n.split(/\s+/g).forEach(function(t){$(this).hasClass(t)||C.push(t)},this),C.length&&w(this,i+(i?" ":"")+C.join(" "))}}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===k)return w(this,"");C=w(this),m(this,t,e,C).split(/\s+/g).forEach(function(t){C=C.replace(u(t)," ")}),w(this,C.trim())}})},toggleClass:function(t,e){return t?this.each(function(i){var n=$(this),o=m(this,t,i,w(this));o.split(/\s+/g).forEach(function(t){(e===k?!n.hasClass(t):e)?n.addClass(t):n.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===k?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===k?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),i=this.offset(),n=U.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat($(t).css("margin-top"))||0,i.left-=parseFloat($(t).css("margin-left"))||0,n.top+=parseFloat($(e[0]).css("border-top-width"))||0,n.left+=parseFloat($(e[0]).css("border-left-width"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||N.body;t&&!U.test(t.nodeName)&&"static"==$(t).css("position");)t=t.offsetParent;return t})}},$.fn.detach=$.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});$.fn[t]=function(o){var s,r=this[0];return o===k?i(r)?r["inner"+e]:n(r)?r.documentElement["scroll"+e]:(s=this.offset())&&s[t]:this.each(function(e){r=$(this),r.css(t,m(this,o,e,r[t]()))})}}),z.forEach(function(e,i){var n=i%2;$.fn[e]=function(){var e,o,s=$.map(arguments,function(i){var n=[];return e=t(i),"array"==e?(i.forEach(function(t){return t.nodeType!==k?n.push(t):$.zepto.isZ(t)?n=n.concat(t.get()):void(n=n.concat(J.fragment(t)))}),n):"object"==e||null==i?i:J.fragment(i)}),r=this.length>1;return s.length<1?this:this.each(function(t,e){o=n?e:e.parentNode,e=0==i?e.nextSibling:1==i?e.firstChild:2==i?e:null;var a=$.contains(N.documentElement,o);s.forEach(function(t){if(r)t=t.cloneNode(!0);else if(!o)return $(t).remove();o.insertBefore(t,e),a&&P(t,function(t){if(!(null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src)){var e=t.ownerDocument?t.ownerDocument.defaultView:window;e.eval.call(e,t.innerHTML)}})})})},$.fn[n?e+"To":"insert"+(i?"Before":"After")]=function(t){return $(t)[e](this),this}}),J.Z.prototype=f.prototype=$.fn,J.uniq=T,J.deserializeValue=b,$.zepto=J,$}();!function(t){function e(t){return t._zid||(t._zid=p++)}function i(t,i,s,r){if(i=n(i),i.ns)var a=o(i.ns);return(v[e(t)]||[]).filter(function(t){return t&&(!i.e||t.e==i.e)&&(!i.ns||a.test(t.ns))&&(!s||e(t.fn)===e(s))&&(!r||t.sel==r)})}function n(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function o(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function s(t,e){return t.del&&!y&&t.e in w||!!e}function r(t){return b[t]||y&&w[t]||t}function a(i,o,a,l,u,p,d){var f=e(i),g=v[f]||(v[f]=[]);o.split(/\s/).forEach(function(e){if("ready"==e)return t(document).ready(a);var o=n(e);o.fn=a,o.sel=u,o.e in b&&(a=function(e){var i=e.relatedTarget;if(!i||i!==this&&!t.contains(this,i))return o.fn.apply(this,arguments)}),o.del=p;var f=p||a;o.proxy=function(t){if(t=c(t),!t.isImmediatePropagationStopped()){t.data=l;var e=f.apply(i,t._args==h?[t]:[t].concat(t._args));return e===!1&&(t.preventDefault(),t.stopPropagation()),e}},o.i=g.length,g.push(o),"addEventListener"in i&&i.addEventListener(r(o.e),o.proxy,s(o,d))})}function l(t,n,o,a,l){var c=e(t);(n||"").split(/\s/).forEach(function(e){i(t,e,o,a).forEach(function(e){delete v[c][e.i],"removeEventListener"in t&&t.removeEventListener(r(e.e),e.proxy,s(e,l))})})}function c(e,i){return!i&&e.isDefaultPrevented||(i||(i=e),t.each($,function(t,n){var o=i[t];e[t]=function(){return this[n]=P,o&&o.apply(i,arguments)},e[n]=k}),e.timeStamp||(e.timeStamp=Date.now()),(i.defaultPrevented!==h?i.defaultPrevented:"returnValue"in i?i.returnValue===!1:i.getPreventDefault&&i.getPreventDefault())&&(e.isDefaultPrevented=P)),e}function u(t){var e,i={originalEvent:t};for(e in t)x.test(e)||t[e]===h||(i[e]=t[e]);return c(i,t)}var h,p=1,d=Array.prototype.slice,f=t.isFunction,g=function(t){return"string"==typeof t},v={},m={},y="onfocusin"in window,w={focus:"focusin",blur:"focusout"},b={mouseenter:"mouseover",mouseleave:"mouseout"};m.click=m.mousedown=m.mouseup=m.mousemove="MouseEvents",t.event={add:a,remove:l},t.proxy=function(i,n){var o=2 in arguments&&d.call(arguments,2);if(f(i)){var s=function(){return i.apply(n,o?o.concat(d.call(arguments)):arguments)};return s._zid=e(i),s}if(g(n))return o?(o.unshift(i[n],i),t.proxy.apply(null,o)):t.proxy(i[n],i);throw new TypeError("expected function")},t.fn.bind=function(t,e,i){return this.on(t,e,i)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,i,n){return this.on(t,e,i,n,1)};var P=function(){return!0},k=function(){return!1},x=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,$={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,i){return this.on(e,t,i)},t.fn.undelegate=function(t,e,i){return this.off(e,t,i)},t.fn.live=function(e,i){return t(document.body).delegate(this.selector,e,i),this},t.fn.die=function(e,i){return t(document.body).undelegate(this.selector,e,i),this},t.fn.on=function(e,i,n,o,s){var r,c,p=this;return e&&!g(e)?(t.each(e,function(t,e){p.on(t,i,n,e,s)}),p):(g(i)||f(o)||o===!1||(o=n,n=i,i=h),o!==h&&n!==!1||(o=n,n=h),o===!1&&(o=k),p.each(function(h,p){s&&(r=function(t){return l(p,t.type,o),o.apply(this,arguments)}),i&&(c=function(e){var n,s=t(e.target).closest(i,p).get(0);if(s&&s!==p)return n=t.extend(u(e),{currentTarget:s,liveFired:p}),(r||o).apply(s,[n].concat(d.call(arguments,1)))}),a(p,e,o,n,i,c||r)}))},t.fn.off=function(e,i,n){var o=this;return e&&!g(e)?(t.each(e,function(t,e){o.off(t,i,e)}),o):(g(i)||f(n)||n===!1||(n=i,i=h),n===!1&&(n=k),o.each(function(){l(this,e,n,i)}))},t.fn.trigger=function(e,i){return e=g(e)||t.isPlainObject(e)?t.Event(e):c(e),e._args=i,this.each(function(){e.type in w&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,i)})},t.fn.triggerHandler=function(e,n){var o,s;return this.each(function(r,a){o=u(g(e)?t.Event(e):e),o._args=n,o.target=a,t.each(i(a,e.type||e),function(t,e){if(s=e.proxy(o),o.isImmediatePropagationStopped())return!1})}),s},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),t.Event=function(t,e){g(t)||(e=t,t=e.type);var i=document.createEvent(m[t]||"Events"),n=!0;if(e)for(var o in e)"bubbles"==o?n=!!e[o]:i[o]=e[o];return i.initEvent(t,n,!0),c(i)}}(o),function(t){function e(e,i,n){var o=t.Event(i);return t(e).trigger(o,n),!o.isDefaultPrevented()}function i(t,i,n,o){if(t.global)return e(i||w,n,o)}function n(e){e.global&&0===t.active++&&i(e,null,"ajaxStart")}function o(e){e.global&&!--t.active&&i(e,null,"ajaxStop")}function s(t,e){var n=e.context;return e.beforeSend.call(n,t,e)!==!1&&i(e,n,"ajaxBeforeSend",[t,e])!==!1&&void i(e,n,"ajaxSend",[t,e])}function r(t,e,n,o){var s=n.context,r="success";n.success.call(s,t,r,e),o&&o.resolveWith(s,[t,r,e]),i(n,s,"ajaxSuccess",[e,n,t]),l(r,e,n)}function a(t,e,n,o,s){var r=o.context;o.error.call(r,n,e,t),s&&s.rejectWith(r,[n,e,t]),i(o,r,"ajaxError",[n,o,t||e]),l(e,n,o)}function l(t,e,n){var s=n.context;n.complete.call(s,e,t),i(n,s,"ajaxComplete",[e,n]),o(n)}function c(t,e,i){if(i.dataFilter==u)return t;var n=i.context;return i.dataFilter.call(n,t,e)}function u(){}function h(t){return t&&(t=t.split(";",2)[0]),t&&(t==$?"html":t==x?"json":P.test(t)?"script":k.test(t)&&"xml")||"text"}function p(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function d(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()&&"jsonp"!=e.dataType||(e.url=p(e.url,e.data),e.data=void 0)}function f(e,i,n,o){return t.isFunction(i)&&(o=n,n=i,i=void 0),t.isFunction(n)||(o=n,n=void 0),{url:e,data:i,success:n,dataType:o}}function g(e,i,n,o){var s,r=t.isArray(i),a=t.isPlainObject(i);t.each(i,function(i,l){s=t.type(l),o&&(i=n?o:o+"["+(a||"object"==s||"array"==s?i:"")+"]"),!o&&r?e.add(l.name,l.value):"array"==s||!n&&"object"==s?g(e,l,n,i):e.add(i,l)})}var v,m,y=+new Date,w=window.document,b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,P=/^(?:text|application)\/javascript/i,k=/^(?:text|application)\/xml/i,x="application/json",$="text/html",C=/^\s*$/,_=w.createElement("a");_.href=window.location.href,t.active=0,t.ajaxJSONP=function(e,i){if(!("type"in e))return t.ajax(e);var n,o,l=e.jsonpCallback,c=(t.isFunction(l)?l():l)||"Zepto"+y++,u=w.createElement("script"),h=window[c],p=function(e){t(u).triggerHandler("error",e||"abort")},d={abort:p};return i&&i.promise(d),t(u).on("load error",function(s,l){clearTimeout(o),t(u).off().remove(),"error"!=s.type&&n?r(n[0],d,e,i):a(null,l||"error",d,e,i),window[c]=h,n&&t.isFunction(h)&&h(n[0]),h=n=void 0}),s(d,e)===!1?(p("abort"),d):(window[c]=function(){n=arguments},u.src=e.url.replace(/\?(.+)=\?/,"?$1="+c),w.head.appendChild(u),e.timeout>0&&(o=setTimeout(function(){p("timeout")},e.timeout)),d)},t.ajaxSettings={type:"GET",beforeSend:u,success:u,error:u,complete:u,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:x,xml:"application/xml, text/xml",html:$,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:u},t.ajax=function(e){var i,o,l=t.extend({},e||{}),f=t.Deferred&&t.Deferred();for(v in t.ajaxSettings)void 0===l[v]&&(l[v]=t.ajaxSettings[v]);n(l),l.crossDomain||(i=w.createElement("a"),i.href=l.url,i.href=i.href,l.crossDomain=_.protocol+"//"+_.host!=i.protocol+"//"+i.host),l.url||(l.url=window.location.toString()),(o=l.url.indexOf("#"))>-1&&(l.url=l.url.slice(0,o)),d(l);var g=l.dataType,y=/\?.+=\?/.test(l.url);if(y&&(g="jsonp"),l.cache!==!1&&(e&&e.cache===!0||"script"!=g&&"jsonp"!=g)||(l.url=p(l.url,"_="+Date.now())),"jsonp"==g)return y||(l.url=p(l.url,l.jsonp?l.jsonp+"=?":l.jsonp===!1?"":"callback=?")),t.ajaxJSONP(l,f);var b,P=l.accepts[g],k={},x=function(t,e){k[t.toLowerCase()]=[t,e]},$=/^([\w-]+:)\/\//.test(l.url)?RegExp.$1:window.location.protocol,T=l.xhr(),E=T.setRequestHeader;if(f&&f.promise(T),l.crossDomain||x("X-Requested-With","XMLHttpRequest"),x("Accept",P||"*/*"),(P=l.mimeType||P)&&(P.indexOf(",")>-1&&(P=P.split(",",2)[0]),T.overrideMimeType&&T.overrideMimeType(P)),(l.contentType||l.contentType!==!1&&l.data&&"GET"!=l.type.toUpperCase())&&x("Content-Type",l.contentType||"application/x-www-form-urlencoded"),l.headers)for(m in l.headers)x(m,l.headers[m]);if(T.setRequestHeader=x,T.onreadystatechange=function(){if(4==T.readyState){T.onreadystatechange=u,clearTimeout(b);var e,i=!1;if(T.status>=200&&T.status<300||304==T.status||0==T.status&&"file:"==$){if(g=g||h(l.mimeType||T.getResponseHeader("content-type")),"arraybuffer"==T.responseType||"blob"==T.responseType)e=T.response;else{e=T.responseText;try{e=c(e,g,l),"script"==g?(0,eval)(e):"xml"==g?e=T.responseXML:"json"==g&&(e=C.test(e)?null:t.parseJSON(e))}catch(t){i=t}if(i)return a(i,"parsererror",T,l,f)}r(e,T,l,f)}else a(T.statusText||null,T.status?"error":"abort",T,l,f)}},s(T,l)===!1)return T.abort(),a(null,"abort",T,l,f),T;var S=!("async"in l)||l.async;if(T.open(l.type,l.url,S,l.username,l.password),l.xhrFields)for(m in l.xhrFields)T[m]=l.xhrFields[m];for(m in k)E.apply(T,k[m]);return l.timeout>0&&(b=setTimeout(function(){T.onreadystatechange=u,T.abort(),a(null,"timeout",T,l,f)},l.timeout)),T.send(l.data?l.data:null),T},t.get=function(){return t.ajax(f.apply(null,arguments))},t.post=function(){var e=f.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=f.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,i,n){if(!this.length)return this;var o,s=this,r=e.split(/\s/),a=f(e,i,n),l=a.success;return r.length>1&&(a.url=r[0],o=r[1]),a.success=function(e){s.html(o?t("<div>").html(e.replace(b,"")).find(o):e),l&&l.apply(s,arguments)},t.ajax(a),this};var T=encodeURIComponent;t.param=function(e,i){var n=[];return n.add=function(e,i){t.isFunction(i)&&(i=i()),null==i&&(i=""),this.push(T(e)+"="+T(i))},g(n,e,i),n.join("&").replace(/%20/g,"+")}}(o),function(t){t.fn.serializeArray=function(){var e,i,n=[],o=function(t){return t.forEach?t.forEach(o):void n.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(n,s){i=s.type,e=s.name,e&&"fieldset"!=s.nodeName.toLowerCase()&&!s.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||s.checked)&&o(t(s).val())}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var i=t.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(o),function(){try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(e,i){try{return t(e,i)}catch(t){return null}}}}(),window.Zepto=o;var s=window.Zepto;!function(t,e){function i(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function n(t){return o?o+t:t.toLowerCase()}var o,s,r,a,l,c,u,h,p,d,f="",g={Webkit:"webkit",Moz:"",O:"o"},v=document.createElement("div"),m=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,y={};v.style.transform===e&&t.each(g,function(t,i){if(v.style[t+"TransitionProperty"]!==e)return f="-"+t.toLowerCase()+"-",o=i,!1}),s=f+"transform",y[r=f+"transition-property"]=y[a=f+"transition-duration"]=y[c=f+"transition-delay"]=y[l=f+"transition-timing-function"]=y[u=f+"animation-name"]=y[h=f+"animation-duration"]=y[d=f+"animation-delay"]=y[p=f+"animation-timing-function"]="",t.fx={off:o===e&&v.style.transitionProperty===e,speeds:{_default:400,fast:200,slow:600},cssPrefix:f,transitionEnd:n("TransitionEnd"),animationEnd:n("AnimationEnd")},t.fn.animate=function(i,n,o,s,r){return t.isFunction(n)&&(s=n,o=e,n=e),t.isFunction(o)&&(s=o,o=e),t.isPlainObject(n)&&(o=n.easing,s=n.complete,r=n.delay,n=n.duration),n&&(n=("number"==typeof n?n:t.fx.speeds[n]||t.fx.speeds._default)/1e3),r&&(r=parseFloat(r)/1e3),this.anim(i,n,o,s,r)},t.fn.anim=function(n,o,f,g,v){var w,b,P,k={},x="",$=this,C=t.fx.transitionEnd,_=!1;if(o===e&&(o=t.fx.speeds._default/1e3),v===e&&(v=0),t.fx.off&&(o=0),"string"==typeof n)k[u]=n,k[h]=o+"s",k[d]=v+"s",k[p]=f||"linear",C=t.fx.animationEnd;else{b=[];for(w in n)m.test(w)?x+=w+"("+n[w]+") ":(k[w]=n[w],b.push(i(w)));x&&(k[s]=x,b.push(s)),o>0&&"object"==typeof n&&(k[r]=b.join(", "),k[a]=o+"s",k[c]=v+"s",k[l]=f||"linear")}return P=function(e){if("undefined"!=typeof e){if(e.target!==e.currentTarget)return;t(e.target).unbind(C,P)}else t(this).unbind(C,P);_=!0,t(this).css(y),g&&g.call(this)},o>0&&(this.bind(C,P),setTimeout(function(){_||P.call($)},1e3*(o+v)+25)),this.size()&&this.get(0).clientLeft,this.css(k),o<=0&&setTimeout(function(){$.each(function(){P.call(this)})},0),this},v=null}(o),function(t,e){t.makeArray=function(t,e){return t=Array.prototype.slice.call(t),e?(e.push.apply(e,t),e):t},t.cache={},t.noData={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},t.acceptData=function(e){if(e.nodeName){var i=t.noData[e.nodeName.toLowerCase()];if(i)return!(i===!0||e.getAttribute("classid")!==i)}return!0},t.data=function(i,n,o,s){if(t.acceptData(i)){var r,a,l,c=t.expando,u="string"==typeof n,h=i.nodeType,p=h?t.cache:i,d=h?i[c]:i[c]&&c,f="events"===n;if(d&&p[d]&&(f||s||p[d].data)||!u||o!==e)return d||(h?i[c]=d=++t.uuid:d=c),p[d]||(p[d]={},h||(p[d].toJSON=t.noop)),"object"!=typeof n&&"function"!=typeof n||(s?p[d]=t.extend(p[d],n):p[d].data=t.extend(p[d].data,n)),r=a=p[d],s||(a.data||(a.data={}),a=a.data),o!==e&&(a[t.camelCase(n)]=o),f&&!a[n]?r.events:(u?(l=a[n],null==l&&(l=a[t.camelCase(n)])):l=a,l)}}}(o),function(t,e){function i(i,n,o,s,r){"function"!=typeof n||r||(r=n,n=e);var a={opacity:o};return s&&(a.scale=s,i.css(t.fx.cssPrefix+"transform-origin","0 0")),i.animate(a,n,null,r)}function n(e,n,o,s){return i(e,n,0,o,function(){r.call(t(this)),s&&s.call(this)})}var o=window.document,s=(o.documentElement,t.fn.show),r=t.fn.hide,a=t.fn.toggle;t.fn.show=function(t,n){return s.call(this),t===e?t=0:this.css("opacity",0),i(this,t,1,"1,1",n)},t.fn.hide=function(t,i){return t===e?r.call(this):n(this,t,"0,0",i)},t.fn.toggle=function(i,n){return i===e||"boolean"==typeof i?a.call(this,i):this.each(function(){var e=t(this);e["none"==e.css("display")?"show":"hide"](i,n)})},t.fn.fadeTo=function(t,e,n){return i(this,t,e,null,n)},t.fn.fadeIn=function(t,e){var i=this.css("opacity");return i>0?this.css("opacity",0):i=1,s.call(this).fadeTo(t,i,e)},t.fn.fadeOut=function(t,e){return n(this,t,null,e)},t.fn.fadeToggle=function(e,i){return this.each(function(){var n=t(this);n[0==n.css("opacity")||"none"==n.css("display")?"fadeIn":"fadeOut"](e,i)})}}(o);var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function(t,e){var i=function(t,e,i){var n;return function(){function o(){i||t.apply(s,r),n=null}var s=this,r=arguments;n?clearTimeout(n):i&&t.apply(s,r),n=setTimeout(o,e||150)}};t.fn[e]=function(t){return t?this.bind("resize",i(t)):this.trigger(e)}}(s,"smartresize"),function(t){var e={selector:".item",width:225,gutter:20,animate:!1,animationOptions:{speed:200,duration:300,effect:"fadeInOnAppear",queue:!0,complete:function(){}}},i=function(){function i(e,o){n(this,i),this.element=t(o),this._init(e)}return a(i,[{key:"_init",value:function(i){var n=this;this.name=this._setName(5),this.gridArr=[],this.gridArrAppend=[],this.gridArrPrepend=[],this.setArr=!1,this.setGrid=!1,this.cols=0,this.itemCount=0,this.isPrepending=!1,this.appendCount=0,this.resetCount=!0,this.ifCallback=!0,this.box=this.element,this.boxWidth=this.box.width(),this.options=t.extend(!0,{},e,i),this.gridArr=t.makeArray(this.box.find(this.options.selector)),
this.isResizing=!1,this.w=0,this.boxArr=[],this._setCols(),this._renderGrid("append"),t(this.box).addClass("gridalicious"),t(window).smartresize(function(){n.resize()})}},{key:"_setName",value:function(t,e){return e=e?e:"",t?this._setName(--t,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(60*Math.random()))+e):e}},{key:"_setCols",value:function(){this.cols=Math.floor(this.box.width()/this.options.width),this.cols<1&&(this.cols=1),diff=(this.box.width()-this.cols*this.options.width-this.options.gutter)/this.cols,w=(this.options.width+diff)/this.box.width()*100,this.w=w,this.colHeights=new Array(this.cols),this.colHeights.fill(0),this.colItems=new Array(this.cols),this.colItems.fill([]);for(var e=0;e<this.cols;e++){var i=t("<div></div>").addClass("galcolumn").attr("id","item"+e+this.name).css({width:w+"%",paddingLeft:this.options.gutter,paddingBottom:this.options.gutter,float:"left","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","-o-box-sizing":"border-box","box-sizing":"border-box"});this.box.append(i)}}},{key:"_renderGrid",value:function(e,i,n,o){var s=[],r=[],a=0,l=this.appendCount,c=(this.options.gutter,this.cols),u=this.name;t(".galcolumn").width();i?(r=i,"append"==e&&(l+=n,a=this.appendCount),"prepend"==e&&(this.isPrepending=!0,a=Math.round(n%c),a<=0&&(a=c)),"renderAfterPrepend"==e&&(l+=n,a=n)):(r=this.gridArr,l=t(this.gridArr).size());var h=!0,p=!1,d=void 0;try{for(var f,g=r[Symbol.iterator]();!(h=(f=g.next()).done);h=!0){var v=f.value,m="100%";v.hasClass("not-responsive")&&(m="auto"),v.css({zoom:"1",filter:"alpha(opacity=0)",opacity:"0"});for(var y=0,w=1;w<this.colHeights.length;w++)this.colHeights[w]<this.colHeights[y]&&(y=w);"prepend"==e?(t("#item"+y+u).prepend(v),s.push(v)):(t("#item"+y+u).append(v),s.push(v),l>=c&&(l-=c)),this.colItems[y].push(v),this.colHeights[y]+=v.height()}}catch(t){p=!0,d=t}finally{try{!h&&g.return&&g.return()}finally{if(p)throw d}}this.appendCount=l,"append"==e||"prepend"==e?("prepend"==e&&this._updateAfterPrepend(this.gridArr,r),this._renderItem(s),this.isPrepending=!1):this._renderItem(this.gridArr)}},{key:"_collectItems",value:function(){var e=[];return t(this.box).find(this.options.selector).each(function(i){e.push(t(this))}),e}},{key:"_renderItem",value:function(e){var i=this.options.animationOptions.speed,n=this.options.animationOptions.effect,o=this.options.animationOptions.duration,s=this.options.animationOptions.queue,r=this.options.animate,a=this.options.animationOptions.complete,l=0,c=0;r!==!0||this.isResizing?(t.each(e,function(e,i){t(i).css({opacity:"1",filter:"alpha(opacity=100)"})}),this.ifCallback&&a.call(e)):(s===!0&&"fadeInOnAppear"==n?(this.isPrepending&&e.reverse(),t.each(e,function(n,s){setTimeout(function(){t(s).animate({opacity:"1.0"},o),c++,c==e.length&&a.call(void 0,e)},l*i),l++})):s===!1&&"fadeInOnAppear"==n&&(this.isPrepending&&e.reverse(),t.each(e,function(i,n){t(n).animate({opacity:"1.0"},o),c++,c==e.length&&this.ifCallback&&a.call(void 0,e)})),s!==!0||n||t.each(e,function(i,n){t(n).css({opacity:"1",filter:"alpha(opacity=100)"}),c++,c==e.length&&this.ifCallback&&a.call(void 0,e)}))}},{key:"_updateAfterPrepend",value:function(e,i){var n=this.gridArr;t.each(i,function(t,e){n.unshift(e)}),this.gridArr=n}},{key:"resize",value:function(){if(this.box.width()!==this.boxWidth){var e=Math.floor(this.box.width()/this.options.width);this.cols!==e&&(this.box.find(t(".galcolumn")).remove(),this._setCols(),this.ifCallback=!1,this.isResizing=!0,this._renderGrid("append"),this.ifCallback=!0,this.isResizing=!1,this.boxWidth=this.box.width())}}},{key:"append",value:function(e){var i=this.gridArr,n=this.gridArrPrepend;t.each(e,function(t,e){i.push(e),n.push(e)}),this._renderGrid("append",e,t(e).size())}},{key:"prepend",value:function(e){this.ifCallback=!1,this._renderGrid("prepend",e,t(e).size()),this.ifCallback=!0}}]),i}();t.fn.waterfall=function(e,n){return"string"==typeof e?this.each(function(){var i=t.data(this,"WaterfallRender");i[e].apply(i,[n])}):this.each(function(){t.data(this,"WaterfallRender",new i(e,this))}),this}}(s);var l=function(){},c=Array.prototype.slice,u=function(t,e){var i=l.prototype="function"==typeof t?t.prototype:t,n=new l,o=e.apply(n,c.call(arguments,2).concat(i));if("object"===("undefined"==typeof o?"undefined":r(o)))for(var s in o)n[s]=o[s];if(!n.hasOwnProperty("constructor"))return n;var a=n.constructor;return a.prototype=n,a};if(u.defclass=function(t){var e=t.constructor;return e.prototype=t,e},u.extend=function(t,e){return u(t,function(t){return this.uber=t,e})},function(){var e={},i={networkIcon:function(){return this.data.network_name.toLowerCase()},networkName:function(){return this.data.network_name.toLowerCase()},userUrl:function(){if(this.data.user_url&&""!=this.data.user_url)return this.data.user_url;if(this.data.originator_user_url&&""!=this.data.originator_user_url)return this.data.originator_user_url;if(this.data.userUrl&&""!=this.data.userUrl)return this.data.userUrl;var t=this.data.network_id+"";return"1"===t?"http://twitter.com/"+this.data.user_screen_name:"2"===t?"http://instagram.com/"+this.data.user_screen_name:"3"===t?"http://facebook.com/"+this.data.user_screen_name:"#"},parseText:function(t){return this.data.is_html?t:("Twitter"===this.data.network_name?(t=m.StringUtils.linksToHref(t),t=m.StringUtils.twitterLinks(t)):"Instagram"===this.data.network_name?(t=m.StringUtils.linksToHref(t),t=m.StringUtils.instagramLinks(t)):"Facebook"===this.data.network_name?(t=m.StringUtils.linksToHref(t),t=m.StringUtils.facebookLinks(t)):t=m.StringUtils.linksToHref(t),i.nl2br(t))},nl2br:function(t){return t=t.trim(),t=t.replace(/(?:\r\n|\r|\n)/g,"<br />")},contentImageClasses:function(){return this.data.image?"crt-post-has-image":"crt-post-content-image-hidden"},contentTextClasses:function(){return this.data.text?"crt-post-has-text":"crt-post-content-text-hidden"},fuzzyDate:function(t){var e,i=Date.parse(t+" UTC"),n=Math.round((new Date-i)/1e3),o=60,s=60*o,r=24*s,a=7*r,l=30*r;return e=n<30?"Just now":n<o?n+" seconds ago":n<2*o?"a minute ago.":n<s?Math.floor(n/o)+" minutes ago":1==Math.floor(n/s)?"1 hour ago.":n<r?Math.floor(n/s)+" hours ago":n<2*r?"Yesterday":n<a?"This week":n<2*a?"Last week":n<l?"This month":i},prettyDate:function(t){var e=m.DateUtils.dateFromString(t),i=((new Date).getTime()-e.getTime())/1e3,n=Math.floor(i/86400),o=e.getFullYear(),s=e.getMonth()+1,r=e.getDate();if(isNaN(n)||n<0||n>=31)return o.toString()+"-"+(s<10?"0"+s.toString():s.toString())+"-"+(r<10?"0"+r.toString():r.toString());var a=0==n&&(i<60&&"just now"||i<120&&"1 minute ago"||i<3600&&Math.floor(i/60)+" minutes ago"||i<7200&&"1 hour ago"||i<86400&&Math.floor(i/3600)+" hours ago")||1==n&&"Yesterday"||n<7&&n+" days ago"||n<31&&Math.ceil(n/7)+" weeks ago";return a}};t.parseTemplate=function(t,n){var o="";try{var s=e[t];if(!s){var r=t.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('"),a="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+r+"');}return p.join('');";s=new Function("obj",a),e[t]=s}return i.data=n,s.call(i,n)}catch(t){window.console.log("Template parse error: "+t.message),o=t.message}return" # ERROR: "+o+" # "}}(),!s.support.cors&&s.ajaxTransport&&window.XDomainRequest){var h=/^https?:\/\//i,p=/^get|post$/i,d=new RegExp("^"+window.location.protocol,"i"),f=/text\/html/i,g=/\/json/i,v=/\/xml/i;s.ajaxTransport("text html xml json",function(t,e,i){if(i=i,t.crossDomain&&t.async&&p.test(t.type)&&h.test(t.url)&&d.test(t.url)){var n=null,o=(e.dataType||"").toLowerCase();return{send:function(i,r){n=new window.XDomainRequest,/^\d+$/.test(e.timeout)&&(n.timeout=e.timeout),n.ontimeout=function(){r(500,"timeout")},n.onload=function(){var t="Content-Length: "+n.responseText.length+"\r\nContent-Type: "+n.contentType,e={code:200,message:"success"},i={text:n.responseText};try{if("html"===o||f.test(n.contentType))i.html=n.responseText;else if("json"===o||"text"!==o&&g.test(n.contentType))try{i.json=s.parseJSON(n.responseText)}catch(t){e.code=500,e.message="parseerror"}else if("xml"===o||"text"!==o&&v.test(n.contentType)){var a=new window.ActiveXObject("Microsoft.XMLDOM");a.async=!1;try{a.loadXML(n.responseText)}catch(t){a=void 0}if(!a||!a.documentElement||a.getElementsByTagName("parsererror").length)throw e.code=500,e.message="parseerror","Invalid XML: "+n.responseText;i.xml=a}}catch(t){throw t}finally{r(e.code,e.message,i,t)}},n.onprogress=function(){},n.onerror=function(){r(500,"error",{text:n.responseText})};var a="";e.data&&(a="string"===s.type(e.data)?e.data:s.param(e.data)),n.open(t.type,t.url),n.send(a)},abort:function(){n&&n.abort()}}}})}var m={debug:!1,SOURCE_TYPES:["twitter","instagram"],log:function(t){window.console&&m.debug&&window.console.log(t)},alert:function(t){window.alert&&window.alert(t)},checkContainer:function(t){return m.log("Curator->checkContainer: "+t),0!==s(t).length||(window.console&&window.console.log("Curator could not find the element "+t+". Please ensure this element existings in your HTML code. Exiting."),!1)},checkPowered:function(t){m.log("Curator->checkPowered");var e=t.html();return e.indexOf("Curator")>0||(m.alert("Container is missing Powered by Curator"),!1)},loadCSS:function(t){try{var e=m.createSheet(t),i=".crt-post .crt-post-header, .crt-post .crt-post-header .social-icon",n=".crt-post .crt-post-header, .crt-post .crt-post-share, .crt-post .crt-post-header .crt-post-name a, .crt-post .crt-post-share a, .crt-post .crt-post-header .social-icon i",o=".crt-post",s=".crt-post .crt-post-content-text";m.addCSSRule(e,i,"background-color:"+t.colours.headerBg),m.addCSSRule(e,n,"color:"+t.colours.headerText),m.addCSSRule(e,o,"background-color:"+t.colours.bodyBg),m.addCSSRule(e,s,"color:"+t.colours.bodyText)}catch(t){console.log("CURATOR UNABLE TO LOAD CSS"),console.log(t.message)}},addCSSRule:function(t,e,i,n){"insertRule"in t?t.insertRule(e+"{"+i+"}",0):"addRule"in t&&t.addRule(e,i)},createSheet:function(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet},loadWidget:function(t,e){e&&(m.Templates.postTemplate=e);var i=window.Curator[t.type];window.curatorWidget=new i(t)},Templates:{},Config:{Defaults:{apiEndpoint:"https://api.curator.io/v1",feedId:"",postsPerPage:12,maxPosts:0,debug:!1,postTemplate:"#post-template",onPostsLoaded:function(){},filter:{show:!1,label:"Show:"}}},augment:u};void 0===s&&m.alert("Curator requires jQuery. \n\nPlease include jQuery in your HTML before the Curator widget script tag.\n\nVisit http://jquery.com/download/ to get the latest version");var y=function(){function t(){n(this,t),this.listeners={}}return a(t,[{key:"on",value:function(t,e,i){for(var n=[],o=arguments.length,s=0;s<o;s++)n.push(arguments[s]);n=n.length>3?n.splice(3,n.length-1):[],"undefined"!=typeof this.listeners[t]?this.listeners[t].push({scope:i,callback:e,args:n}):this.listeners[t]=[{scope:i,callback:e,args:n}]}},{key:"off",value:function(t,e,i){if("undefined"!=typeof this.listeners[t]){for(var n=this.listeners[t].length,o=[],s=0;s<n;s++){var r=this.listeners[t][s];r.scope==i&&r.callback==e||o.push(r)}this.listeners[t]=o}}},{key:"has",value:function(t,e,i){if("undefined"!=typeof this.listeners[t]){var n=this.listeners[t].length;if(void 0===e&&void 0===i)return n>0;for(var o=0;o<n;o++){var s=this.listeners[t][o];if((!i||s.scope==i)&&s.callback==e)return!0}}return!1}},{key:"trigger",value:function(t,e){for(var i=0,n={type:t,target:e},o=[],s=arguments.length,r=0;r<s;r++)o.push(arguments[r]);if(o=o.length>2?o.splice(2,o.length-1):[],o=[n].concat(o),"undefined"!=typeof this.listeners[t])for(var a=this.listeners[t].length,l=0;l<a;l++){var c=this.listeners[t][l];if(c&&c.callback){var u=o.concat(c.args);c.callback.apply(c.scope,u),i+=1}}}},{key:"getEvents",value:function(){var t="";for(var e in this.listeners)for(var i=this.listeners[e].length,n=0;n<i;n++){var o=this.listeners[e][n];t+=o.scope&&o.scope.className?o.scope.className:"anonymous",t+=" listen for '"+e+"'\n"}return t}}]),t}();m.EventBus=new y,function(t){function e(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}var i={circular:!1,speed:5e3,duration:700,minWidth:250,panesVisible:null,moveAmount:0,autoPlay:!1,useCss:!0};t.zepto&&(i.easing="ease-in-out");var o={viewport:{width:"100%",position:"relative"},pane_stage:{width:"100%",overflow:"hidden",position:"relative",height:0},pane_slider:{width:"0%","list-style":"none",position:"relative",overflow:"hidden",padding:"0",left:"0"},pane:{width:"0%",position:"relative",float:"left"}},s=function(){function e(s,r){var a=this;n(this,e),m.log("Carousel->construct"),this.current_position=0,this.animating=!1,this.timeout=null,this.FAKE_NUM=0,this.PANES_VISIBLE=0,this.options=t.extend([],i,r),this.$viewport=t(s),this.$panes=this.$viewport.children(),this.$panes.detach(),this.$pane_stage=t('<div class="ctr-carousel-stage"></div>').appendTo(this.$viewport),this.$pane_slider=t('<div class="ctr-carousel-slider"></div>').appendTo(this.$pane_stage),this.$viewport.css(o.viewport),this.$pane_slider.css(o.pane_slider),this.$pane_stage.css(o.pane_stage),this.addControls(),this.update(),t(window).smartresize(function(){a.resize(),a.move(a.current_position,!0),a.options.autoPlay&&a.animate()})}return a(e,[{key:"update",value:function(){this.$panes=this.$pane_slider.children(),this.NUM_PANES=this.options.circular?this.$panes.length+1:this.$panes.length,this.NUM_PANES>0&&(this.resize(),this.move(this.current_position,!0),this.animating||this.options.autoPlay&&this.animate())}},{key:"add",value:function(t){this.$pane_slider.append(t),this.$panes=this.$pane_slider.children()}},{key:"resize",value:function(){var e=this,i=this.options.infinite?100*(this.NUM_PANES+1)+"%":100*this.NUM_PANES+"%";if(this.$pane_slider.css({width:i}),this.VIEWPORT_WIDTH=this.$viewport.width(),this.options.panesVisible?(this.PANES_VISIBLE=this.options.panesVisible(),this.PANE_WIDTH=this.VIEWPORT_WIDTH/this.PANES_VISIBLE):(this.PANES_VISIBLE=this.VIEWPORT_WIDTH<this.options.minWidth?1:Math.floor(this.VIEWPORT_WIDTH/this.options.minWidth),this.PANE_WIDTH=this.VIEWPORT_WIDTH/this.PANES_VISIBLE),this.options.infinite){this.$panes.filter(".crt-clone").remove();for(var n=this.NUM_PANES-1;n>this.NUM_PANES-1-this.PANES_VISIBLE;n--){var s=this.$panes.eq(n).clone();s.addClass("crt-clone"),s.css("opacity","1"),s.find(".crt-post-image").css({opacity:1}),this.$pane_slider.prepend(s),this.FAKE_NUM=this.PANES_VISIBLE}this.$panes=this.$pane_slider.children()}this.$panes.each(function(i,n){t(n).css(t.extend(o.pane,{width:e.PANE_WIDTH+"px"}))})}},{key:"destroy",value:function(){}},{key:"animate",value:function(){var t=this;this.animating=!0,clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.next()},this.options.speed)}},{key:"next",value:function(){var t=this.options.moveAmount?this.options.moveAmount:this.PANES_VISIBLE;this.move(this.current_position+t,!1)}},{key:"prev",value:function(){var t=this.options.moveAmount?this.options.moveAmount:this.PANES_VISIBLE;this.move(this.current_position-t,!1)}},{key:"move",value:function(t,e){var i=this;this.current_position=t;var n=this.NUM_PANES-this.PANES_VISIBLE;this.current_position<0?this.current_position=0:this.current_position>n&&(this.current_position=n);var o=this.FAKE_NUM+this.current_position,s=o*this.PANE_WIDTH,r=(this.PANES_VISIBLE,this.options.infinite?this.PANE_WIDTH*this.NUM_PANES:this.PANE_WIDTH*this.NUM_PANES-this.VIEWPORT_WIDTH);if(this.currentLeft=s,s<0?this.currentLeft=0:s>r?this.currentLeft=r:this.currentLeft=s,e)this.$pane_slider.css({left:0-this.currentLeft+"px"}),this.moveComplete();else{var a={duration:this.options.duration,complete:function(){i.moveComplete()}};this.options.easing&&(a.easing=this.options.easing),this.$pane_slider.animate({left:0-this.currentLeft+"px"},a)}}},{key:"moveComplete",value:function(){var e=this;this.options.infinite&&this.current_position>=this.NUM_PANES-this.PANES_VISIBLE&&(this.$pane_slider.css({left:0}),this.current_position=0-this.PANES_VISIBLE,this.currentLeft=0),setTimeout(function(){for(var i=0,n=e.current_position;n<e.current_position+e.PANES_VISIBLE;n++){var o=t(e.$panes[n]).children(".crt-post"),s=o.height();s>i&&(i=s),console.log(o),console.log(n+":"+s)}e.$pane_stage.animate({height:i},300)},50),this.$viewport.trigger("curatorCarousel:changed",[this,this.current_position]),this.options.autoPlay&&this.animate()}},{key:"addControls",value:function(){this.$viewport.append('<button type="button" data-role="none" class="crt-panel-prev crt-panel-arrow" aria-label="Previous" role="button" aria-disabled="false">Previous</button>'),this.$viewport.append('<button type="button" data-role="none" class="crt-panel-next crt-panel-arrow" aria-label="Next" role="button" aria-disabled="false">Next</button>'),this.$viewport.on("click",".crt-panel-prev",this.prev.bind(this)),this.$viewport.on("click",".crt-panel-next",this.next.bind(this))}},{key:"method",value:function(){var t=arguments[0];"update"==t?this.update():"add"==t?this.add(arguments[1]):"destroy"==t&&this.destroy()}}]),e}(),r={};t.extend(t.fn,{curatorCarousel:function(i){var n=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);return t.each(this,function(o,a){var l=t(a).data("carousel");r[l]?r[l].method.apply(r[l],n):(l=e(),r[l]=new s(a,i),t(a).data("carousel",l))}),this}}),window.CCarousel=s}(s);var b=function(){function t(){n(this,t),m.log("Client->construct")}return a(t,[{key:"setOptions",value:function(t,e){return this.options=s.extend(!0,{},e,t),t.debug&&(m.debug=!0),!0}},{key:"init",value:function(){return!!m.checkContainer(this.options.container)&&(this.$container=s(this.options.container),this.createFeed(),this.createFilter(),this.createPopupManager(),!0)}},{key:"createFeed",value:function(){var t=this;this.feed=new m.Feed(this),this.feed.on("postsLoaded",function(e){t.onPostsLoaded(e.target)}),this.feed.on("postsFailed",function(e){t.onPostsFail(e.target)})}},{key:"createPopupManager",value:function(){this.popupManager=new m.PopupManager(this)}},{key:"createFilter",value:function(){this.options.filter&&this.options.filter.show&&(this.filter=new m.Filter(this))}},{key:"loadPosts",value:function(t){this.feed.loadPosts(t)}},{key:"createPostElements",value:function(t){var e=this,i=[];return s(t).each(function(){var t=e.createPostElement(this);i.push(t.$el)}),i}},{key:"createPostElement",value:function(t){var e=new m.Post(t,this.options,this);return s(e).bind("postClick",this.onPostClick.bind(this)),s(e).bind("postReadMoreClick",this.onPostClick.bind(this)),this.options.onPostCreated&&this.options.onPostCreated(e),e}},{key:"onPostsLoaded",value:function(t){m.log("Client->onPostsLoaded"),m.log(t.target)}},{key:"onPostsFail",value:function(t){m.log("Client->onPostsLoadedFail"),m.log(t.target)}},{key:"onPostClick",value:function(t,e){this.popupManager.showPopup(e)}},{key:"track",value:function(t){m.log("Feed->track "+t),s.ajax({url:this.getUrl("/track/"+this.options.feedId),dataType:"json",data:{a:t},success:function(t){m.log("Feed->track success"),m.log(t)},error:function(t,e,i){m.log("Feed->_loadPosts fail"),m.log(e),m.log(i)}})}},{key:"getUrl",value:function(t){return this.options.apiEndpoint+t}}]),t}();m.Client=b,s.support.cors=!0;var P=function(t){function o(t){n(this,o);var i=e(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return m.log("Feed->init with options"),i.client=t,i.posts=[],i.currentPage=0,i.postsLoaded=0,i.postCount=0,i.loading=!1,i.options=i.client.options,i.feedBase=i.options.apiEndpoint+"/feed",i}return i(o,t),a(o,[{key:"loadPosts",value:function(t,e){if(t=t||0,m.log("Feed->loadPosts "+this.loading),this.loading)return!1;this.currentPage=t;var i=s.extend({},this.options.feedParams,e);i.limit=this.options.postsPerPage,i.offset=t*this.options.postsPerPage,this._loadPosts(i)}},{key:"loadMore",value:function(t){if(m.log("Feed->loadMore "+this.loading),this.loading)return!1;var e={limit:this.options.postsPerPage};s.extend(e,this.options.feedParams,t),e.offset=this.posts.length,this._loadPosts(e)}},{key:"_loadPosts",value:function(t){var e=this;m.log("Feed->_loadPosts"),this.loading=!0,s.ajax({url:this.getUrl("/posts"),dataType:"json",data:t,success:function(t){m.log("Feed->_loadPosts success"),t.success?(e.postCount=t.postCount,e.postsLoaded+=t.posts.length,e.posts=e.posts.concat(t.posts),e.networks=t.networks,e.trigger("postsLoaded",t.posts)):e.trigger("postsFailed",t.posts),e.loading=!1},error:function(t,i,n){m.log("Feed->_loadPosts fail"),m.log(i),m.log(n),e.trigger("postsFailed",[]),e.loading=!1}})}},{key:"loadPost",value:function(t,e,i){i=i||function(){},s.get(this.getUrl("/post/"+t),{},function(t){t.success?e(t.post):i()})}},{key:"inappropriatePost",value:function(t,e,i,n){var o={reason:e};s.post(this.getUrl("/post/"+t+"/inappropriate"),o,function(t,e,o){t=s.parseJSON(t),t.success===!0?i():n(o)})}},{key:"lovePost",value:function(t,e,i){var n={};s.post(this.getUrl("/post/"+t+"/love"),n,function(t,n,o){t=s.parseJSON(t),t.success===!0?e(t.loves):i(o)})}},{key:"getUrl",value:function(t){return this.feedBase+"/"+this.options.feedId+t}}]),o}(y);m.Feed=P,m.Templates.filterTemplate=' <div class="crt-filter"> <div class="crt-filter-network"><label>Show:</label> <ul class="networks"></ul></div> </div>';var k=function(){function t(e){var i=this;n(this,t),m.log("Filter->construct"),this.client=e,this.$filter=m.Template.render("#filterTemplate",{}),this.$filterNetworks=this.$filter.find(".networks"),this.client.$container.append(this.$filter),this.$filter.find(".crt-filter-network label").text(this.client.options.filter.label),this.$filter.on("click",".crt-filter-network a",function(t){t.preventDefault(),console.log(t);var e=s(t.target),n=e.data("network");i.$filter.find(".crt-filter-network li").removeClass("active"),e.parent().addClass("active"),m.EventBus.trigger("crt:filter:change"),n?i.client.feed.loadPosts(0,{network_id:n}):i.client.feed.loadPosts(0,{})}),this.client.feed.on("postsLoaded",function(t){i.onPostsLoaded(t.target)})}return a(t,[{key:"onPostsLoaded",value:function(){if(console.log("Asd"),!this.filtersLoaded){this.$filterNetworks.append('<li class="active"><a href="#" data-network="0"> All</a></li>');var t=!0,e=!1,i=void 0;try{for(var n,o=this.client.feed.networks[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var s=n.value,r=m.Networks[s];console.log(r),this.$filterNetworks.append('<li><a href="#" data-network="'+s+'"><i class="'+r.icon+'"></i> '+r.name+"</a></li>")}}catch(t){e=!0,i=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw i}}this.filtersLoaded=!0}}}]),t}();m.Filter=k,m.Networks={1:{name:"Twitter",icon:"crt-icon-twitter"},2:{name:"Instagram",icon:"crt-icon-instagram"},3:{name:"Facebook",icon:"crt-icon-facebook"},4:{name:"Pinterest",icon:"crt-icon-pinterest"},5:{name:"Google",icon:"crt-icon-google"},6:{name:"Vine",icon:"crt-icon-vine"},7:{name:"Flickr",icon:"crt-icon-flickr"},8:{name:"Youtube",icon:"crt-icon-youtube"},9:{name:"Tumblr",icon:"crt-icon-tumblr"},10:{name:"RSS",icon:"crt-icon-rss"},11:{name:"LinkedIn",icon:"crt-icon-linkedin"}},m.PopupInappropriate=function(t,e){this.init(t,e)},s.extend(m.PopupInappropriate.prototype,{feed:null,post:null,init:function(t,e){var i=this;this.feed=e,this.post=t,this.jQueryel=s(".mark-bubble"),s(".mark-close").click(function(t){t.preventDefault(),s(this).parent().fadeOut("slow")}),s(".mark-bubble .submit").click(function(){var t=i.$el.find("input.text"),n=s.trim(t.val());n&&(t.disabled=!0,s(this).hide(),i.$el.find(".waiting").show(),e.inappropriatePost(i.post.id,n,function(){t.val(""),i.$el.find(".waiting").hide(),i.$el.find(".title").html("Thank you"),i.$el.find("input.text").hide(),i.$el.find("input.text").html(""),i.$el.find(".success-message").html("This message has been marked as inappropriate").show()},function(){i.$el.find(".waiting").hide(),i.$el.find(".title").html("Oops"),i.$el.find("input.text").hide(),i.$el.find("input.text").html(""),i.$el.find(".success-message").html("It looks like a problem has occurred. Please try again later").show()}))}),this.$el.fadeIn("slow")}});var x=function(){function t(e){n(this,t),m.log("PopupManager->init "),this.client=e,this.templateId="#popup-wrapper-template",this.$wrapper=m.Template.render(this.templateId,{}),this.$popupContainer=this.$wrapper.find(".crt-popup-container"),this.$underlay=this.$wrapper.find(".crt-popup-underlay"),s("body").append(this.$wrapper),this.$underlay.click(this.onUnderlayClick.bind(this))}return a(t,[{key:"showPopup",value:function(t){var e=this;this.popup?this.popup.hide(function(){e.popup.destroy(),e.showPopup2(t)}):this.showPopup2(t)}},{key:"showPopup2",value:function(t){this.popup=new m.Popup(this,t,this.feed),this.$popupContainer.append(this.popup.$popup),this.$wrapper.show(),"block"!==this.$underlay.css("display")&&this.$underlay.fadeIn(),this.popup.show(),s("body").addClass("crt-popup-visible"),this.currentPostNum=0;for(var e=0;e<this.posts.length;e++)if(t.json.id==this.posts[e].id){this.currentPostNum=e,m.log("Found post "+e);break}this.client.track("popup:show")}},{key:"setPosts",value:function(t){this.posts=t}},{key:"onClose",value:function(){this.hide()}},{key:"onPrevious",value:function(){this.currentPostNum-=1,this.currentPostNum=this.currentPostNum>=0?this.currentPostNum:this.posts.length-1,this.showPopup({json:this.posts[this.currentPostNum]})}},{key:"onNext",value:function(){this.currentPostNum+=1,this.currentPostNum=this.currentPostNum<this.posts.length?this.currentPostNum:0,this.showPopup({json:this.posts[this.currentPostNum]})}},{key:"onUnderlayClick",value:function(t){m.log("PopupManager->onUnderlayClick"),t.preventDefault(),this.popup.hide(function(){this.hide()}.bind(this))}},{key:"hide",value:function(){var t=this;m.log("PopupManager->hide"),this.client.track("popup:hide"),s("body").removeClass("crt-popup-visible"),this.currentPostNum=0,this.popup=null,this.$underlay.fadeOut(function(){t.$underlay.css({display:"",opacity:""}),t.$wrapper.hide()})}},{key:"destroy",value:function(){this.$underlay.remove(),delete this.$popup,delete this.$underlay}}]),t}();m.PopupManager=x;var $=function(){function t(e,i,o){if(n(this,t),m.log("Popup->init "),this.popupManager=e,this.json=i.json,this.feed=o,this.templateId="#popup-template",this.videoPlaying=!1,this.$popup=m.Template.render(this.templateId,this.json),this.json.image&&this.$popup.addClass("has-image"),this.json.video&&this.$popup.addClass("has-video"),this.json.video&&this.json.video.indexOf("youtu")>=0){this.$popup.find("video").remove();var s=m.StringUtils.youtubeVideoId(this.json.video),r='<iframe id="ytplayer" type="text/html" width="615" height="615"             src="https://www.youtube.com/embed/'+s+'?autoplay=0&rel=0&showinfo"             frameborder="0"></iframe>';this.$popup.find(".crt-video-container img").remove(),this.$popup.find(".crt-video-container a").remove(),this.$popup.find(".crt-video-container").append(r)}this.$popup.on("click"," .crt-close",this.onClose.bind(this)),this.$popup.on("click"," .crt-previous",this.onPrevious.bind(this)),this.$popup.on("click"," .crt-next",this.onNext.bind(this)),this.$popup.on("click"," .crt-play",this.onPlay.bind(this)),this.$popup.on("click",".crt-share-facebook",this.onShareFacebookClick.bind(this)),this.$popup.on("click",".crt-share-twitter",this.onShareTwitterClick.bind(this))}return a(t,[{key:"onShareFacebookClick",value:function(t){return t.preventDefault(),m.SocialFacebook.share(this.json),this.widget.track("share:facebook"),!1}},{key:"onShareTwitterClick",value:function(t){return t.preventDefault(),m.SocialTwitter.share(this.json),this.widget.track("share:twitter"),!1}},{key:"onClose",value:function(t){t.preventDefault();var e=this;this.hide(function(){e.popupManager.onClose()})}},{key:"onPrevious",value:function(t){t.preventDefault(),this.popupManager.onPrevious()}},{key:"onNext",value:function(t){t.preventDefault(),this.popupManager.onNext()}},{key:"onPlay",value:function(t){m.log("Popup->onPlay"),t.preventDefault(),this.videoPlaying=!this.videoPlaying,this.videoPlaying?(this.$popup.find("video")[0].play(),this.popupManager.client.track("video:play")):(this.$popup.find("video")[0].pause(),this.popupManager.client.track("video:pause")),m.log(this.videoPlaying),this.$popup.toggleClass("video-playing",this.videoPlaying)}},{key:"show",value:function(){this.$popup.fadeIn(function(){})}},{key:"hide",value:function(t){m.log("Popup->hide");var e=this;this.$popup.fadeOut(function(){e.destroy(),t()})}},{key:"destroy",value:function(){this.$popup&&this.$popup.length&&(this.$popup.remove(),this.$popup.find("video").length&&this.$popup.find("video")[0].pause()),delete this.$popup}}]),t}();m.Popup=$;var C=function(){function t(e,i,o){var s=this;if(n(this,t),this.options=i,this.widget=o,this.templateId=this.options.postTemplate,this.json=e,this.$el=m.Template.render(this.templateId,e),this.$el.find(".crt-share-facebook").click(this.onShareFacebookClick.bind(this)),this.$el.find(".crt-share-twitter").click(this.onShareTwitterClick.bind(this)),this.$el.find(".crt-post-read-more-button").click(this.onReadMoreClick.bind(this)),this.$el.click(this.onPostClick.bind(this)),this.$post=this.$el.find(".crt-post"),this.$image=this.$el.find(".crt-post-image"),this.$imageContainer=this.$el.find(".crt-image-c"),this.$image.css({opacity:0}),this.json.image?(this.$image.on("load",this.onImageLoaded.bind(this)),this.$image.on("error",this.onImageError.bind(this))):setTimeout(function(){console.log("asdasd"),s.setHeight()},100),this.json.image_width>0){var r=this.json.image_height/this.json.image_width*100;this.$imageContainer.addClass("crt-image-responsive").css("padding-bottom",r+"%")}this.$image.data("dims",this.json.image_width+":"+this.json.image_height),this.$post=this.$el.find(".crt-post"),this.json.video&&this.$post.addClass("has-video")}return a(t,[{key:"onShareFacebookClick",value:function(t){return t.preventDefault(),m.SocialFacebook.share(this.json),this.widget.track("share:facebook"),!1}},{key:"onShareTwitterClick",value:function(t){return t.preventDefault(),m.SocialTwitter.share(this.json),this.widget.track("share:twitter"),!1}},{key:"onPostClick",value:function(t){var e=s(t.target);e.is("a")&&"#"!==e.attr("href")?this.widget.track("click:link"):(t.preventDefault(),s(this).trigger("postClick",this,this.json,t))}},{key:"onImageLoaded",value:function(){this.$image.animate({opacity:1}),this.setHeight()}},{key:"onImageError",value:function(){this.$image.hide(),this.setHeight()}},{key:"setHeight",value:function(){var t=this.$post.height();console.log(t),this.options.maxHeight&&this.options.maxHeight>0&&t>this.options.maxHeight&&this.$post.css({maxHeight:this.options.maxHeight}).addClass("crt-post-max-height")}},{key:"onReadMoreClick",value:function(t){t.preventDefault(),this.widget.track("click:read-more"),s(this).trigger("postReadMoreClick",this,this.json,t)}}]),t}();m.Post=C,m.SocialFacebook={share:function(t){var e=t;e.url=m.Utils.postUrl(t);var i=function(){},n=!1;if(n)window.FB.ui({method:"feed",link:e.url,picture:e.image,name:e.user_screen_name,description:e.text},i);else{var o="https://www.facebook.com/sharer/sharer.php?u={{url}}&d={{text}}",s=m.Utils.tinyparser(o,e);m.Utils.popup(s,"twitter","600","430","0")}}},m.SocialPinterest={share:function(t){var e=t;e.url=m.Utils.postUrl(t);var i="http://pinterest.com/pin/create/button/?url={{url}}&media={{image}}&description={{text}}";m.Utils.popup(m.Utils.tinyparser(i,e),"pintrest","600","270","0")}},m.SocialTwitter={share:function(t){var e=t;e.url=m.Utils.postUrl(t);var i="http://twitter.com/share?url={{url}}&text={{text}}&hashtags={{hashtags}}",n=m.Utils.tinyparser(i,e);m.Utils.popup(n,"twitter","600","430","0")}},m.Templates.postTemplate=' <div class="crt-post-c">    <div class="crt-post-bg"></div>     <div class="crt-post post<%=id%> crt-post-<%=this.networkIcon()%>">         <div class="crt-post-header">             <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>             <img src="<%=user_image%>"  />             <div class="crt-post-name">            <div class="crt-post-fullname"><%=user_full_name%></div>            <div class="crt-post-username"><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div>            </div>         </div>         <div class="crt-post-content">             <div class="crt-image crt-hitarea crt-post-content-image <%=this.contentImageClasses()%>" >                 <div class="crt-image-c"><img src="<%=image%>" class="crt-post-image" /></div>                 <span class="crt-play"><i class="crt-play-icon"></i></span>             </div>             <div class="text crt-post-content-text <%=this.contentTextClasses()%>">                 <div class="crt-post-text-body"><%=this.parseText(text)%></div>             </div>         </div>         <div class="crt-post-footer">            <div class="crt-date"><%=this.prettyDate(source_created_at)%></div>             <div class="crt-post-share"><span class="ctr-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>        </div>         <div class="crt-post-read-more"><a href="#" class="crt-post-read-more-button">Read more</a> </div>     </div></div>',
m.Templates.popupWrapperTemplate=' <div class="crt-popup-wrapper">     <div class="crt-popup-wrapper-c">         <div class="crt-popup-underlay"></div>         <div class="crt-popup-container"></div>     </div> </div>',m.Templates.popupTemplate=' <div class="crt-popup">     <a href="#" class="crt-close crt-icon-cancel"></a>     <a href="#" class="crt-next crt-icon-right-open"></a>     <a href="#" class="crt-previous crt-icon-left-open"></a>     <div class="crt-popup-left">          <div class="crt-video">             <div class="crt-video-container">                <video preload="none">                <source src="<%=video%>" type="video/mp4" >                </video>                <img src="<%=image%>" />                <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a>             </div>         </div>         <div class="crt-image">             <img src="<%=image%>" />         </div>     </div>     <div class="crt-popup-right">         <div class="crt-popup-header">             <span class="crt-social-icon"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>             <img src="<%=user_image%>"  />             <div class="crt-post-name"><span><%=user_full_name%></span><br/><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div>         </div>         <div class="crt-popup-text <%=this.contentTextClasses()%>">             <div class="crt-popup-text-container">                 <p class="crt-date"><%=this.prettyDate(source_created_at)%></p>                 <div class="crt-popup-text-body"><%=this.parseText(text)%></div>             </div>         </div>         <div class="crt-popup-footer">            <div class="crt-post-share"><span class="ctr-share-hint"></span><a href="#" class="crt-share-facebook"><i class="crt-icon-facebook"></i></a>  <a href="#" class="crt-share-twitter"><i class="crt-icon-twitter"></i></a></div>        </div>     </div> </div>',m.Templates.popupUnderlayTemplate="",m.Template={camelize:function(t){return t.replace(/(?:^|[-_])(\w)/g,function(t,e){return e?e.toUpperCase():""})},render:function(t,e){var i=this.camelize(t).substring(1),n="";if(void 0!==m.Templates[i]?n=m.Templates[i]:1===s(t).length&&(n=s(t).html()),""===n)throw new Error("could not find template "+t+"("+i+")");var o=window.parseTemplate(n,e);return s.parseHTML&&(o=s.parseHTML(o)),s(o).filter("div")}},m.Track={track:function(t){s.ajax({url:this.getUrl("/posts"),dataType:"json",data:params,success:function(t){m.log("Feed->_loadPosts success"),t.success?(that.postCount=t.postCount,that.postsLoaded+=t.posts.length,that.posts=that.posts.concat(t.posts),that.options.onPostsLoaded&&that.options.onPostsLoaded(t.posts)):that.options.onPostsFail&&that.options.onPostsFail(t),that.loading=!1},error:function(t,e,i){m.log("Feed->_loadPosts fail"),m.log(e),m.log(i),that.options.onPostsFail&&that.options.onPostsFail(),that.loading=!1}})},getUrl:function(t){return this.feedBase+"/"+this.options.feedId+t}},m.Utils={postUrl:function(t){return console.log(t.url),t.url&&""!==t.url&&"''"!==t.url?t.url:(console.log(t.url),t.network_id+""=="1"?"https://twitter.com/"+t.user_screen_name+"/status/"+t.source_identifier:"")},center:function(t,e,i){var n=window.screen,o=i||{},s=o.height||n.height,r=o.width||n.height,a=t,l=e;return{top:s?(s-l)/2:0,left:r?(r-a)/2:0}},popup:function(t,e,i,n,o){var s=this.center(i,n),r="height="+n+",width="+i+",top="+s.top+",left="+s.left+",scrollbars="+o+",resizable";window.open(t,e,r)},tinyparser:function(t,e){return t.replace(/\{\{(.*?)\}\}/g,function(t,i){return e&&"undefined"!=typeof e[i]?encodeURIComponent(e[i]):""})}},m.DateUtils={dateFromString:function(t){dtstr=t.replace(/\D/g," ");var e=dtstr.split(" ");e[1]--;var i=new Date(Date.UTC(e[0],e[1],e[2],e[3],e[4],e[5]));return i},dateAsDayMonthYear:function(t){var e=new Date(parseInt(t,10)),i=e.getDate()+"",n=e.getMonth()+1+"",o=e.getFullYear()+"";i=1===i.length?"0"+i:i,n=1===n.length?"0"+n:n;var s=i+"/"+n+"/"+o;return s},dateAsTimeArray:function(t){var e=new Date(parseInt(t,10)),i=e.getHours()+"",n=e.getMinutes()+"",o=void 0;i>=12?(o="PM",i>12&&(i=i-12+"")):o="AM",i=1===i.length?"0"+i:i,n=1===n.length?"0"+n:n;var s=[parseInt(i.charAt(0),10),parseInt(i.charAt(1),10),parseInt(n.charAt(0),10),parseInt(n.charAt(1),10),o];return s}},m.StringUtils={twitterLinks:function(t){return t=t.replace(/[@]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("@","");return m.StringUtils.url("https://twitter.com/"+e,t)}),t=t.replace(/[#]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("#","%23");return m.StringUtils.url("https://twitter.com/search?q="+e,t)})},instagramLinks:function(t){return t=t.replace(/[@]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("@","");return m.StringUtils.url("https://www.instagram.com/"+e+"/",t)}),t=t.replace(/[#]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("#","");return m.StringUtils.url("https://www.instagram.com/explore/tags/"+e+"/",t)})},facebookLinks:function(t){return t=t.replace(/[@]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("@","");return m.StringUtils.url("https://www.facebook.com/"+e+"/",t)}),t=t.replace(/[#]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("#","%23");return m.StringUtils.url("https://www.facebook.com/search/top/?q="+e,t)})},linksToHref:function(t){return t=t.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&~\?\/.=]+/g,function(t){return m.StringUtils.url(t)})},url:function(t,e){return e=e||t,'<a href="'+t+'" target="_blank">'+e+"</a>"},youtubeVideoId:function(t){var e=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,i=t.match(e);return!(!i||11!=i[7].length)&&i[7]}},m.Config.Waterfall=s.extend({},m.Config.Defaults,{scroll:"more",waterfall:{gridWidth:250,animate:!0,animateSpeed:400}});var _=function(t){function o(t){n(this,o);var i=e(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return i.setOptions(t,m.Config.Waterfall),m.log("Waterfall->init with options:"),m.log(i.options),i.init(i)&&(i.$scroll=s('<div class="crt-feed-scroll"></div>').appendTo(i.$container),i.$feed=s('<div class="crt-feed"></div>').appendTo(i.$scroll),i.$container.addClass("crt-feed-container"),"continuous"==i.options.scroll?s(i.$scroll).scroll(function(){var t=i.$scroll.height(),e=i.$feed.height(),n=i.$scroll.scrollTop();n>=e-t&&i.loadMorePosts()}):"none"==i.options.scroll||(i.$more=s('<div class="crt-feed-more"><a href="#"><span>Load more</span></a></div>').appendTo(i.$scroll),i.$more.find("a").on("click",function(t){t.preventDefault(),i.loadMorePosts()})),i.$feed.waterfall({selector:".crt-post-c",gutter:0,width:i.options.waterfall.gridWidth,animate:i.options.waterfall.animate,animationOptions:{speed:i.options.waterfall.animateSpeed/2,duration:i.options.waterfall.animateSpeed}}),m.EventBus.on("crt:filter:change",function(t){i.$feed.find(".crt-post-c").remove()}),i.loadPosts(0)),i}return i(o,t),a(o,[{key:"loadPosts",value:function(t,e){m.log("Waterfall->loadPage"),e&&this.$feed.find(".crt-post-c").remove(),this.feed.loadPosts(t)}},{key:"loadMorePosts",value:function(){m.log("Waterfall->loadMorePosts"),this.feed.loadPosts(this.feed.currentPage+1)}},{key:"onPostsLoaded",value:function(t){m.log("Waterfall->onPostsLoaded"),m.log(t);var e=this.createPostElements(t);this.$feed.waterfall("append",e);var i=this;s.each(e,function(t){var e=this;i.options.waterfall.showReadMore&&e.find(".crt-post").addClass("crt-post-show-read-more")}),this.popupManager.setPosts(t),this.loading=!1,this.options.onPostsLoaded(this,t)}},{key:"onPostsFailed",value:function(t){this.loading=!1,this.$feed.html('<p style="text-align: center">'+t.message+"</p>")}},{key:"destroy",value:function(){this.$feed.remove(),this.$scroll.remove(),this.$more&&this.$more.remove(),this.$container.removeClass("crt-feed-container"),delete this.$feed,delete this.$scroll,delete this.$container,delete this.options,delete this.totalPostsLoaded,delete this.loading,delete this.allLoaded,delete this.feed}}]),o}(m.Client);m.Waterfall=_,m.Config.Carousel=s.extend({},m.Config.Defaults,{scroll:"more",carousel:{autoPlay:!0,autoLoad:!0}});var T=function(t){function o(t){n(this,o);var i=e(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));if(i.setOptions(t,m.Config.Carousel),i.containerHeight=0,i.loading=!1,i.posts=[],i.firstLoad=!0,m.log("Carousel->init with options:"),m.log(i.options),i.init(i)){i.allLoaded=!1;var r=i;i.$feed=s('<div class="crt-feed"></div>').appendTo(i.$container),i.$container.addClass("crt-carousel"),i.carousel=new window.CCarousel(i.$feed,i.options.carousel),i.$feed.on("curatorCarousel:changed",function(t,e,i){console.log("curatorCarousel:changed "+i),r.options.carousel.autoLoad&&r.loadMorePosts()}),i.loadPosts(0)}return i}return i(o,t),a(o,[{key:"loadMorePosts",value:function(){m.log("Carousel->loadMorePosts"),this.feed.postCount>this.feed.postsLoaded&&this.feed.loadPosts(this.feed.currentPage+1)}},{key:"onPostsLoaded",value:function(t){if(m.log("Carousel->onPostsLoaded"),this.loading=!1,0===t.length)this.allLoaded=!0;else{var e=this,i=[];s(t).each(function(t){var n=e.createPostElement(this);i.push(n.$el),e.options.animate&&e.firstLoad&&(n.$el.css({opacity:0}),setTimeout(function(){console.log(t),n.$el.css({opacity:0}).animate({opacity:1})},100*t))}),this.carousel.add(i),this.carousel.update(),this.popupManager.setPosts(t),this.options.onPostsLoaded(this,t)}this.firstLoad=!1}},{key:"onPostsFail",value:function(t){m.log("Carousel->onPostsFail"),this.loading=!1,this.$feed.html('<p style="text-align: center">'+t.message+"</p>")}},{key:"destroy",value:function(){this.carousel.destroy(),this.$feed.remove(),this.$container.removeClass("crt-carousel"),delete this.$feed,delete this.$container,delete this.options,delete this.feed.postsLoaded,delete this.loading,delete this.allLoaded,delete this.feed}}]),o}(b);m.Carousel=T,m.Config.Panel=s.extend({},m.Config.Defaults,{panel:{autoPlay:!0,autoLoad:!0,moveAmount:1,fixedHeight:!1,infinite:!0,minWidth:2e3}});var E=function(t){function o(t){n(this,o);var i=e(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return i.setOptions(t,m.Config.Panel),m.log("Panel->init with options:"),m.log(i.options),i.containerHeight=0,i.loading=!1,i.feed=null,i.$container=null,i.$feed=null,i.posts=[],i.init(i)&&(i.allLoaded=!1,i.$feed=s('<div class="crt-feed"></div>').appendTo(i.$container),i.$container.addClass("crt-panel"),i.options.panel.fixedHeight&&i.$container.addClass("crt-panel-fixed-height"),i.$feed.curatorCarousel(i.options.panel),i.$feed.on("curatorCarousel:changed",function(t,e,n){!i.allLoaded&&i.options.panel.autoLoad&&n>=i.feed.postsLoaded-4&&i.loadMorePosts()}),i.loadPosts(0)),i}return i(o,t),a(o,[{key:"loadMorePosts",value:function(){m.log("Carousel->loadMorePosts"),this.feed.loadPosts(this.feed.currentPage+1)}},{key:"onPostsLoaded",value:function(t){if(m.log("Carousel->onPostsLoaded"),this.loading=!1,0===t.length)this.allLoaded=!0;else{var e=this,i=[];s(t).each(function(){var t=e.createPostElement(this);i.push(t.$el)}),e.$feed.curatorCarousel("add",i),e.$feed.curatorCarousel("update"),this.popupManager.setPosts(t),this.options.onPostsLoaded(this,t)}}},{key:"onPostsFail",value:function(t){m.log("Carousel->onPostsFail"),this.loading=!1,this.$feed.html('<p style="text-align: center">'+t.message+"</p>")}},{key:"destroy",value:function(){this.$feed.curatorCarousel("destroy"),this.$feed.remove(),this.$container.removeClass("crt-panel"),delete this.$feed,delete this.$container,delete this.options,delete this.feed.postsLoaded,delete this.loading,delete this.allLoaded,delete this.feed}}]),o}(m.Client);m.Panel=E,m.Config.Grid=s.extend({},m.Config.Defaults,{postTemplate:"#gridPostTemplate",grid:{minWidth:200,rows:3}}),m.Templates.gridPostTemplate=' <div class="crt-post-c">    <div class="crt-post post<%=id%> <%=this.contentImageClasses()%> <%=this.contentTextClasses()%>">         <div class="crt-post-content">             <div class="crt-hitarea" >                 <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class="spacer" />                 <div class="crt-post-content-image" style="background-image: url(<%=image%>);"> </div>                 <div class="crt-post-content-text-c">                     <div class="crt-post-content-text">                         <%=this.parseText(text)%>                     </div>                 </div>                 <a href="javascript:;" class="crt-play"><i class="crt-play-icon"></i></a>                 <span class="crt-social-icon crt-social-icon-normal"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                 <div class="crt-post-hover">                    <div class="crt-post-header">                         <img src="<%=user_image%>"  />                         <div class="crt-post-name"><span><%=user_full_name%></span><br/><a href="<%=this.userUrl()%>" target="_blank">@<%=user_screen_name%></a></div>                     </div>                     <div class="crt-post-hover-text">                         <%=this.parseText(text)%>                     </div>                     <span class="crt-social-icon crt-social-icon-hover"><i class="crt-icon-<%=this.networkIcon()%>"></i></span>                 </div>             </div>         </div>     </div></div>',m.Templates.gridFeedTemplate=' <div class="crt-feed-window">    <div class="crt-feed"></div></div><div class="crt-feed-more"><a href="#">Load more</a></div>';var S=function(t){function o(t){n(this,o);var i=e(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));if(i.setOptions(t,m.Config.Grid),m.log("Grid->init with options:"),m.log(i.options),i.containerHeight=0,i.loading=!1,i.feed=null,i.$container=null,i.$feed=null,i.posts=[],i.totalPostsLoaded=0,i.allLoaded=!1,i.previousCol=0,i.page=0,i.rowsShowing=0,i.init(i)){var r=m.Template.render("#gridFeedTemplate",{});i.$container.append(r),i.$feed=i.$container.find(".crt-feed"),i.$feedWindow=i.$container.find(".crt-feed-window"),i.$loadMore=i.$container.find(".crt-feed-more a"),i.$container.addClass("crt-grid");var a=Math.floor(i.$container.width()/i.options.grid.minWidth),l=a*(i.options.grid.rows+1);i.options.grid.showLoadMore?(i.$feedWindow.css({position:"relative"}),i.$loadMore.click(i.onMoreClicked.bind(i))):i.$loadMore.hide(),i.rowsShowing=i.options.grid.rows,i.feed.options.postsPerPage=l,i.loadPosts(0)}var c=null,u=i;return s(window).resize(function(){clearTimeout(c),c=setTimeout(function(){u.updateLayout()},100)}),i.updateLayout(),s(window).on("curatorCssLoaded",function(){clearTimeout(c),c=setTimeout(function(){u.updateLayout()},100)}),s(document).on("ready",function(){clearTimeout(c),c=setTimeout(function(){u.updateLayout()},100)}),i}return i(o,t),a(o,[{key:"onPostsLoaded",value:function(t){if(m.log("Grid->onPostsLoaded"),this.loading=!1,0===t.length)this.allLoaded=!0;else{var e=this,i=[];s(t).each(function(t){var n=e.createPostElement.call(e,this);i.push(n.$el),e.$feed.append(n.$el),e.options.animate&&(n.$el.css({opacity:0}),setTimeout(function(){n.$el.css({opacity:0}).animate({opacity:1})},100*t))}),this.popupManager.setPosts(t),this.options.onPostsLoaded(this,t),this.updateHeight()}}},{key:"createPostElement",value:function(t){var e=new m.Post(t,this.options);return s(e).bind("postClick",s.proxy(this.onPostClick,this)),this.options.onPostCreated&&this.options.onPostCreated(e),e}},{key:"onPostsFailed",value:function(t){m.log("Grid->onPostsFailed"),this.loading=!1,this.$feed.html('<p style="text-align: center">'+t.message+"</p>")}},{key:"onPostClick",value:function(t,e){this.popupManager.showPopup(e)}},{key:"onMoreClicked",value:function(t){t.preventDefault(),this.rowsShowing=this.rowsShowing+this.options.grid.rows,this.updateHeight(!0),this.feed.loadMore()}},{key:"updateLayout",value:function(){var t=Math.floor(this.$container.width()/this.options.grid.minWidth),e=t*this.options.grid.rows;this.$container.removeClass("crt-grid-col"+this.previousCol),this.previousCol=t,this.$container.addClass("crt-grid-col"+this.previousCol),e>this.feed.postsLoaded&&this.loadPosts(this.feed.currentPage+1),this.updateHeight()}},{key:"updateHeight",value:function(t){var e=this.$container.find(".crt-post-c").width();this.$feedWindow.css({overflow:"hidden"});var i=Math.ceil(this.feed.postCount/this.previousCol),n=this.rowsShowing<i?this.rowsShowing:i;t?this.$feedWindow.animate({height:n*e}):this.$feedWindow.height(n*e),this.options.grid.showLoadMore&&(this.rowsShowing>=i?this.$loadMore.hide():this.$loadMore.show())}},{key:"destroy",value:function(){this.$container.empty().removeClass("crt-grid").removeClass("crt-grid-col"+this.previousCol).css({height:"",overflow:""}),delete this.$feed,delete this.$container,delete this.options,delete this.totalPostsLoaded,delete this.loading,delete this.allLoaded,delete this.feed}}]),o}(b);m.Grid=S;var A={feedId:"",postsPerPage:12,maxPosts:0,apiEndpoint:"https://api.curator.io/v1",onPostsLoaded:function(){}};return m.Custom=m.augment.extend(m.Client,{containerHeight:0,loading:!1,feed:null,$container:null,$feed:null,posts:[],totalPostsLoaded:0,allLoaded:!1,constructor:function(t){this.uber.setOptions.call(this,t,A),m.log("Panel->init with options:"),m.log(this.options),this.uber.init.call(this)&&(this.$feed=s('<div class="crt-feed"></div>').appendTo(this.$container),this.$container.addClass("crt-custom"),this.loadPosts(0))},onPostsLoaded:function(t){if(m.log("Custom->onPostsLoaded"),this.loading=!1,0===t.length)this.allLoaded=!0;else{var e=this,i=[];s(t).each(function(){var t=e.createPostElement(this);i.push(t.$el),e.$feed.append(t.$el)}),this.popupManager.setPosts(t),this.options.onPostsLoaded(this,t)}},onPostsFailed:function(t){m.log("Custom->onPostsFailed"),this.loading=!1,this.$feed.html('<p style="text-align: center">'+t.message+"</p>")},onPostClick:function(t,e){this.popupManager.showPopup(e)},destroy:function(){this.$feed.remove(),this.$container.removeClass("crt-custom"),delete this.$feed,delete this.$container,delete this.options,delete this.totalPostsLoaded,delete this.loading,delete this.allLoaded,delete this.feed}}),t.Curator=m,m});